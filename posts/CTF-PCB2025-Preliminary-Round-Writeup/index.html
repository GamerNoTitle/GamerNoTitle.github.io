<!DOCTYPE html><html lang="zh-cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup | GamerNoTitle</title><meta name="author" content="GamerNoTitle,admin@bili33.top"><meta name="copyright" content="GamerNoTitle"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="我先燃尽了，四次 bkcrack，出题人是真喜欢这东西啊 还有一堆散点杂色像素图，看的眼睛都要瞎啦 您每题的图片都要藏那么点东西是吗   本次的 PCB 我负责的是 Misc 部分（毕竟我们队里三个搞 Web 的，不如放给那两个经验丰富的 Web 手来搞，我还是回归我擅长的 Misc 领域吧，Web 转 Misc 这块），所以下面我会讲一讲 Misc 部分我的思路，解出来了的题目会标记 Solve">
<meta property="og:type" content="article">
<meta property="og:title" content="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup">
<meta property="og:url" content="https://bili33.top/posts/CTF-PCB2025-Preliminary-Round-Writeup/index.html">
<meta property="og:site_name" content="GamerNoTitle">
<meta property="og:description" content="我先燃尽了，四次 bkcrack，出题人是真喜欢这东西啊 还有一堆散点杂色像素图，看的眼睛都要瞎啦 您每题的图片都要藏那么点东西是吗   本次的 PCB 我负责的是 Misc 部分（毕竟我们队里三个搞 Web 的，不如放给那两个经验丰富的 Web 手来搞，我还是回归我擅长的 Misc 领域吧，Web 转 Misc 这块），所以下面我会讲一讲 Misc 部分我的思路，解出来了的题目会标记 Solve">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg">
<meta property="article:published_time" content="2025-12-13T11:05:12.000Z">
<meta property="article:modified_time" content="2026-02-18T14:32:18.987Z">
<meta property="article:author" content="GamerNoTitle">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="PCB2025">
<meta property="article:tag" content="Misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg"><link rel="shortcut icon" href="https://assets.bili33.top/img/AboutMe/logo-mini.png"><link rel="canonical" href="https://bili33.top/posts/CTF-PCB2025-Preliminary-Round-Writeup/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1a9dfff1b560a523701cb01384373c75";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-138072700-2"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-138072700-2');
</script><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;b259d35cad514e45a226d03906d8fed1&quot;}"></script><link rel="stylesheet" href="https://font.sec.miui.com/font/css?family=MiSans:400,500,700:Chinese_Simplify,Latin&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":180,"position":"top","messagePrev":"本文修改于","messageNext":"天前，如果本文有一定的时效性，那么本文可能已经失效~"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":200,"languages":{"author":"Author: GamerNoTitle","link":"Link: ","source":"Source: GamerNoTitle","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-02-18 22:32:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3KdcwFGRWCpapHjZ",ck:"3KdcwFGRWCpapHjZ",autoTrack:true,hashMode:true,screenRecord:true})</script><meta name="referrer" content="no-referrer-when-downgrade" /><meta itemprop="name" content="GamerNoTitle"><meta itemprop="image" content="https://assets.bili33.top/img/AboutMe/logo-mini.png"><meta name="description" itemprop="description" content="欢迎来到GamerNoTitle的博客~"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-height.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/BB.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-emotion.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/Valine-Emotion.css"><script src="https://assets.bili33.top/js/IPblock.js"></script><script src='https://assets.bili33.top/js/console.js'></script><script src="https://cdn.bili33.top/npm/cardlink"></script><script src="//cdn.bili33.top/npm/matter-js@0.19.0"></script><script>(new Date().getDate() === 1 && new Date().getMonth() === 3) && document.write('<script src="https://cdn.bili33.top/gh/Vikutorika/newassets@master/js/smooth-April-Fools.js"><\/script>')</script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/map/js/china.js"></script><script defer src="https://analytics.bili33.top/script.js" data-website-id="eb23a18b-6650-4776-8ded-29107aba832b"></script><script src="/js/solidity.js"></script><link rel="stylesheet" href="/css/solidity.css"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="http://assets.bili33.top/css/waline-style.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="GamerNoTitle" type="application/atom+xml">
</head><body><link rel="stylesheet" href="https://cdn.bili33.top/npm/gamernotitle-oss@1.0.10/css/barber-shop.css"/><script src="https://cdn.bili33.top/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="onerror=null;src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">GamerNoTitle</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-13T11:05:12.000Z" title="Created 2025-12-13 19:05:12">2025-12-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-18T14:32:18.987Z" title="Updated 2026-02-18 22:32:18">2026-02-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">7.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>34min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div class="note info flat"><p>我先燃尽了，四次 bkcrack，出题人是真喜欢这东西啊</p>
<p>还有一堆散点杂色像素图，看的眼睛都要瞎啦</p>
<p>您每题的图片都要藏那么点东西是吗</p>
</div>

<p>本次的 PCB 我负责的是 Misc 部分（毕竟我们队里三个搞 Web 的，不如放给那两个经验丰富的 Web 手来搞，我还是回归我擅长的 Misc 领域吧，Web 转 Misc 这块），所以下面我会讲一讲 Misc 部分我的思路，解出来了的题目会标记 <code>Solved</code> 的</p>
<p>下面放一下战况</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/msedge_0nfNkC6X3e-1765620094315-134-1765621747343-218.png"></p>
<h2 id="time-Solved"><a href="#time-Solved" class="headerlink" title="time | Solved"></a>time | Solved</h2><p>题目上来就给了个 ELF 文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094315-136-1765621747343-219.png"></p>
<p>nc 给出的服务器，会给出 base64 编码后的 zip 文件数据流，并询问现在几点</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094305-100-1765621747343-220.png"></p>
<p>解压出来发现图片，就是个时钟</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094305-101-1765621747343-221.png"></p>
<p>因为 OpenCV 的识别率不高，且考虑到只有 12 种情况，所以用建哈希表的玩法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote, context</span><br><span class="line"><span class="keyword">from</span> zipfile <span class="keyword">import</span> ZipFile</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 0 - 11 点的图片的 md5</span></span><br><span class="line">hashmap = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;preset/<span class="subst">&#123;_&#125;</span>.png&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">        h = md5(data).hexdigest()</span><br><span class="line">        hashmap[h] = _</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">io = remote(<span class="string">&quot;192.168.18.31&quot;</span>, <span class="number">24001</span>)</span><br><span class="line"></span><br><span class="line">TIPSIG = <span class="string">b&#x27;):\n&#x27;</span></span><br><span class="line"></span><br><span class="line">intro = io.recvline()</span><br><span class="line">data = io.recvline()</span><br><span class="line">carriage = io.recvline()</span><br><span class="line">tip = io.recvline()</span><br><span class="line"><span class="built_in">print</span>(tip)</span><br><span class="line">result = TIPSIG</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> TIPSIG <span class="keyword">in</span> result:</span><br><span class="line">    zipstream = base64.b64decode(data)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;tmp.zip&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(zipstream)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> ZipFile(<span class="string">&quot;tmp.zip&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> zip_ref:</span><br><span class="line">        zip_ref.extractall(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;0.png&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        imgdata = f.read()</span><br><span class="line">        h = md5(imgdata).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> h <span class="keyword">in</span> hashmap:</span><br><span class="line">            hour = hashmap[h]</span><br><span class="line">            minute = hour * <span class="number">5</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hour, minute = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Send line: <span class="subst">&#123;hour&#125;</span>:<span class="subst">&#123;minute:02d&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送结果</span></span><br><span class="line">    io.sendline(<span class="string">f&quot;<span class="subst">&#123;hour&#125;</span>:<span class="subst">&#123;minute:02d&#125;</span>&quot;</span>.encode())</span><br><span class="line">    result = io.recvuntil(TIPSIG)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result.decode())</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后发现第一次正确了，第二次直接炸，手动也是这样</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094305-102-1765621747343-222.png"></p>
<p>应该没那么简单 &#x3D;-&#x3D;</p>
<p>看了一下，输入应该是 h，即只用告诉它是几点钟，所以我这里应该是卡输入格式问题了，重新修正了一下 </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094305-103-1765621747343-223.png"></p>
<p>全对会让执行一个命令，我直接反弹 shell（错误的，反弹不了，好像不出网）</p>
<p>没办法，看了一下 bin 里面有 socat，把文件下载下来好了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote, context</span><br><span class="line"><span class="keyword">from</span> zipfile <span class="keyword">import</span> ZipFile</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">hashmap = &#123;&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Loading presets...&quot;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;preset/<span class="subst">&#123;_&#125;</span>.png&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">            h = md5(data).hexdigest()</span><br><span class="line">            hashmap[h] = _</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Loaded <span class="subst">&#123;<span class="built_in">len</span>(hashmap)&#125;</span> presets.&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[-] Error loading presets: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    p = remote(<span class="string">&quot;192.168.18.31&quot;</span>, <span class="number">24001</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Connection failed&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">PROMPT = <span class="string">b&#x27;): &#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n========== Round <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> / 12 ==========&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        raw_data = p.recvuntil(PROMPT)</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Server disconnected prematurely.&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    lines = raw_data.strip().split(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    b64_data = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(line) &gt; <span class="number">100</span>:</span><br><span class="line">            b64_data = line.strip()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> b64_data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Base64 data not found.&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    target_idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        zip_bytes = base64.b64decode(b64_data)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> ZipFile(io.BytesIO(zip_bytes), <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> z:</span><br><span class="line">            img_data = z.read(<span class="string">&quot;0.png&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        img_hash = md5(img_data).hexdigest()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> img_hash <span class="keyword">in</span> hashmap:</span><br><span class="line">            target_idx = hashmap[img_hash]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] Match! Index: <span class="subst">&#123;target_idx&#125;</span> (Hash: <span class="subst">&#123;img_hash[:<span class="number">6</span>]&#125;</span>...)&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[-] No match for hash: <span class="subst">&#123;img_hash[:<span class="number">6</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] Error processing image: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    payload = <span class="built_in">str</span>(target_idx)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[&gt;] Sending: <span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line">    p.sendline(payload.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    output = p.clean(timeout=<span class="number">0.1</span>)</span><br><span class="line">    <span class="built_in">print</span>(output.decode(errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n[+] Rounds finished. Getting shell...&quot;</span>)</span><br><span class="line">payload = <span class="string">b&quot;/bin/sh&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[&gt;] Sending payload: <span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n[+] Exfiltrating using socat...&quot;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    p.clean()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">cmd = <span class="string">b&#x27;socat -u FILE:&quot;Bandizip(flag).zip&quot; STDOUT&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[&gt;] Sending: <span class="subst">&#123;cmd&#125;</span>&quot;</span>)</span><br><span class="line">p.sendline(cmd)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Downloading raw data...&quot;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    p.recvline()</span><br><span class="line">    </span><br><span class="line">    data = p.recvall(timeout=<span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.zip&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(data)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Download complete! Size: <span class="subst">&#123;<span class="built_in">len</span>(data)&#125;</span> bytes&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Try to unzip flag.zip now.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[-] Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line">p.close()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094305-104-1765621747344-225.png"></p>
<p>不是哥们？又加密了</p>
<p>bkcrack 看一眼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -L flag.zip</span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">Archive: flag.zip</span><br><span class="line">Index Encryption Compression CRC32    Uncompressed  Packed size Name</span><br><span class="line">----- ---------- ----------- -------- ------------ ------------ ----------------</span><br></pre></td></tr></table></figure>

<p>嗯？空的？修复一下试试？</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">zip -FF flag.zip --out flag-fixed.zip                                                                             ─╯</span></span><br><span class="line">Fix archive (-FF) - salvage what can</span><br><span class="line"> Found end record (EOCDR) - says expect single disk archive</span><br><span class="line">Scanning for entries...</span><br><span class="line"> copying: data.txt</span><br><span class="line">        zip warning: no end of stream entry found: data.txt</span><br><span class="line">        zip warning: rewinding and scanning for later entries</span><br><span class="line">        zip warning: zip file empty</span><br></pre></td></tr></table></figure>

<p>真是空的哥们？问了 AI 说是 socat 的问题，让它给我改了一版</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote, context</span><br><span class="line"><span class="keyword">from</span> zipfile <span class="keyword">import</span> ZipFile</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">hashmap = &#123;&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Loading presets...&quot;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;preset/<span class="subst">&#123;_&#125;</span>.png&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">            h = md5(data).hexdigest()</span><br><span class="line">            hashmap[h] = _</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Loaded <span class="subst">&#123;<span class="built_in">len</span>(hashmap)&#125;</span> presets.&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[-] Error loading presets: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    p = remote(<span class="string">&quot;192.168.18.31&quot;</span>, <span class="number">24001</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Connection failed&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">PROMPT = <span class="string">b&#x27;): &#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n========== Round <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> / 12 ==========&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        raw_data = p.recvuntil(PROMPT)</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Server disconnected prematurely.&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    lines = raw_data.strip().split(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    b64_data = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(line) &gt; <span class="number">100</span>:</span><br><span class="line">            b64_data = line.strip()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> b64_data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Base64 data not found.&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    target_idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        zip_bytes = base64.b64decode(b64_data)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> ZipFile(io.BytesIO(zip_bytes), <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> z:</span><br><span class="line">            img_data = z.read(<span class="string">&quot;0.png&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        img_hash = md5(img_data).hexdigest()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> img_hash <span class="keyword">in</span> hashmap:</span><br><span class="line">            target_idx = hashmap[img_hash]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] Match! Index: <span class="subst">&#123;target_idx&#125;</span> (Hash: <span class="subst">&#123;img_hash[:<span class="number">6</span>]&#125;</span>...)&quot;</span>)</span><br><span class="line">            <span class="comment"># 保存 7.zip 用来后面明文攻击</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;debug/round_<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>_matched_<span class="subst">&#123;target_idx&#125;</span>.zip&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(zip_bytes)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[-] No match for hash: <span class="subst">&#123;img_hash[:<span class="number">6</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] Error processing image: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    payload = <span class="built_in">str</span>(target_idx)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[&gt;] Sending: <span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line">    p.sendline(payload.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    output = p.clean(timeout=<span class="number">0.1</span>)</span><br><span class="line">    <span class="built_in">print</span>(output.decode(errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">cmd = <span class="string">b&#x27;socat -u FILE:&quot;Bandizip(flag).zip&quot; STDOUT&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[&gt;] Sending: <span class="subst">&#123;cmd&#125;</span>&quot;</span>)</span><br><span class="line">p.sendline(cmd)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Receiving raw stream...&quot;</span>)</span><br><span class="line"></span><br><span class="line">total_data = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 设置短超时，快速轮询</span></span><br><span class="line">        chunk = p.recv(timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        total_data += chunk</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(total_data) &gt; <span class="number">223000</span>: </span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;recv error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Total received: <span class="subst">&#123;<span class="built_in">len</span>(total_data)&#125;</span> bytes&quot;</span>)</span><br><span class="line"></span><br><span class="line">zip_header = <span class="string">b&#x27;\x50\x4B\x03\x04&#x27;</span></span><br><span class="line">start_idx = total_data.find(zip_header)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> start_idx != -<span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Found ZIP header at offset: <span class="subst">&#123;start_idx&#125;</span>&quot;</span>)</span><br><span class="line">    real_size = <span class="number">222544</span></span><br><span class="line">    clean_data = total_data[start_idx : start_idx + real_size]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag_new.zip&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(clean_data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Saved &#x27;flag_new.zip&#x27; (<span class="subst">&#123;<span class="built_in">len</span>(clean_data)&#125;</span> bytes).&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Now verify with: bkcrack -L flag_new.zip&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Still no ZIP header found. Dumping all...&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag_dump.bin&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(total_data)</span><br><span class="line"></span><br><span class="line">p.close()</span><br></pre></td></tr></table></figure>

<p>这下文件就对了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -L flag_new.zip</span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">Archive: flag_new.zip</span><br><span class="line">Index Encryption Compression CRC32    Uncompressed  Packed size Name</span><br><span class="line">----- ---------- ----------- -------- ------------ ------------ ----------------</span><br><span class="line">    0 ZipCrypto  Store       bacedd4d       218800       218812 7.zip</span><br><span class="line">    1 ZipCrypto  Store       83221ac1         3448         3460 data.txt</span><br></pre></td></tr></table></figure>

<p>里面有 7.zip，大概率是要 7 点的那个压缩包</p>
<p>拿着 7:35 的图片的压缩包来 crack</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -C .\flag_new.zip -c 7.zip -p round_10_matched_7.zip</span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">[14:52:49] Z reduction using 218793 bytes of known plaintext</span><br><span class="line">3.9 % (8631 / 218793)</span><br><span class="line">[14:52:50] Attack on 241 Z values at index 211131</span><br><span class="line">Keys: bf431018 6033e5d1 33389c81</span><br><span class="line">100.0 % (241 / 241)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">[14:52:50] Keys</span><br><span class="line">bf431018 6033e5d1 33389c81</span><br><span class="line">$ bkcrack -C flag_new.zip -k bf431018 6033e5d1 33389c81 -U flag_cracked.zip <span class="string">&quot;Volcania&quot;</span></span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">[14:54:02] Writing unlocked archive flag_cracked.zip with password <span class="string">&quot;Volcania&quot;</span></span><br><span class="line">100.0 % (2 / 2)</span><br><span class="line">Wrote unlocked archive.</span><br></pre></td></tr></table></figure>

<p>得到 data.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br><span class="line">MMMMMMMN@MMMMMMMMMMMMMMMMMMMMMMMMMMMMM@MMMMMMHCCMMM@MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM@MM@@@MMMMMMMMMMMMMMMMMMMMMMMMM@MM@@@MM@MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM@CONMMMMMMMMM</span><br><span class="line">MMMMMMMCCO@OCCC@@CCMMMMMM@CCHMMMMMM@CCCOMMMMNCMMMMCCOM@OQMHCOMMMMMMMMQCQ@CCC@MM@C@MMMMMMMMMCCOONMMMNHCCOMNHNMMNCCCOQMMMMQCCOMMMMMMMMM@CCOMNQCNMMCC@M@@@MMMMMMMMMHCOMMMMMMMMQCQMCC@M@@@MCCOMHOCNMMMMMMMMMMM@CCHMMMMMNHNMMMNCMMMMMMMMM</span><br><span class="line">MMMMMMMCCOMMMMMMNCCMMMMM@CCC@C@MMMHCCNMMMMMMNCMMMNCCOMMNCMMCCHM@CQMMHCCNMCCCNC@NC@MMMMMMMMMCCONC@M@CHCCOMCC@MMOC@MMMMM@CCQMMMMMMMMMMMMCCOMMMNC@MCC@MMMMMMMMMMMMMMCCHM@CQMMHCCNMCC@MMMMMCCOMMMNCMMMMMMMMMM@CCC@C@MMMCC@MMMNCMMMMMMMMM</span><br><span class="line">MMMMMMMCCOQOCQMMQCCMMMMMOCCNMHCNMMCC@QCCOMM@QHMMMNCCOHCQ@MMNCC@ONQNNCCHMMCCCMQQNCMMMMMMMMMMCCOMQOMQC@CCOMCC@MMM@QCO@MMOCHMMMMMMMMMMMMMCCO@OCQ@MMCCHCCC@MMMMMMMMMMNCC@ONQNNCCHMMCCHCCC@MCCOMQCC@MMMMMMMMMMOCCNMHCNMMCC@MMM@CH@MMMMMMM</span><br><span class="line">MMMMMMMCCOMMMMMMCCCMMMMHCCHQCHOC@MOC@M@CMMM@QCMMMNCCOMMMMMMMQCOMMMNCCQMMMCCCM@CHOMMMMMMMMMMCCOM@CQCNMCCQMCC@M@O@MMNC@MCCMMMMMMMMMMMMMMCCOMQC@MMMCC@MMMMMMMMMMMMMMMQCOMMMNCCQMMMCC@MMMMMCCOMMNOQMMMMMMMMMHCCHQCHOC@MCC@MMM@CH@MMMMMMM</span><br><span class="line">MMMMMMMCCOMMMMMMNHHM@@@OCOMMMM@CQMMHCCCCMMMMNCMMMNCCQMMMMMMM@OCNMMCCOMMMMCCCMMHC@MMMMMMMMMMCCOMMQCHMMCCQ@NH@MMQCQHCQMM@OCOCQMMMMMMMMM@CCQMMNCHMMCCNNNN@MMMMMMMMMMM@OCNMMCCOMMMMCCNNNN@MCCOMM@OQMMMMMMMMMOCOMMMM@CQ@NH@MMMNCMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM@CNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMOOOOOOOOMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMOOOOOOOOMMMMMMMMMMMMMMMMMMMOOOOOOOOMMMMMMMMMMMMMMMMMMMMMMMMMMMM@MMMOOOOOOOOMMMMMMMMMMMMMMMM@HCMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br><span class="line">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span><br></pre></td></tr></table></figure>

<p>有点抽象，先把 M 换成空格</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094305-105-1765621747344-224.png"></p>
<p>是 <code>flag&#123;pwn_misc_re_web_ai&#125;</code></p>
<h2 id="SMB-Solved"><a href="#SMB-Solved" class="headerlink" title="SMB | Solved"></a>SMB | Solved</h2><p>拿到 SMB2 的数据包，先提取 NTLM</p>
<blockquote>
<p><a href="https://github.com/mlgualtieri/NTLMRawUnHide">https://github.com/mlgualtieri/NTLMRawUnHide</a></p>
</blockquote>
<p>得到 NTLM 信息，拿去 hashcat</p>
<blockquote>
<p><strong>username::domain:ServerChallenge:NTproofstring:modifiedntlmv2response</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rockyou::PC:5649f6b5969a9fbf:f8cb9296a5206484b1baf6bce47abe3b:0101000000000000f68d75c3fb59dc01ba30ab51dc5395c3000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800f68d75c3fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000</span><br><span class="line">rockyou::PC:a230ee46968b6116:c3b172a7df39f6d1765de24170d5f387:0101000000000000ed3fabc7fb59dc01d9b1245c055f29b2000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800ed3fabc7fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000</span><br><span class="line">rockyou::PC:12e83c96f85b09d7:14266416151fcfce3b420575ef030028:0101000000000000ed3fabc7fb59dc01ab5b9b0cfe9b35d0000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800ed3fabc7fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000</span><br><span class="line">rockyou::PC:3822c6dbeba60ca2:4b35d5e49a18a4bf1ce0e68f591799d0:0101000000000000ed3fabc7fb59dc01c0f5befb4ddd6648000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800ed3fabc7fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000</span><br></pre></td></tr></table></figure>

<p>给的数据里面直接就写了 rockyou，所以拿 rockyou 爆破一下，得到密码是 <code>12megankirwin12</code></p>
<ul>
<li>用户名：rockyou</li>
<li>域：PC</li>
<li>密码：<code>12megankirwin12</code></li>
<li>server_challenge<ul>
<li>5649f6b5969a9fbf</li>
<li>a230ee46968b6116</li>
<li>12e83c96f85b09d7</li>
<li>3822c6dbeba60ca2</li>
</ul>
</li>
</ul>
<p>导出一下 sessionkey</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ tshark -n -r SMB.pcapng -Y <span class="string">&#x27;ntlmssp.messagetype == 0x00000003&#x27;</span> -T fields -e ntlmssp.auth.username -e ntlmssp.auth.domain -e ntlmssp.ntlmv2_response.ntproofstr -e ntlmssp.auth.sesskey -e smb2.sesid</span><br><span class="line">Protocol being registered is <span class="string">&quot;Minecraft Java Edition&quot;</span></span><br><span class="line">rockyou PC      f8cb9296a5206484b1baf6bce47abe3b        83ef8765dc2621899e86744f9dd9c5c8        0x0000100000000031</span><br><span class="line">rockyou PC      c3b172a7df39f6d1765de24170d5f387        7d8542d2690e115789f9d07c01334ec4        0x0000100000000031</span><br><span class="line">rockyou PC      14266416151fcfce3b420575ef030028        8a71c61fcb8ed0c8d011a5bf7591b0c3        0x0000100000000031</span><br><span class="line">rockyou PC      4b35d5e49a18a4bf1ce0e68f591799d0        daaab95bb9461bbcf65a89a55ea09adb        0x0000100000000031</span><br></pre></td></tr></table></figure>

<ul>
<li>NTproofstring:sessionkey<ul>
<li>f8cb9296a5206484b1baf6bce47abe3b:83ef8765dc2621899e86744f9dd9c5c8</li>
<li>c3b172a7df39f6d1765de24170d5f387:7d8542d2690e115789f9d07c01334ec4</li>
<li>14266416151fcfce3b420575ef030028:8a71c61fcb8ed0c8d011a5bf7591b0c3</li>
<li>4b35d5e49a18a4bf1ce0e68f591799d0:daaab95bb9461bbcf65a89a55ea09adb</li>
</ul>
</li>
</ul>
<p>算一下 session key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> MD4, MD5, HMAC</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_decrypted_session_key</span>(<span class="params">password: <span class="built_in">str</span>, username: <span class="built_in">str</span>, domain: <span class="built_in">str</span>, ntProofStr: <span class="built_in">str</span>, serverChallenge: <span class="built_in">str</span>, sessionKey: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    password = password</span><br><span class="line">    username = username</span><br><span class="line">    domain = domain</span><br><span class="line">    ntProofStr = ntProofStr</span><br><span class="line">    serverChallenge = serverChallenge</span><br><span class="line">    sessionKey = sessionKey</span><br><span class="line"></span><br><span class="line">    passwordHash = MD4.new(password.encode(<span class="string">&#x27;utf-16-le&#x27;</span>)).digest()</span><br><span class="line">    responseKey = HMAC.new(passwordHash, (username.upper()+domain.upper()).encode(<span class="string">&#x27;utf-16-le&#x27;</span>), MD5).digest()</span><br><span class="line">    keyExchangeKey = HMAC.new(responseKey, <span class="built_in">bytes</span>.fromhex(ntProofStr), MD5).digest()</span><br><span class="line">    decryptedSessionKey = ARC4.new(keyExchangeKey).decrypt(<span class="built_in">bytes</span>.fromhex(sessionKey))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decryptedSessionKey.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    data = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;12megankirwin12&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;rockyou&quot;</span>,</span><br><span class="line">            <span class="string">&quot;domain&quot;</span>: <span class="string">&quot;PC&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ntProofStr&quot;</span>: <span class="string">&quot;f8cb9296a5206484b1baf6bce47abe3b&quot;</span>,</span><br><span class="line">            <span class="string">&quot;serverChallenge&quot;</span>: <span class="string">&quot;5649f6b5969a9fbf&quot;</span>,</span><br><span class="line">            <span class="string">&quot;sessionKey&quot;</span>: <span class="string">&quot;83ef8765dc2621899e86744f9dd9c5c8&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;12megankirwin12&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;rockyou&quot;</span>,</span><br><span class="line">            <span class="string">&quot;domain&quot;</span>: <span class="string">&quot;PC&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ntProofStr&quot;</span>: <span class="string">&quot;c3b172a7df39f6d1765de24170d5f387&quot;</span>,</span><br><span class="line">            <span class="string">&quot;serverChallenge&quot;</span>: <span class="string">&quot;a230ee46968b6116&quot;</span>,</span><br><span class="line">            <span class="string">&quot;sessionKey&quot;</span>: <span class="string">&quot;7d8542d2690e115789f9d07c01334ec4&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;12megankirwin12&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;rockyou&quot;</span>,</span><br><span class="line">            <span class="string">&quot;domain&quot;</span>: <span class="string">&quot;PC&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ntProofStr&quot;</span>: <span class="string">&quot;14266416151fcfce3b420575ef030028&quot;</span>,</span><br><span class="line">            <span class="string">&quot;serverChallenge&quot;</span>: <span class="string">&quot;12e83c96f85b09d7&quot;</span>,</span><br><span class="line">            <span class="string">&quot;sessionKey&quot;</span>: <span class="string">&quot;8a71c61fcb8ed0c8d011a5bf7591b0c3&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;12megankirwin12&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;rockyou&quot;</span>,</span><br><span class="line">            <span class="string">&quot;domain&quot;</span>: <span class="string">&quot;PC&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ntProofStr&quot;</span>: <span class="string">&quot;4b35d5e49a18a4bf1ce0e68f591799d0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;serverChallenge&quot;</span>: <span class="string">&quot;3822c6dbeba60ca2&quot;</span>,</span><br><span class="line">            <span class="string">&quot;sessionKey&quot;</span>: <span class="string">&quot;daaab95bb9461bbcf65a89a55ea09adb&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">        decrypted_key = get_decrypted_session_key(</span><br><span class="line">            item[<span class="string">&quot;password&quot;</span>],</span><br><span class="line">            item[<span class="string">&quot;username&quot;</span>],</span><br><span class="line">            item[<span class="string">&quot;domain&quot;</span>],</span><br><span class="line">            item[<span class="string">&quot;ntProofStr&quot;</span>],</span><br><span class="line">            item[<span class="string">&quot;serverChallenge&quot;</span>],</span><br><span class="line">            item[<span class="string">&quot;sessionKey&quot;</span>]</span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Decrypted Session Key: <span class="subst">&#123;decrypted_key&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ uv run .\smb_get_session_key.py</span><br><span class="line">Decrypted Session Key: a5bfafdad7cb6b35947e06faa4f2504d</span><br><span class="line">Decrypted Session Key: c3b59105fcb305240a4b00ebdd0aa3a3</span><br><span class="line">Decrypted Session Key: 9b48d9ff2ed50318770c284169f389f0</span><br><span class="line">Decrypted Session Key: fa54bf67cc683198e0a035605521dae1</span><br></pre></td></tr></table></figure>

<p>将导出的 session key 添加到 wireshark 里面去</p>
<p>注意先获取到 sessionid （直接从数据包中就能看到，在 <code>smb.sesid</code>）</p>
<ul>
<li>0x0000100000000031</li>
</ul>
<p>要转成小端序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094305-106-1765621747344-226.png"></p>
<ul>
<li>3100000000100000</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-107-1765621747344-227.png"></p>
<p>看到请求了一个 zip，直接弄出来，发现加密了，但是算法为 ZipCrypto Store</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-108-1765621747344-228.png"></p>
<p>里面是 exe，exe 文件有个部分比较固定，考虑 bkcrack，用 exe 的签名部分即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> -n <span class="string">&quot;0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000&quot;</span> | xxd -r -ps &gt; exe_header</span><br><span class="line">$ bkcrack -C %5cletter.zip -c letter.exe -p .\exe_header -o 64</span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">[11:28:27] Z reduction using 56 bytes of known plaintext</span><br><span class="line">100.0 % (56 / 56)</span><br><span class="line">[11:28:27] Attack on 141108 Z values at index 71</span><br><span class="line">Keys: 68cc45ab 864060ce ac958caa</span><br><span class="line">75.6 % (106623 / 141108)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 106623</span><br><span class="line">[11:29:47] Keys</span><br><span class="line">68cc45ab 864060ce ac958caa</span><br><span class="line">$ bkcrack -C %5cletter.zip -k 68cc45ab 864060ce ac958caa -U output.zip Volcania</span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">[11:31:48] Writing unlocked archive output.zip with password <span class="string">&quot;Volcania&quot;</span></span><br><span class="line">100.0 % (1 / 1)</span><br><span class="line">Wrote unlocked archive.</span><br></pre></td></tr></table></figure>

<p>然后解压得到 exe</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-109-1765621747344-229.png"></p>
<div class="note info flat"><p>以下程序分析部分是队友做的</p>
</div>

<p>发现运行程序每次都只打印一个字符，但是直接搜 flag 搜不到，猜测是加密了运行时解密</p>
<p>下面有一段数据</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-112-1765621747344-231.png?v=1"></p>
<p>这段数据会被转换成 String</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-110-1765621747344-230.png?v=1"></p>
<p>然后在 <code>gen_pool</code> 通过指针传入了这个参数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-111-1765621747344-232.png?v=1"></p>
<p>看到 <code>gen_pool</code> 函数的定义</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-113-1765621747344-233.png?v=1"></p>
<p><code>*(arg1 + 8)</code> 就对应的 String 的数据地址，在 shuffle 之前存在对传入的 String 的处理，可猜测数据是在这进行了解密</p>
<p>可在处理完后的地方打断点，看 <code>*(arg1 + 8)</code> 即可看到 Flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-114-1765621747344-234.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;N0w_U-V1ctory&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ZipCracker-Solved"><a href="#ZipCracker-Solved" class="headerlink" title="ZipCracker | Solved"></a>ZipCracker | Solved</h2><p>不懂，先给AI看一眼</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这是一个 <span class="strong">**GNU Radio Companion (GRC)**</span> 的流程图文件（通常后缀为 <span class="code">`.grc`</span>）。</span><br><span class="line"></span><br><span class="line">GNU Radio 是一个开源的软件无线电（SDR）开发工具包，这个文件描述了一个信号处理的流程。</span><br><span class="line"></span><br><span class="line"><span class="section">### 文件内容分析 (CTF 角度)</span></span><br><span class="line"></span><br><span class="line">从代码结构来看，这个流程图正在模拟一个 <span class="strong">**NBFM (窄带调频) 发射机**</span>。以下是关键部分的解读：</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span>  <span class="strong">**输入源 (Input):**</span></span><br><span class="line"><span class="bullet">    *</span>   <span class="code">`blocks_wavfile_source_0`</span>: 它尝试读取一个名为 <span class="code">`E:\Download\ZipCracker\password.wav`</span> 的音频文件。</span><br><span class="line"><span class="bullet">    *</span>   <span class="strong">**CTF 提示:**</span> 这个文件名 <span class="code">`password.wav`</span> 非常关键，暗示这个音频里包含了解压缩某个 ZIP 文件的密码。</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span>  <span class="strong">**信号处理 (Processing):**</span></span><br><span class="line"><span class="bullet">    *</span>   <span class="code">`analog_nbfm_tx_0`</span>: 这是一个 NBFM 发射模块。它将输入的音频数据调制成射频信号（IQ 信号）。</span><br><span class="line"><span class="bullet">    *</span>   <span class="code">`pl_freq`</span>: 这里还加入了一个亚音（PL Tone），虽然默认值是 0.0，但在无线电通信中常用于静噪控制。</span><br><span class="line"></span><br><span class="line"><span class="bullet">3.</span>  <span class="strong">**输出 (Output):**</span></span><br><span class="line"><span class="bullet">    *</span>   <span class="strong">**文件输出**</span>: 流程图通过 <span class="code">`blocks_complex_to_float_0`</span> 将生成的复数 IQ 信号拆分成实部和虚部，分别写入：</span><br><span class="line"><span class="bullet">        *</span>   <span class="code">`flag1.txt`</span> (实部/I路)</span><br><span class="line"><span class="bullet">        *</span>   <span class="code">`flag2.txt`</span> (虚部/Q路)</span><br><span class="line"><span class="bullet">    *</span>   <span class="strong">**网络流**</span>: <span class="code">`zeromq_pub_sink_0`</span> 将数据发送到 <span class="code">`tcp://127.0.0.1:49201`</span>。</span><br><span class="line"></span><br><span class="line"><span class="section">### 这道题可能在考什么？</span></span><br><span class="line"></span><br><span class="line">这道题通常有两种考法：</span><br><span class="line"></span><br><span class="line"><span class="section">#### 情况 A：你需要恢复密码</span></span><br><span class="line">题目可能给了你 <span class="code">`flag1.txt`</span> 和 <span class="code">`flag2.txt`</span>（或者生成后的单一信号文件），你需要：</span><br><span class="line"><span class="bullet">1.</span>  <span class="strong">**合成 IQ 信号**</span>: 将两个 txt 文件的数据合并回一个复数 IQ 信号文件（通常是 <span class="code">`.cfile`</span> 或 <span class="code">`.raw`</span> 格式）。</span><br><span class="line"><span class="bullet">2.</span>  <span class="strong">**解调**</span>: 使用软件（如 GNU Radio, GQRX, 或者 Python 脚本）对这个信号进行 <span class="strong">**NBFM 解调**</span>。</span><br><span class="line"><span class="bullet">3.</span>  <span class="strong">**听音频**</span>: 解调后你会得到原始的音频，播放它，听里面说出的“密码”。</span><br><span class="line"><span class="bullet">4.</span>  <span class="strong">**解压**</span>: 用听到的密码去解压题目给的加密 ZIP 文件。</span><br><span class="line"></span><br><span class="line"><span class="section">#### 情况 B：你需要运行这个脚本</span></span><br><span class="line">如果题目给了你 <span class="code">`password.wav`</span> 但它是加密的或者损坏的，或者需要你生成特定的波形来获取 Flag。</span><br><span class="line">你需要安装 <span class="strong">**GNU Radio**</span> (Linux下常用，Windows也有)，用 <span class="code">`gnuradio-companion`</span> 打开这个文件。</span><br><span class="line"><span class="bullet">*</span>   <span class="strong">**注意**</span>: 你需要修改文件路径（比如 <span class="code">`E:\Download\ZipCracker\...`</span>）为你本地的实际路径，否则运行会报错。</span><br><span class="line"></span><br><span class="line"><span class="section">### 简单的解题思路 (针对情况 A)</span></span><br><span class="line"></span><br><span class="line">如果你手头有生成出来的 <span class="code">`flag1.txt`</span> 和 <span class="code">`flag2.txt`</span>，可以使用 Python 快速还原并解调（如果你不想装庞大的 GNU Radio）：</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span>  读取两个文件，组合成 <span class="code">`I + jQ`</span> 的复数数组。</span><br><span class="line"><span class="bullet">2.</span>  使用 <span class="code">`numpy`</span> 或 <span class="code">`scipy`</span> 进行 FM 解调。</span><br><span class="line"><span class="bullet">3.</span>  保存为 <span class="code">`.wav`</span> 文件并收听。</span><br><span class="line"></span><br><span class="line">或者，如果题目只是给了这个文本内容让你分析：</span><br><span class="line"><span class="strong">**核心线索是：这是一个将 `password.wav` 进行 NBFM 调制并保存为 IQ 数据的脚本。你需要做的就是逆向这个过程（NBFM 解调）来听到密码。**</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">这是一个非常典型的无线电取证（SDR Forensics）题目。</span><br><span class="line"></span><br><span class="line">根据 GRC 文件分析，<span class="code">`flag1`</span> 和 <span class="code">`flag2`</span> 分别是 <span class="strong">**IQ 信号**</span> 的 <span class="strong">**I路（实部）**</span> 和 <span class="strong">**Q路（虚部）**</span> 数据。</span><br><span class="line">题目原始逻辑是：<span class="code">`音频`</span> -&gt; <span class="code">`NBFM调制`</span> -&gt; <span class="code">`IQ信号`</span> -&gt; <span class="code">`拆分保存`</span>。</span><br><span class="line">你需要做的逆向过程是：<span class="code">`合并IQ信号`</span> -&gt; <span class="code">`NBFM解调`</span> -&gt; <span class="code">`保存为音频`</span> -&gt; <span class="code">`听取密码`</span>。</span><br><span class="line"></span><br><span class="line">即使你没有安装 GNU Radio，也可以直接用 <span class="strong">**Python**</span> 脚本来处理这两个文件。</span><br><span class="line"></span><br><span class="line"><span class="section">### 核心参数提取（从 GRC 文件中）</span></span><br><span class="line"><span class="bullet">*</span>   <span class="strong">**采样率 (Sample Rate):**</span> GRC 中 <span class="code">`if_rate`</span> = <span class="code">`usrp_rate / 3`</span> = <span class="code">`576000 / 3`</span> = <span class="strong">**192000 Hz**</span>。</span><br><span class="line"><span class="bullet">*</span>   <span class="strong">**数据类型:**</span> <span class="code">`float`</span> (32位浮点数)。GNU Radio 的 File Sink 默认保存的是<span class="strong">**二进制**</span>数据，而不是人类可读的文本。</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="section">### 解题方法：使用 Python 脚本还原音频</span></span><br><span class="line"></span><br><span class="line">你需要安装 python 的 <span class="code">`numpy`</span> 和 <span class="code">`scipy`</span> 库：</span><br><span class="line"><span class="code">```bash</span></span><br><span class="line"><span class="code">pip install numpy scipy</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"></span><br><span class="line">然后运行以下脚本（将脚本放在 <span class="code">`flag1`</span> 和 <span class="code">`flag2`</span> 同目录下）：</span><br><span class="line"></span><br><span class="line"><span class="code">```python</span></span><br><span class="line"><span class="code">import numpy as np</span></span><br><span class="line"><span class="code">from scipy.io import wavfile</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"># 1. 配置参数</span></span><br><span class="line"><span class="code"># 从 GRC 文件中分析得出：if_rate = 576000 / 3</span></span><br><span class="line"><span class="code">SAMPLE_RATE = 192000 </span></span><br><span class="line"><span class="code">FILENAME_I = &#x27;flag1.txt&#x27; # 如果题目给的文件名没有后缀，请自行修改为 &#x27;flag1&#x27;</span></span><br><span class="line"><span class="code">FILENAME_Q = &#x27;flag2.txt&#x27; # 同上，修改为 &#x27;flag2&#x27;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">print(&quot;正在读取文件...&quot;)</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"># 2. 读取数据</span></span><br><span class="line"><span class="code"># GNU Radio 的 File Sink 默认存储为 raw binary float32</span></span><br><span class="line"><span class="code"># 如果你用记事本打开全是乱码，那就是二进制；如果是数字文本，需要改用 loadtxt</span></span><br><span class="line"><span class="code">try:</span></span><br><span class="line"><span class="code">    # 尝试作为二进制读取</span></span><br><span class="line"><span class="code">    data_i = np.fromfile(FILENAME_I, dtype=np.float32)</span></span><br><span class="line"><span class="code">    data_q = np.fromfile(FILENAME_Q, dtype=np.float32)</span></span><br><span class="line"><span class="code">except FileNotFoundError:</span></span><br><span class="line"><span class="code">    print(f&quot;错误：找不到文件，请确认文件名是否为 &#123;FILENAME_I&#125; 和 &#123;FILENAME_Q&#125;&quot;)</span></span><br><span class="line"><span class="code">    exit()</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"># 确保两个文件长度一致</span></span><br><span class="line"><span class="code">min_len = min(len(data_i), len(data_q))</span></span><br><span class="line"><span class="code">data_i = data_i[:min_len]</span></span><br><span class="line"><span class="code">data_q = data_q[:min_len]</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"># 3. 合成 IQ 复数信号</span></span><br><span class="line"><span class="code"># I 是实部，Q 是虚部</span></span><br><span class="line"><span class="code">iq_signal = data_i + 1j * data_q</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">print(&quot;正在进行 NBFM 解调...&quot;)</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"># 4. NBFM 解调 (非相干解调)</span></span><br><span class="line"><span class="code"># 核心原理：计算相邻采样点之间的相位差 (即频率)</span></span><br><span class="line"><span class="code"># result = angle( s[n] * conj(s[n-1]) )</span></span><br><span class="line"><span class="code">demodulated = np.angle(iq_signal[1:] * np.conj(iq_signal[:-1]))</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"># 5. 音频后处理</span></span><br><span class="line"><span class="code"># 归一化到 -1.0 到 1.0 之间，防止爆音</span></span><br><span class="line"><span class="code">demodulated = demodulated / np.max(np.abs(demodulated))</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"># 6. 保存为 WAV 文件</span></span><br><span class="line"><span class="code">OUTPUT_FILE = &#x27;recovered_password.wav&#x27;</span></span><br><span class="line"><span class="code">wavfile.write(OUTPUT_FILE, SAMPLE_RATE, demodulated.astype(np.float32))</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">print(f&quot;完成！请播放 &#123;OUTPUT_FILE&#125; 听取密码。&quot;)</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"></span><br><span class="line"><span class="section">### 拿到音频后怎么办？</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span>  <span class="strong">**播放音频**</span>：生成的 <span class="code">`recovered_password.wav`</span> 可能会有明显的底噪（嘶嘶声），这是 NBFM 解调的特性。</span><br><span class="line"><span class="bullet">2.</span>  <span class="strong">**听取内容**</span>：</span><br><span class="line"><span class="bullet">    *</span>   如果是<span class="strong">**人声**</span>，仔细听他在读什么（通常是英语字母或数字）。</span><br><span class="line"><span class="bullet">    *</span>   如果是<span class="strong">**“滴滴滴”**</span>的声音，可能是摩斯电码。</span><br><span class="line"><span class="bullet">    *</span>   如果是<span class="strong">**怪异的拨号声**</span>，可能是 DTMF 信号（可以用手机上的 DTMF 识别软件或 Audacity 分析频谱）。</span><br><span class="line"><span class="bullet">3.</span>  <span class="strong">**解压**</span>：题目名字叫 <span class="code">`zipcracker`</span>，说明这个 flag 或者是解压密码，或者是需要你根据听到的内容去构造 flag。</span><br><span class="line"></span><br><span class="line"><span class="section">### 常见问题排错</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">*</span>   <span class="strong">**读取报错？**</span></span><br><span class="line"><span class="bullet">    *</span>   如果脚本运行出来的音频全是噪音，没有任何有效信息，检查一下 <span class="code">`flag1`</span> 和 <span class="code">`flag2`</span> 文件内容。用记事本打开，如果是<span class="strong">**人类可读的数字**</span>（例如 <span class="code">`0.1234`</span>），则脚本中 <span class="code">`np.fromfile`</span> 需要改为 <span class="code">`np.loadtxt`</span>。但根据 GR 默认行为，大概率是二进制乱码。</span><br><span class="line"><span class="bullet">*</span>   <span class="strong">**语速太快/太慢？**</span></span><br><span class="line"><span class="bullet">    *</span>   修改脚本中的 <span class="code">`SAMPLE_RATE`</span>。如果声音像花栗鼠，把采样率改低（比如 48000）；如果声音像巨人，把采样率改高。但 192000 是根据题目计算出的理论正确值。</span><br><span class="line"><span class="bullet">*</span>   <span class="strong">**声音太小？**</span></span><br><span class="line"><span class="bullet">    *</span>   使用 Audacity 打开生成的 wav 文件，进行“放大（Amplify）”处理。</span><br></pre></td></tr></table></figure>

<p>OK，用脚本处理一下，丢进 AU，很明显的摩斯电码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-115-1765621747345-235.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-116-1765621747345-236.png"></p>
<p>得到密码，解压给到的 flag.zip</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-117-1765621747345-237.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-118-1765621747345-238.png"></p>
<p>好好好今天是 bkcrack 专场是吧</p>
<p>把 flag.txt 的明文头和尾巴拆成了两部分，放到 head.txt 和 tail.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -C flag.zip -c flag.txt -p head.txt -o 0 -x 25 2121217d</span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">[15:13:59] Z reduction using 1 bytes of known plaintext</span><br><span class="line">100.0 % (1 / 1)</span><br><span class="line">[15:13:59] Attack on 2555904 Z values at index 6</span><br><span class="line">Keys: 33b19021 93c4a78d 9ceed931</span><br><span class="line">13.3 % (339167 / 2555904)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 339167</span><br><span class="line">[15:17:16] Keys</span><br><span class="line">33b19021 93c4a78d 9ceed931</span><br><span class="line"></span><br><span class="line">$ bkcrack -C flag.zip -k 33b19021 93c4a78d 9ceed931 -U flag-nopasswd.zip <span class="string">&quot;Volcania&quot;</span></span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">[15:17:52] Writing unlocked archive flag-nopasswd.zip with password <span class="string">&quot;Volcania&quot;</span></span><br><span class="line">100.0 % (1 / 1)</span><br><span class="line">Wrote unlocked archive.</span><br></pre></td></tr></table></figure>

<p>得到真正的 flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-119-1765621747345-239.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Y0u_r_th3_Z1p_k1ng!!!!!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="The-Rogue-Beacon-Solved"><a href="#The-Rogue-Beacon-Solved" class="headerlink" title="The_Rogue_Beacon | Solved"></a>The_Rogue_Beacon | Solved</h2><p>给了总线信号数据包</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-120-1765621747345-241.png"></p>
<p>有 0x244，这个是车速信号，直接提取 0x244 最大的那个就好了，然后避开那种看起来很可疑的东西</p>
<p>让 AI 直接撸一个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># ================= 配置 =================</span></span><br><span class="line">TARGET_ID = <span class="number">0x244</span>  <span class="comment"># 目标 ID</span></span><br><span class="line"><span class="comment"># 根据你的样本 0000001b16，有效数据在最后两个字节</span></span><br><span class="line">BYTE_START = <span class="number">3</span> </span><br><span class="line">BYTE_END = <span class="number">5</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> scapy.layers.can <span class="keyword">import</span> CAN</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    load_contrib(<span class="string">&#x27;can&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pcap_file = <span class="string">&#x27;The Rogue Beacon.pcapng&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] 正在读取 <span class="subst">&#123;pcap_file&#125;</span> ...&quot;</span>)</span><br><span class="line">packets = rdpcap(pcap_file)</span><br><span class="line"></span><br><span class="line">indices = []</span><br><span class="line">values = []</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] 正在提取 ID <span class="subst">&#123;<span class="built_in">hex</span>(TARGET_ID)&#125;</span> 的 Byte <span class="subst">&#123;BYTE_START&#125;</span>-<span class="subst">&#123;BYTE_END&#125;</span> 数据...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx, pkt <span class="keyword">in</span> <span class="built_in">enumerate</span>(packets, <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> pkt.haslayer(CAN):</span><br><span class="line">        can = pkt.getlayer(CAN)</span><br><span class="line">        <span class="keyword">if</span> can.identifier == TARGET_ID:</span><br><span class="line">            data = can.data</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 确保数据长度足够</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt;= BYTE_END:</span><br><span class="line">                hex_val = data[BYTE_START:BYTE_END]</span><br><span class="line">                val = <span class="built_in">int</span>.from_bytes(hex_val, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">                </span><br><span class="line">                indices.append(idx)</span><br><span class="line">                values.append(val)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> values:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] 错误：没有提取到数据，请检查 ID 或 长度。&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将数据打包排序：(index, value)，按 value 从大到小排</span></span><br><span class="line">sorted_data = <span class="built_in">sorted</span>(<span class="built_in">zip</span>(indices, values), key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nTop 5 最大值候选:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Rank\tPacket_Index\tValue (Dec)\tValue (Hex)&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(<span class="number">5</span>, <span class="built_in">len</span>(sorted_data))):</span><br><span class="line">    idx, val = sorted_data[i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;#<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>\t<span class="subst">&#123;idx&#125;</span>\t\t<span class="subst">&#123;val&#125;</span>\t\t<span class="subst">&#123;<span class="built_in">hex</span>(val)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ================= 修改部分：自动计算 Top 1 的 Flag =================</span></span><br><span class="line"><span class="keyword">if</span> sorted_data:</span><br><span class="line">    <span class="comment"># 直接取排序后的第一个（最大值）</span></span><br><span class="line">    best_idx = sorted_data[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    best_val = sorted_data[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[+] 自动锁定最大值数据包: Packet #<span class="subst">&#123;best_idx&#125;</span> (Value: <span class="subst">&#123;best_val&#125;</span>)&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算 SHA256</span></span><br><span class="line">    flag_hash = hashlib.sha256(<span class="built_in">str</span>(best_idx).encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[SUCCESS] 你的 Flag 是: flag&#123;&#123;<span class="subst">&#123;flag_hash&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] 未找到数据，无法计算 Flag&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最后再弹窗画图（关闭窗口后脚本结束）</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n[+] 正在显示图表以供确认...&quot;</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">6</span>))</span><br><span class="line">plt.plot(indices, values, label=<span class="string">f&quot;ID <span class="subst">&#123;<span class="built_in">hex</span>(TARGET_ID)&#125;</span> (Bytes <span class="subst">&#123;BYTE_START&#125;</span>-<span class="subst">&#123;BYTE_END&#125;</span>)&quot;</span>)</span><br><span class="line">plt.title(<span class="string">f&quot;Speed Curve Analysis - ID <span class="subst">&#123;<span class="built_in">hex</span>(TARGET_ID)&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Packet Index (Frame Number)&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Raw Value&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">uv run .\sol.py</span><br><span class="line">[+] 正在读取 The Rogue Beacon.pcapng ...</span><br><span class="line">[+] 正在提取 ID 0x244 的 Byte 3-5 数据...</span><br><span class="line"></span><br><span class="line">Top 5 最大值候选:</span><br><span class="line">Rank    Packet_Index    Value (Dec)     Value (Hex)</span><br><span class="line">--------------------------------------------------</span><br><span class="line"><span class="comment">#1      12149           13796           0x35e4</span></span><br><span class="line"><span class="comment">#2      12125           13777           0x35d1</span></span><br><span class="line"><span class="comment">#3      12179           13777           0x35d1</span></span><br><span class="line"><span class="comment">#4      12100           13759           0x35bf</span></span><br><span class="line"><span class="comment">#5      12201           13759           0x35bf</span></span><br><span class="line">--------------------------------------------------</span><br><span class="line"></span><br><span class="line">[+] 自动锁定最大值数据包: Packet <span class="comment">#12149 (Value: 13796)</span></span><br><span class="line"></span><br><span class="line">[SUCCESS] 你的 Flag 是: flag&#123;9db878fd06dd7587a91c0fb600e0e9f7c3ea310e75f36253ef57ac2d92dd8c29&#125;</span><br><span class="line"></span><br><span class="line">[+] 正在显示图表以供确认...</span><br></pre></td></tr></table></figure>

<p>得到 <code>flag&#123;9db878fd06dd7587a91c0fb600e0e9f7c3ea310e75f36253ef57ac2d92dd8c29&#125;</code></p>
<h2 id="Whiteout-Solved"><a href="#Whiteout-Solved" class="headerlink" title="Whiteout | Solved"></a>Whiteout | Solved</h2><p>直接导入 docker</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker load -i image.tar</span><br></pre></td></tr></table></figure>

<p>然后可以看到有一个 decode.py 和一个 syslog.bin</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-121-1765621747345-240.png"></p>
<ul>
<li>6ad10b1fede380e2db5571dfe343455d33dd1f07588368ff59ee2a9a826739a9&#x2F;opt&#x2F;app 里面有 decode.py</li>
<li>d53154d4f2499c5c31fdd61d359d2a9a0b9076ac639b102bb913c752f5769cfb&#x2F;opt&#x2F;.data&#x2F;logs 里面有 syslog.bin</li>
</ul>
<p>直接拿出来，一个简单异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">KEY = <span class="number">0x37</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;syslog.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">    </span><br><span class="line">decoded = <span class="built_in">bytes</span>(b ^ KEY <span class="keyword">for</span> b <span class="keyword">in</span> data)</span><br><span class="line"><span class="built_in">print</span>(decoded)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ uv run .\sol.py</span><br><span class="line">b<span class="string">&#x27;flag&#123;docker_whiteout_forensics_is_fun&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Blue"><a href="#Blue" class="headerlink" title="Blue"></a>Blue</h2><p>题目名字为 blue，看看蓝色通道，发现可能藏有 zip（50 4b 03 04）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-122-1765621747345-242.png"></p>
<p>有点怪怪的，说实话，不是那么集中，看样子是隔位提取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">RAW_PATH = <span class="string">&quot;blue/blue/raw.bin&quot;</span></span><br><span class="line">OUT_PATH = <span class="string">&quot;blue/blue/extracted_nibbles_skip1_off0.bin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_high_nibbles_and_combine</span>(<span class="params">raw: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    nibbles = [(b &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span> <span class="keyword">for</span> b <span class="keyword">in</span> raw]</span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(nibbles) - <span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">        out.append((nibbles[i] &lt;&lt; <span class="number">4</span>) | nibbles[i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(RAW_PATH, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        raw_data = f.read()</span><br><span class="line"></span><br><span class="line">    extracted = extract_high_nibbles_and_combine(raw_data)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(OUT_PATH, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> out_f:</span><br><span class="line">        out_f.write(extracted)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Wrote <span class="subst">&#123;OUT_PATH&#125;</span> (<span class="subst">&#123;<span class="built_in">len</span>(extracted)&#125;</span> bytes)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>隔位提取出来一个压缩包，带加密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-123-1765621747345-243.png"></p>
<p>ZipCrypto Store，怎么又是 bkcrack，用 png 文件头爆一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> 89504E470D0A1A0A0000000D49484452 | xxd -r -ps &gt; png_header</span><br><span class="line">$ bkcrack -C extracted_nibbles_skip1_off0.zip -c xor.png -p png_header -o 0</span><br><span class="line">bkcrack 1.8.1 - 2025-10-25</span><br><span class="line">[13:01:17] Z reduction using 9 bytes of known plaintext</span><br><span class="line">100.0 % (9 / 9)</span><br><span class="line">[13:01:17] Attack on 707085 Z values at index 6</span><br><span class="line">Keys: 68cc45ab 864060ce ac958caa</span><br><span class="line">29.2 % (206267 / 707085)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 206267</span><br><span class="line">[13:03:45] Keys</span><br><span class="line">68cc45ab 864060ce ac958caa</span><br><span class="line">$ bkcrack -C .\extracted_nibbles_skip1_off0.zip -k 68cc45ab 864060ce ac958caa -U output.zip <span class="string">&quot;Volcania&quot;</span></span><br></pre></td></tr></table></figure>

<p>图片丢进 010 发现最后的 IEND 块后还有东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-124-1765621747345-244.png"></p>
<p><code>80504e47</code> 开头，应该是个图，弄出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-125-1765621747346-245.png"></p>
<p>不明所以的图，但是题目上一张图片的名字是 xor，应该是要跟什么异或一下，但这张图不是灰度图（即RGB相等），所以丢进 PS 看看，发现只有蓝色通道有东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-126-1765621747346-246.png"></p>
<p>尝试提取蓝色通道的数据，但没啥用；试着用这张图跟 xor.png 进行 xor 也没啥用，不懂</p>
<p>尝试一下只跟蓝色通道 XOR 看看，让 AI 写个 script，结果还是不对，没招了</p>
<h2 id="超越感官极致"><a href="#超越感官极致" class="headerlink" title="超越感官极致"></a>超越感官极致</h2><div class="note info flat"><p>来都来了，先致敬沙鹰三枪背身</p>
</div>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-127-1765621747346-247.png"></p>
<p>发现注释，可能有用</p>
<p>binwalk一下，毕竟文件那么大</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-128-1765621747346-248.png"></p>
<p>那我还说啥了，提取一下呗</p>
<p>嗯？不行，那就 foremost 一下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094306-129-1765621747346-249.png"></p>
<p>发现出来一个压缩包，里面还有一张图 <code>？.png</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094307-130-1765621747346-250.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094307-131-1765621747346-251.png"></p>
<p>不是？又是杂色图？但是这个大小跟分辨率不符，IDAT 的数据非常多，甚至去到了 482 chunks</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/image-20251213173415554-1765620094319-173-1765621747346-252.png"></p>
<p>让 AI 写个脚本弄一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;？.png&quot;</span>  <span class="comment"># 你的文件名</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 提取所有 IDAT 数据块</span></span><br><span class="line"><span class="comment"># PNG 结构: Length(4) + ChunkType(4) + Data(Length) + CRC(4)</span></span><br><span class="line"><span class="comment"># 我们需要跳过 header，遍历 chunks</span></span><br><span class="line">pos = <span class="number">8</span>  <span class="comment"># Skip PNG signature</span></span><br><span class="line">idat_data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> pos &lt; <span class="built_in">len</span>(data):</span><br><span class="line">    length = struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, data[pos:pos+<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">    chunk_type = data[pos+<span class="number">4</span>:pos+<span class="number">8</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> chunk_type == <span class="string">b&#x27;IDAT&#x27;</span>:</span><br><span class="line">        idat_data += data[pos+<span class="number">8</span> : pos+<span class="number">8</span>+length]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> chunk_type == <span class="string">b&#x27;IEND&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">    pos += <span class="number">12</span> + length</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;IDAT 压缩数据大小: <span class="subst">&#123;<span class="built_in">len</span>(idat_data)&#125;</span> bytes&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 解压数据</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    decompressed_data = zlib.decompress(idat_data)</span><br><span class="line">    total_len = <span class="built_in">len</span>(decompressed_data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解压后真实数据大小: <span class="subst">&#123;total_len&#125;</span> bytes&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解压失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 爆破宽高</span></span><br><span class="line"><span class="comment"># 你的截图显示 offset 0x19 处是 08 02 -&gt; BitDepth=8, ColorType=2 (RGB)</span></span><br><span class="line"><span class="comment"># 所以 BytesPerPixel = 3</span></span><br><span class="line">bytes_per_pixel = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;正在根据数据大小反推宽高...&quot;</span>)</span><br><span class="line">found = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设宽度在 1 到 10000 之间</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10000</span>):</span><br><span class="line">    <span class="comment"># 公式: Total = H * (W * 3 + 1)</span></span><br><span class="line">    <span class="comment"># 所以: H = Total / (W * 3 + 1)</span></span><br><span class="line">    </span><br><span class="line">    line_bytes = w * bytes_per_pixel + <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> total_len % line_bytes == <span class="number">0</span>:</span><br><span class="line">        h = total_len // line_bytes</span><br><span class="line">        <span class="comment"># 过滤掉显然不合理的比例（比如 1x10000000）</span></span><br><span class="line">        <span class="keyword">if</span> h &lt; <span class="number">100000</span> <span class="keyword">and</span> w * h &gt; <span class="number">1000000</span>: <span class="comment"># 假设像素总数应该比较大</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[!] 可能的宽高: 宽度=<span class="subst">&#123;w&#125;</span>, 高度=<span class="subst">&#123;h&#125;</span>&quot;</span>)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 自动修复文件头</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;正在尝试修复为 <span class="subst">&#123;w&#125;</span>x<span class="subst">&#123;h&#125;</span> ...&quot;</span>)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f_src:</span><br><span class="line">                content = <span class="built_in">bytearray</span>(f_src.read())</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 修改 IHDR 中的宽高 (Offset 16-24)</span></span><br><span class="line">                <span class="comment"># 010 Editor 截图显示 IHDR 从 offset 0x0C 开始 (Length)</span></span><br><span class="line">                <span class="comment"># 实际宽高数据在 offset 0x10 (16) 开始</span></span><br><span class="line">                struct.pack_into(<span class="string">&#x27;&gt;I&#x27;</span>, content, <span class="number">16</span>, w)</span><br><span class="line">                struct.pack_into(<span class="string">&#x27;&gt;I&#x27;</span>, content, <span class="number">20</span>, h)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 不需要修正 CRC，因为我们要用看图软件打开，</span></span><br><span class="line">                <span class="comment"># 大部分看图软件会忽略 CRC 错误，或者我们稍后手动修。</span></span><br><span class="line">                <span class="comment"># 如果 PS 打不开，就用 Chrome/Edge 浏览器打开修复后的图片。</span></span><br><span class="line">                </span><br><span class="line">                out_name = <span class="string">f&quot;fixed_<span class="subst">&#123;w&#125;</span>_<span class="subst">&#123;h&#125;</span>.png&quot;</span></span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(out_name, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">                    f_out.write(content)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;已保存: <span class="subst">&#123;out_name&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;未找到合适的宽高组合，请检查是否是 RGBA (4通道) 或其他格式。&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>发现三种组合，但是没啥用，看不出东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/image-20251213173521994-1765620094319-172-1765621747346-253.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ uv run .\preview.py</span><br><span class="line">[+] 正在读取 ？.png ...</span><br><span class="line">[+] 解压成功！数据总大小: 31457280 字节</span><br><span class="line">[+] 找到 3 个可能的组合，准备绘制预览...</span><br><span class="line">    方案 1: 1365x7680 (RGB)</span><br><span class="line">    方案 2: 3413x3072 (RGB)</span><br><span class="line">    方案 3: 5461x1920 (RGB)</span><br></pre></td></tr></table></figure>

<h2 id="PunkFace"><a href="#PunkFace" class="headerlink" title="PunkFace"></a>PunkFace</h2><div class="note info flat"><p>这题的 word 直接把我电脑卡死了，我还导入了飞书来着，结果飞书在线也卡死了</p>
</div>

<p>解压 docx 文档，发现 document.xml 非常大，有很多颜色相关的内容</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/image-20251213173634217-1765620094319-174-1765621747346-254.png"></p>
<p>队友弄了个脚本来提取颜色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;document.xml&quot;</span></span><br><span class="line"></span><br><span class="line">pixels = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> fp:</span><br><span class="line">        pixels.extend(re.findall(<span class="string">r&#x27;&lt;w:r&gt;&lt;w:rPr&gt;&lt;w:color w:val=&quot;([0-9A-F]+)&quot;\/&gt;&lt;\/w:rPr&gt;&lt;w:t xml:space=&quot;preserve&quot;&gt; &lt;\/w:t&gt;&lt;\/w:r&gt;&#x27;</span>, line))</span><br><span class="line"></span><br><span class="line">width, height = <span class="number">1024</span>, <span class="number">1024</span></span><br><span class="line"><span class="keyword">assert</span> height * width == <span class="built_in">len</span>(pixels)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height)) <span class="keyword">as</span> im:</span><br><span class="line">    <span class="keyword">for</span> pixel, (y, x) <span class="keyword">in</span> <span class="built_in">zip</span>(pixels, itertools.product(<span class="built_in">range</span>(height), <span class="built_in">range</span>(width))):</span><br><span class="line">        rgb = <span class="built_in">int</span>(pixel, <span class="number">16</span>)</span><br><span class="line">        color = ((rgb &gt;&gt; <span class="number">16</span>), ((rgb &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>), (rgb &amp; <span class="number">0xFF</span>))</span><br><span class="line">        im.putpixel((x, y), color)</span><br><span class="line">    im.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094307-132-1765621747346-255.png"></p>
<p>怎么还是这种图？？！我对这种图真没招 &#x3D;-&#x3D;</p>
<p>队友发现了4通道有东西（这谁想得到woc）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/image-20251213174515406-1765621747339-215.png"></p>
<p>得到一个图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765620094307-133-1765621747347-256.png"></p>
<p>改下颜色，得到</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/1765621747339-216.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4e 65 74 77 6f 72 6b 20 73 65 63 75 72 69 74 79 20 69 73 20 61 6e 20 75 6d 62 72 65 6c 6c 61 20 74 65 72 6d 20 74 6f 20 64 65 73 63 72 69 62 65 20 73 65 63 75 72 69 74 79 20 63 6f 6e 74 72 6f 6c 73 2c 20 70 6f 6c 69 63 69 65 73 2c 20 70 72 6f 63 65 73 73 65 73 20 61 6e 64 20 70 72 61 63 74 69 63 65 73 20 61 64 6f 70 74 65 64 20 74 6f 20 70 72 65 76 65 6e 74 2c 20 64 65 74 65 63 74 20 61 6e 64 20 6d 6f 6e 69 74 6f 72 20 75 6e 61 75 74 68 6f 72 69 7a 65 64 20 61 63 63 65 73 73 2c 20 6d 69 73 75 73 65 2c 20 6d 6f 64 69 66 69 63 61 74 69 6f 6e 2c 20 6f 72 20 64 65 6e 69 61 6c 20 6f 66 20 61 20 63 6f 6d 70 75 74 65 72 20 6e 65 74 77 6f 72 6b 20 61 6e 64 20 6e 65 74 77 6f 72 6b 2d 61 63 63 65 73 73 69 62 6c 65 20 72 65 73 6f 75 72 63 65 73 2e 4e 65 74 77 6f 72 6b 20 73 65 63 75 72 69 74 79 20 69 6e 76 6f 6c 76 65 73 20 74 68 65 20 61 75 74 68 6f 72 69 7a 61 74 69 6f 6e 20 6f 66 20 61 63 63 65 73 73 20 74 6f 20 64 61 74 61 20 69 6e 20 61 20 6e 65 74 77 6f 72 6b 20 76 65 72 61 63 72 79 70 74 2c 20 77 68 69 63 68 20 69 73 20 63 6f 6e 74 72 6f 6c 6c 65 64 20 62 79 20 74 68 65 20 6e 65 74 77 6f 72 6b 20 61 20 69 73 20 36 3f 2c 20 62 20 69 73 20 3f 37 2c 20 73 20 69 73 20 3f 2c 20 61 64 6d 69 6e 69 73 74 72 61 74 6f 72 2e 20 55 73 65 72 73 20 63 68 6f 6f 73 65 20 6f 72 20 61 72 65 20 61 73 73 69 67 6e 65 64 </span><br></pre></td></tr></table></figure>

<blockquote>
<p>Network security is an umbrella term to describe security controls, policies, processes and practices adopted to prevent, detect and monitor unauthorized access, misuse, modification, or denial of a computer network and network-accessible resources.Network security involves the authorization of access to data in a network veracrypt, which is controlled by the network a is 6?, b is ?7, s is ?, administrator. Users choose or are assigned</p>
</blockquote>
<p>不懂 &#x3D;-&#x3D;</p>
<h2 id="Hidden"><a href="#Hidden" class="headerlink" title="Hidden"></a>Hidden</h2><p>给了一个 Bmp 文件，Slienteye 出不来东西，应该不是隐写，binwalk 和 foremost 出不来有用的东西，跑路</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://github.com/GamerNoTitle">GamerNoTitle</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://bili33.top/posts/CTF-PCB2025-Preliminary-Round-Writeup/">https://bili33.top/posts/CTF-PCB2025-Preliminary-Round-Writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/PCB2025/">PCB2025</a><a class="post-meta__tags" href="/tags/Misc/">Misc</a></div><div class="post_share"><div class="social-share" data-image="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> Donate</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/WeChat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/WeChat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/AliPay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/AliPay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/bkcrack-known-bytes-attack-decipher/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/bkcrack-known-bytes-attack-decipher/cover.png" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破</div></div></a></div><div class="next-post pull-right"><a href="/posts/Creating-Challenges-for-ADCTF2025/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Creating-Challenges-for-ADCTF2025/cover.jpg" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">ADCTF 2025 个人出题记录</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/ADCTF2024-Writeup/" title="ADCTF2024 个人Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_5Mr1PCe98I.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-07</div><div class="title">ADCTF2024 个人Writeup</div></div></a></div><div><a href="/posts/BaseCTF2024-Writeup/" title="BaseCTF2024 个人Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/BaseCTF2024-Week1/msedge_uIfC9jDQCq.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-30</div><div class="title">BaseCTF2024 个人Writeup</div></div></a></div><div><a href="/posts/CTF-20220529/" title="2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-29</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp</div></div></a></div><div><a href="/posts/CTF-20220619/" title="2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-20220619/Cover.jpg?download=true" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-19</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp</div></div></a></div><div><a href="/posts/CTF-20220826-wangdingcup-qinglong/" title="2022网鼎杯青龙组——个人WriteUP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-26</div><div class="title">2022网鼎杯青龙组——个人WriteUP</div></div></a></div><div><a href="/posts/CTF-CCSSSC2025-National-Finals/" title="第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-CCSSSC2025-National-Finals/1748174171442.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-25</div><div class="title">第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="author-info__name">GamerNoTitle</div><div class="author-info__description">TECH OTAKUS SAVE THE WORLD</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><a id="card-info-btn" href="https://github.com/GamerNoTitle"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/GamerNoTitle" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/44666814" target="_blank" title="bilibili"><i class="fas fa-tv"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="mailto:GamerNoTitle@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"><div align="center"><pre style="font-family: monospace; white-space: pre; line-height: 1 !important;">
.------.--------.---------.
| .=====================. |\
| | 7  3  5  5  6  0  8 | | |
| +=====================+ | |
|----------------------\\-. |
|    *   |      ^|^    || |\|
|   .-----------------.|| | |
|   |  1  |  2  |  3  ||| | |
|   |-----+-----+-----||| | |
|   |  4  |  5  |  6  ||| | |
|   |-----+-----+-----||| | |
|   |  7  |  8  |  9  ||| | |
|   |-----+-----+-----|// | |
|   |  *  |  0  |  #  |/  | |
|   +-----------------+   | |
|       |       |         | |
+-------+-------+---------+ |
\______\_______\_________+\/
</pre></div>
<div align="center"><span style="color: #e9b891;">gamernotitle</span>@<span style="color: #c5966d;">site_web</span> > <span style="color: #4a6d42;">./plant.sh</span><br>
Boom has been planted.
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#time-Solved"><span class="toc-number">1.</span> <span class="toc-text">time | Solved</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SMB-Solved"><span class="toc-number">2.</span> <span class="toc-text">SMB | Solved</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZipCracker-Solved"><span class="toc-number">3.</span> <span class="toc-text">ZipCracker | Solved</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Rogue-Beacon-Solved"><span class="toc-number">4.</span> <span class="toc-text">The_Rogue_Beacon | Solved</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Whiteout-Solved"><span class="toc-number">5.</span> <span class="toc-text">Whiteout | Solved</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blue"><span class="toc-number">6.</span> <span class="toc-text">Blue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E8%B6%8A%E6%84%9F%E5%AE%98%E6%9E%81%E8%87%B4"><span class="toc-number">7.</span> <span class="toc-text">超越感官极致</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PunkFace"><span class="toc-number">8.</span> <span class="toc-text">PunkFace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hidden"><span class="toc-number">9.</span> <span class="toc-text">Hidden</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Migrate-from-Valine-to-Waline/msedge_1kiyjac8P9.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="从 Valine 迁移到 Waline 全记录"/></a><div class="content"><a class="title" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录">从 Valine 迁移到 Waline 全记录</a><time datetime="2026-02-15T19:00:46.000Z" title="Created 2026-02-16 03:00:46">2026-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Reverse-Engineering-Cracking-MailMaster/at-748365_1920.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="记一次对某邮箱软件账户数量上限破解"/></a><div class="content"><a class="title" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解">记一次对某邮箱软件账户数量上限破解</a><time datetime="2026-01-19T12:34:03.000Z" title="Created 2026-01-19 20:34:03">2026-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2025-Year-End-Summary/" title="2025 年终总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/2025-Year-End-Summary/image-20251231025211777.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 年终总结"/></a><div class="content"><a class="title" href="/posts/2025-Year-End-Summary/" title="2025 年终总结">2025 年终总结</a><time datetime="2025-12-30T17:10:19.000Z" title="Created 2025-12-31 01:10:19">2025-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/bkcrack-known-bytes-attack-decipher/cover.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"/></a><div class="content"><a class="title" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破">使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破</a><time datetime="2025-12-19T12:59:03.000Z" title="Created 2025-12-19 20:59:03">2025-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"/></a><div class="content"><a class="title" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup">2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup</a><time datetime="2025-12-13T11:05:12.000Z" title="Created 2025-12-13 19:05:12">2025-12-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2026 By GamerNoTitle</div><div class="framework-info"><span>Framework </span><a href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">All articles in this blog are licensed under CC BY-NC-SA 4.0 unless stating additionally.<br>
<a href="https://icp.gov.moe/?keyword=20213338" target="_blank"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src='https://assets.bili33.top/img/GovMoe/icon120.png' width=20px height=20px></img> 萌ICP备 20213338号</a> | <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.bili33.top/gh/biliCDN/bilicdn.github.io@master/images/favicon.png" width="20px" height="20px"> 本站使用 <a href="https://cdn.bili33.top">哔哩CDN</a> 进行加速<br>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.umd.min.js"></script><script src="https://cdn.bili33.top/npm/vanilla-lazyload@17.8.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.bili33.top/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.bili33.top/npm/mermaid@9.1.7/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadWaline () {
  function insertCSS () {
    const link = document.createElement("link")
    link.rel = "stylesheet"
    link.href = "https://assets.bili33.top/css/waline.css"
    document.head.appendChild(link)
  }

  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline.bili33.top',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
      imageUploader: (file) => {
        let formData = new FormData();
        let headers = new Headers();
        let query = new URLSearchParams();

        formData.append('file', file);
        headers.append('Authorization', 'Bearer imgbed_YdVn2QPSD7RjaCDYIODMnlyY8wAn3FZD')
        headers.append('User-Agent', 'Paff-Waline/1.0')

        return fetch('https://img.bili33.top/upload', {
          method: 'POST',
          headers: headers,
          body: formData,
        }).then((resp) => resp.json())
        .then((data) => 'https://img.bili33.top' + data[0].src)
      }

    }, {"avatar":"mp","emojiCDN":"https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/","visitor":true,"emoji":["https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibiliHotKey","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibili2233","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibilitv","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Arcaea","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Heybox","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Majotabi"],"locale":{"nick":"昵称","nickError":"昵称不能少于3个字符","mail":"邮箱","mailError":"请填写正确的邮件地址","link":"网址","optional":"可选","placeholder":"📌图片上传大小限制 5MB，请友善发言，并遵守相关法律法规。","sofa":"来发评论吧~","submit":"提交","like":"喜欢","cancelLike":"撤销喜欢","reply":"回复","cancelReply":"撤回","comment":"评论","refresh":"刷新","more":"加载更多...","preview":"预览","emoji":"表情","uploadImage":"上传图片","seconds":"秒前","minutes":"分钟前","hours":"小时前","days":"天前","now":"刚刚","uploading":"Uploading","login":"登录","logout":"登出","admin":"Endministrator","sticky":"📌","word":"字","wordHint":"评论字数应在 $0 到 $1 字之间！\\n当前字数：$2","anonymous":"匿名","level0":"Lv0","level1":"Lv1","level2":"Lv2","level3":"Lv3","level4":"Lv4","level5":"Lv5","gif":"表情包","gifSearchPlaceholder":"搜索表情包","profile":"个人资料","approved":"通过","waiting":"待审核","spam":"垃圾","unsticky":"取消置顶","oldest":"倒序","latest":"正序","hottest":"热度","reactionTitle":"你认为这篇文章怎么样？"},"noCopyright":true,"reaction":false}))
  }

  if (typeof Waline === 'function') initWaline()
  else {
    insertCSS()
    getScript('https://assets.bili33.top/js/waline.umd.js').then(initWaline)
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.bili33.top/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-138072700-2', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>